{"episode_reward_max": 1929.655562829149, "episode_reward_min": 0.0, "episode_reward_mean": 254.84133129673188, "episode_len_mean": 72.2073732718894, "episodes_this_iter": 217, "policy_reward_mean": {"av": 49.06882776520925}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 1.9999999494757503e-05, "total_loss": 2476.56396484375, "policy_loss": -35.352691650390625, "vf_loss": 2511.90869140625, "vf_explained_var": -0.0016198158264160156, "kl": 0.0009410426719114184, "entropy": 2.6631689071655273}, "num_steps_trained": 1936000, "num_steps_sampled": 1936000, "sample_time_ms": 152310.122, "grad_time_ms": 4657.739, "update_time_ms": 313.509, "opt_peak_throughput": 3435.143, "sample_peak_throughput": 105.049, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 1936000, "episodes_total": 44734, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-24-58", "timestamp": 1569770698, "training_iteration": 121, "time_this_iter_s": 157.31044793128967, "time_total_s": 24103.35071325302, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c607470>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 157.31044793128967, "timesteps_since_restore": 16000, "iterations_since_restore": 1}
{"episode_reward_max": 1598.9405365407931, "episode_reward_min": 0.0, "episode_reward_mean": 272.1754806126052, "episode_len_mean": 76.11320754716981, "episodes_this_iter": 212, "policy_reward_mean": {"av": 51.42709615853147}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.10000000149011612, "cur_lr": 1.9999999494757503e-05, "total_loss": 2597.500244140625, "policy_loss": -36.56336212158203, "vf_loss": 2634.060302734375, "vf_explained_var": -0.0014820098876953125, "kl": 0.0009902132442221045, "entropy": 2.6722984313964844}, "num_steps_trained": 1952000, "num_steps_sampled": 1952000, "sample_time_ms": 136743.771, "grad_time_ms": 4359.756, "update_time_ms": 157.97, "opt_peak_throughput": 3669.93, "sample_peak_throughput": 117.007, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 1952000, "episodes_total": 44946, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-27-03", "timestamp": 1569770823, "training_iteration": 122, "time_this_iter_s": 125.25215888023376, "time_total_s": 24228.602872133255, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c607e80>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 282.56260681152344, "timesteps_since_restore": 32000, "iterations_since_restore": 2}
{"episode_reward_max": 1303.3001871621714, "episode_reward_min": 0.0, "episode_reward_mean": 220.43850553202674, "episode_len_mean": 65.38842975206612, "episodes_this_iter": 242, "policy_reward_mean": {"av": 44.270637625519065}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.05000000074505806, "cur_lr": 1.9999999494757503e-05, "total_loss": 2144.125244140625, "policy_loss": -32.720829010009766, "vf_loss": 2176.84619140625, "vf_explained_var": -0.001614689826965332, "kl": 0.0008949853363446891, "entropy": 2.682567596435547}, "num_steps_trained": 1968000, "num_steps_sampled": 1968000, "sample_time_ms": 138228.485, "grad_time_ms": 4351.833, "update_time_ms": 106.527, "opt_peak_throughput": 3676.612, "sample_peak_throughput": 115.75, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 1968000, "episodes_total": 45188, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-29-29", "timestamp": 1569770969, "training_iteration": 123, "time_this_iter_s": 145.54864168167114, "time_total_s": 24374.151513814926, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f6a0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 428.1112484931946, "timesteps_since_restore": 48000, "iterations_since_restore": 3}
{"episode_reward_max": 1396.0179481263579, "episode_reward_min": 0.0, "episode_reward_mean": 252.45673731143248, "episode_len_mean": 73.68663594470046, "episodes_this_iter": 217, "policy_reward_mean": {"av": 48.13981722019407}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.02500000037252903, "cur_lr": 1.9999999494757503e-05, "total_loss": 2322.18603515625, "policy_loss": -33.90443801879883, "vf_loss": 2356.088134765625, "vf_explained_var": -0.0012170076370239258, "kl": 0.00024835014482960105, "entropy": 2.686330556869507}, "num_steps_trained": 1984000, "num_steps_sampled": 1984000, "sample_time_ms": 134261.279, "grad_time_ms": 4274.272, "update_time_ms": 80.848, "opt_peak_throughput": 3743.327, "sample_peak_throughput": 119.171, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 1984000, "episodes_total": 45405, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-31-35", "timestamp": 1569771095, "training_iteration": 124, "time_this_iter_s": 126.41495251655579, "time_total_s": 24500.566466331482, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c607668>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 554.5262010097504, "timesteps_since_restore": 64000, "iterations_since_restore": 4}
{"episode_reward_max": 1777.596197190064, "episode_reward_min": 0.0, "episode_reward_mean": 204.31268074016296, "episode_len_mean": 59.63670411985019, "episodes_this_iter": 267, "policy_reward_mean": {"av": 42.78547902558708}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.012500000186264515, "cur_lr": 1.9999999494757503e-05, "total_loss": 2435.084228515625, "policy_loss": -34.565486907958984, "vf_loss": 2469.651123046875, "vf_explained_var": -0.0013742446899414062, "kl": 0.0002511109341867268, "entropy": 2.679816484451294}, "num_steps_trained": 2000000, "num_steps_sampled": 2000000, "sample_time_ms": 140002.841, "grad_time_ms": 4205.538, "update_time_ms": 65.393, "opt_peak_throughput": 3804.507, "sample_peak_throughput": 114.283, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2000000, "episodes_total": 45672, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-34-22", "timestamp": 1569771262, "training_iteration": 125, "time_this_iter_s": 166.91344022750854, "time_total_s": 24667.47990655899, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f048>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 721.4396412372589, "timesteps_since_restore": 80000, "iterations_since_restore": 5}
{"episode_reward_max": 1550.0386325993695, "episode_reward_min": 0.0, "episode_reward_mean": 201.56713495538733, "episode_len_mean": 60.68283582089552, "episodes_this_iter": 268, "policy_reward_mean": {"av": 41.94098770810855}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.0062500000931322575, "cur_lr": 1.9999999494757503e-05, "total_loss": 2107.877197265625, "policy_loss": -32.08311462402344, "vf_loss": 2139.955078125, "vf_explained_var": -0.0011414289474487305, "kl": 0.0011952464701607823, "entropy": 2.6867921352386475}, "num_steps_trained": 2016000, "num_steps_sampled": 2016000, "sample_time_ms": 141956.461, "grad_time_ms": 4231.212, "update_time_ms": 55.052, "opt_peak_throughput": 3781.422, "sample_peak_throughput": 112.711, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2016000, "episodes_total": 45940, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-36-58", "timestamp": 1569771418, "training_iteration": 126, "time_this_iter_s": 156.09764122962952, "time_total_s": 24823.57754778862, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f940>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 877.5372824668884, "timesteps_since_restore": 96000, "iterations_since_restore": 6}
{"episode_reward_max": 1388.638149436885, "episode_reward_min": 0.0, "episode_reward_mean": 192.1386990994396, "episode_len_mean": 58.12132352941177, "episodes_this_iter": 272, "policy_reward_mean": {"av": 40.925392447178986}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.0031250000465661287, "cur_lr": 1.9999999494757503e-05, "total_loss": 2065.3173828125, "policy_loss": -31.67662239074707, "vf_loss": 2096.990966796875, "vf_explained_var": -0.0013835430145263672, "kl": 0.0010703583247959614, "entropy": 2.685049295425415}, "num_steps_trained": 2032000, "num_steps_sampled": 2032000, "sample_time_ms": 143563.268, "grad_time_ms": 4188.228, "update_time_ms": 47.637, "opt_peak_throughput": 3820.231, "sample_peak_throughput": 111.449, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2032000, "episodes_total": 46212, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-39-36", "timestamp": 1569771576, "training_iteration": 127, "time_this_iter_s": 157.14763689041138, "time_total_s": 24980.72518467903, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f3c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 1034.6849193572998, "timesteps_since_restore": 112000, "iterations_since_restore": 7}
{"episode_reward_max": 1568.4879064482234, "episode_reward_min": 0.0, "episode_reward_mean": 228.6609999092028, "episode_len_mean": 67.32635983263599, "episodes_this_iter": 239, "policy_reward_mean": {"av": 45.69396235643767}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.0015625000232830644, "cur_lr": 1.9999999494757503e-05, "total_loss": 2228.84375, "policy_loss": -33.07237243652344, "vf_loss": 2261.91064453125, "vf_explained_var": -0.0013897418975830078, "kl": 0.00028160063084214926, "entropy": 2.6798980236053467}, "num_steps_trained": 2048000, "num_steps_sampled": 2048000, "sample_time_ms": 145003.534, "grad_time_ms": 4160.029, "update_time_ms": 42.153, "opt_peak_throughput": 3846.127, "sample_peak_throughput": 110.342, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2048000, "episodes_total": 46451, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-42-15", "timestamp": 1569771735, "training_iteration": 128, "time_this_iter_s": 159.06301641464233, "time_total_s": 25139.788201093674, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61fda0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 1193.7479357719421, "timesteps_since_restore": 128000, "iterations_since_restore": 8}
{"episode_reward_max": 1223.1790693660473, "episode_reward_min": 0.0, "episode_reward_mean": 233.8269614456256, "episode_len_mean": 68.991341991342, "episodes_this_iter": 231, "policy_reward_mean": {"av": 46.36397261282361}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.0007812500116415322, "cur_lr": 1.9999999494757503e-05, "total_loss": 2149.281982421875, "policy_loss": -32.79846954345703, "vf_loss": 2182.078125, "vf_explained_var": -0.0012470483779907227, "kl": 0.0005120879504829645, "entropy": 2.683800220489502}, "num_steps_trained": 2064000, "num_steps_sampled": 2064000, "sample_time_ms": 143830.441, "grad_time_ms": 4131.492, "update_time_ms": 37.848, "opt_peak_throughput": 3872.693, "sample_peak_throughput": 111.242, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2064000, "episodes_total": 46682, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-44-33", "timestamp": 1569771873, "training_iteration": 129, "time_this_iter_s": 138.36307096481323, "time_total_s": 25278.151272058487, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f4e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 1332.1110067367554, "timesteps_since_restore": 144000, "iterations_since_restore": 9}
{"episode_reward_max": 1884.6234045559672, "episode_reward_min": 0.0, "episode_reward_mean": 212.8826968781868, "episode_len_mean": 62.264591439688715, "episodes_this_iter": 257, "policy_reward_mean": {"av": 43.663889144209115}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.0003906250058207661, "cur_lr": 1.9999999494757503e-05, "total_loss": 2373.615966796875, "policy_loss": -34.07926940917969, "vf_loss": 2407.684326171875, "vf_explained_var": -0.0013175010681152344, "kl": 0.0005812693852931261, "entropy": 2.68965482711792}, "num_steps_trained": 2080000, "num_steps_sampled": 2080000, "sample_time_ms": 145025.494, "grad_time_ms": 4114.097, "update_time_ms": 34.48, "opt_peak_throughput": 3889.067, "sample_peak_throughput": 110.325, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2080000, "episodes_total": 46939, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-47-13", "timestamp": 1569772033, "training_iteration": 130, "time_this_iter_s": 159.75277972221375, "time_total_s": 25437.9040517807, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f908>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 1491.8637864589691, "timesteps_since_restore": 160000, "iterations_since_restore": 10}
{"episode_reward_max": 1809.5435364248588, "episode_reward_min": 0.0, "episode_reward_mean": 262.4561478535489, "episode_len_mean": 74.20370370370371, "episodes_this_iter": 216, "policy_reward_mean": {"av": 49.94760170604984}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 0.00019531250291038305, "cur_lr": 1.9999999494757503e-05, "total_loss": 2652.3916015625, "policy_loss": -36.9373893737793, "vf_loss": 2689.330810546875, "vf_explained_var": -0.0012173652648925781, "kl": 0.000507963530253619, "entropy": 2.702737331390381}, "num_steps_trained": 2096000, "num_steps_sampled": 2096000, "sample_time_ms": 142523.934, "grad_time_ms": 4054.426, "update_time_ms": 3.468, "opt_peak_throughput": 3946.304, "sample_peak_throughput": 112.262, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2096000, "episodes_total": 47155, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-49-24", "timestamp": 1569772164, "training_iteration": 131, "time_this_iter_s": 131.36876487731934, "time_total_s": 25569.27281665802, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f3c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 1623.2325513362885, "timesteps_since_restore": 176000, "iterations_since_restore": 11}
{"episode_reward_max": 1789.9110120212501, "episode_reward_min": 0.0, "episode_reward_mean": 245.81461550090407, "episode_len_mean": 69.41558441558442, "episodes_this_iter": 231, "policy_reward_mean": {"av": 48.36727102275029}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 9.765625145519152e-05, "cur_lr": 1.9999999494757503e-05, "total_loss": 2471.3330078125, "policy_loss": -35.781944274902344, "vf_loss": 2507.1181640625, "vf_explained_var": -0.0012449026107788086, "kl": 0.0006065521738491952, "entropy": 2.7089381217956543}, "num_steps_trained": 2112000, "num_steps_sampled": 2112000, "sample_time_ms": 144617.752, "grad_time_ms": 4045.867, "update_time_ms": 3.663, "opt_peak_throughput": 3954.653, "sample_peak_throughput": 110.636, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2112000, "episodes_total": 47386, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-51-50", "timestamp": 1569772310, "training_iteration": 132, "time_this_iter_s": 146.1058099269867, "time_total_s": 25715.378626585007, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61fa20>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 1769.3383612632751, "timesteps_since_restore": 192000, "iterations_since_restore": 12}
{"episode_reward_max": 2496.2541873677496, "episode_reward_min": 0.0, "episode_reward_mean": 202.27231134531337, "episode_len_mean": 59.888475836431226, "episodes_this_iter": 269, "policy_reward_mean": {"av": 42.31046014921408}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.882812572759576e-05, "cur_lr": 1.9999999494757503e-05, "total_loss": 2146.303466796875, "policy_loss": -32.10761260986328, "vf_loss": 2178.40625, "vf_explained_var": -0.0010062456130981445, "kl": 0.000574890524148941, "entropy": 2.718018054962158}, "num_steps_trained": 2128000, "num_steps_sampled": 2128000, "sample_time_ms": 145978.589, "grad_time_ms": 4042.336, "update_time_ms": 3.64, "opt_peak_throughput": 3958.107, "sample_peak_throughput": 109.605, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2128000, "episodes_total": 47655, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-54-29", "timestamp": 1569772469, "training_iteration": 133, "time_this_iter_s": 159.1199426651001, "time_total_s": 25874.498569250107, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61ff60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 1928.4583039283752, "timesteps_since_restore": 208000, "iterations_since_restore": 13}
{"episode_reward_max": 1225.1457324971277, "episode_reward_min": 0.0, "episode_reward_mean": 227.90724512702621, "episode_len_mean": 67.89787234042554, "episodes_this_iter": 235, "policy_reward_mean": {"av": 45.23496841625943}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.441406286379788e-05, "cur_lr": 1.9999999494757503e-05, "total_loss": 2194.353271484375, "policy_loss": -32.78602981567383, "vf_loss": 2227.133544921875, "vf_explained_var": -0.0012923479080200195, "kl": 0.0005203769542276859, "entropy": 2.7185425758361816}, "num_steps_trained": 2144000, "num_steps_sampled": 2144000, "sample_time_ms": 148115.86, "grad_time_ms": 4065.281, "update_time_ms": 3.566, "opt_peak_throughput": 3935.767, "sample_peak_throughput": 108.024, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2144000, "episodes_total": 47890, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-56-57", "timestamp": 1569772617, "training_iteration": 134, "time_this_iter_s": 148.01691555976868, "time_total_s": 26022.515484809875, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f940>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 2076.475219488144, "timesteps_since_restore": 224000, "iterations_since_restore": 14}
{"episode_reward_max": 1800.8161091694517, "episode_reward_min": 0.0, "episode_reward_mean": 219.11461597760464, "episode_len_mean": 63.288, "episodes_this_iter": 250, "policy_reward_mean": {"av": 44.93736997079669}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.220703143189894e-05, "cur_lr": 1.9999999494757503e-05, "total_loss": 2257.204345703125, "policy_loss": -33.47892379760742, "vf_loss": 2290.675048828125, "vf_explained_var": -0.0010143518447875977, "kl": 0.0008528166799806058, "entropy": 2.7031707763671875}, "num_steps_trained": 2160000, "num_steps_sampled": 2160000, "sample_time_ms": 146894.079, "grad_time_ms": 4071.113, "update_time_ms": 3.508, "opt_peak_throughput": 3930.129, "sample_peak_throughput": 108.922, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2160000, "episodes_total": 48140, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_17-59-32", "timestamp": 1569772772, "training_iteration": 135, "time_this_iter_s": 154.7533392906189, "time_total_s": 26177.268824100494, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f6a0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 2231.228558778763, "timesteps_since_restore": 240000, "iterations_since_restore": 15}
{"episode_reward_max": 1861.3286897481717, "episode_reward_min": 0.0, "episode_reward_mean": 211.59501627234425, "episode_len_mean": 63.023346303501945, "episodes_this_iter": 257, "policy_reward_mean": {"av": 43.399775883473644}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.10351571594947e-06, "cur_lr": 1.9999999494757503e-05, "total_loss": 2237.033935546875, "policy_loss": -33.01983642578125, "vf_loss": 2270.05517578125, "vf_explained_var": -0.00103759765625, "kl": 0.0008941966225393116, "entropy": 2.6913106441497803}, "num_steps_trained": 2176000, "num_steps_sampled": 2176000, "sample_time_ms": 146490.431, "grad_time_ms": 4024.877, "update_time_ms": 3.479, "opt_peak_throughput": 3975.277, "sample_peak_throughput": 109.222, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2176000, "episodes_total": 48397, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-02-04", "timestamp": 1569772924, "training_iteration": 136, "time_this_iter_s": 151.599445104599, "time_total_s": 26328.868269205093, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c607f28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 2382.828003883362, "timesteps_since_restore": 256000, "iterations_since_restore": 16}
{"episode_reward_max": 1489.503464050568, "episode_reward_min": 0.0, "episode_reward_mean": 223.502217693259, "episode_len_mean": 65.47736625514403, "episodes_this_iter": 243, "policy_reward_mean": {"av": 44.700443538651804}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.051757857974735e-06, "cur_lr": 1.9999999494757503e-05, "total_loss": 2284.633544921875, "policy_loss": -33.71809005737305, "vf_loss": 2318.343994140625, "vf_explained_var": -0.0009310245513916016, "kl": 0.0018519219011068344, "entropy": 2.6731722354888916}, "num_steps_trained": 2192000, "num_steps_sampled": 2192000, "sample_time_ms": 146453.491, "grad_time_ms": 4026.916, "update_time_ms": 3.505, "opt_peak_throughput": 3973.264, "sample_peak_throughput": 109.25, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2192000, "episodes_total": 48640, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-04-41", "timestamp": 1569773081, "training_iteration": 137, "time_this_iter_s": 156.79845094680786, "time_total_s": 26485.6667201519, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f470>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 2539.6264548301697, "timesteps_since_restore": 272000, "iterations_since_restore": 17}
{"episode_reward_max": 1434.2564327531986, "episode_reward_min": 0.0, "episode_reward_mean": 205.51538441160594, "episode_len_mean": 61.343511450381676, "episodes_this_iter": 262, "policy_reward_mean": {"av": 42.36430426108635}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.5258789289873675e-06, "cur_lr": 1.9999999494757503e-05, "total_loss": 2057.704833984375, "policy_loss": -31.766313552856445, "vf_loss": 2089.4658203125, "vf_explained_var": -0.0008693933486938477, "kl": 0.0004981951788067818, "entropy": 2.663728713989258}, "num_steps_trained": 2208000, "num_steps_sampled": 2208000, "sample_time_ms": 146509.689, "grad_time_ms": 4024.78, "update_time_ms": 3.428, "opt_peak_throughput": 3975.372, "sample_peak_throughput": 109.208, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2208000, "episodes_total": 48902, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-07-20", "timestamp": 1569773240, "training_iteration": 138, "time_this_iter_s": 159.60154628753662, "time_total_s": 26645.268266439438, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61fcf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 2699.2280011177063, "timesteps_since_restore": 288000, "iterations_since_restore": 18}
{"episode_reward_max": 1206.1286030370097, "episode_reward_min": 0.0, "episode_reward_mean": 213.07230952601336, "episode_len_mean": 64.91836734693878, "episodes_this_iter": 245, "policy_reward_mean": {"av": 43.21416873665006}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 7.629394644936838e-07, "cur_lr": 1.9999999494757503e-05, "total_loss": 2067.460693359375, "policy_loss": -31.643482208251953, "vf_loss": 2099.100830078125, "vf_explained_var": -0.0009307861328125, "kl": 0.0004867431416641921, "entropy": 2.6620535850524902}, "num_steps_trained": 2224000, "num_steps_sampled": 2224000, "sample_time_ms": 147909.324, "grad_time_ms": 4029.738, "update_time_ms": 3.36, "opt_peak_throughput": 3970.482, "sample_peak_throughput": 108.174, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2224000, "episodes_total": 49147, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-09-53", "timestamp": 1569773393, "training_iteration": 139, "time_this_iter_s": 152.40757846832275, "time_total_s": 26797.67584490776, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f630>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 2851.635579586029, "timesteps_since_restore": 304000, "iterations_since_restore": 19}
{"episode_reward_max": 1971.0769470466919, "episode_reward_min": 0.0, "episode_reward_mean": 244.29952003506276, "episode_len_mean": 69.50869565217391, "episodes_this_iter": 230, "policy_reward_mean": {"av": 47.861064402099174}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.814697322468419e-07, "cur_lr": 1.9999999494757503e-05, "total_loss": 2453.11328125, "policy_loss": -34.90498733520508, "vf_loss": 2488.019775390625, "vf_explained_var": -0.0010292530059814453, "kl": 9.829164628172293e-05, "entropy": 2.6633777618408203}, "num_steps_trained": 2240000, "num_steps_sampled": 2240000, "sample_time_ms": 146487.89, "grad_time_ms": 4037.881, "update_time_ms": 3.253, "opt_peak_throughput": 3962.474, "sample_peak_throughput": 109.224, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2240000, "episodes_total": 49377, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-12-18", "timestamp": 1569773538, "training_iteration": 140, "time_this_iter_s": 145.62019038200378, "time_total_s": 26943.296035289764, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61fcc0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 2997.255769968033, "timesteps_since_restore": 320000, "iterations_since_restore": 20}
{"episode_reward_max": 1564.2568587197811, "episode_reward_min": 0.0, "episode_reward_mean": 233.6612093979852, "episode_len_mean": 67.51680672268908, "episodes_this_iter": 238, "policy_reward_mean": {"av": 46.42017348641107}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.9073486612342094e-07, "cur_lr": 1.9999999494757503e-05, "total_loss": 2313.102783203125, "policy_loss": -33.957088470458984, "vf_loss": 2347.051025390625, "vf_explained_var": -0.0009198188781738281, "kl": 0.0014841355150565505, "entropy": 2.6661453247070312}, "num_steps_trained": 2256000, "num_steps_sampled": 2256000, "sample_time_ms": 148304.139, "grad_time_ms": 4028.679, "update_time_ms": 3.22, "opt_peak_throughput": 3971.525, "sample_peak_throughput": 107.886, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2256000, "episodes_total": 49615, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-14-48", "timestamp": 1569773688, "training_iteration": 141, "time_this_iter_s": 149.43958520889282, "time_total_s": 27092.735620498657, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f438>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 3146.6953551769257, "timesteps_since_restore": 336000, "iterations_since_restore": 21}
{"episode_reward_max": 1787.6736422597974, "episode_reward_min": 0.0, "episode_reward_mean": 246.12054712390642, "episode_len_mean": 71.5201793721973, "episodes_this_iter": 223, "policy_reward_mean": {"av": 47.43723596251611}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 9.536743306171047e-08, "cur_lr": 1.9999999494757503e-05, "total_loss": 2293.714599609375, "policy_loss": -34.07079315185547, "vf_loss": 2327.78955078125, "vf_explained_var": -0.0010287761688232422, "kl": 0.0009773722849786282, "entropy": 2.6539134979248047}, "num_steps_trained": 2272000, "num_steps_sampled": 2272000, "sample_time_ms": 147724.613, "grad_time_ms": 4031.035, "update_time_ms": 3.084, "opt_peak_throughput": 3969.204, "sample_peak_throughput": 108.31, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2272000, "episodes_total": 49838, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-17-08", "timestamp": 1569773828, "training_iteration": 142, "time_this_iter_s": 140.33335161209106, "time_total_s": 27233.06897211075, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6214e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 3287.0287067890167, "timesteps_since_restore": 352000, "iterations_since_restore": 22}
{"episode_reward_max": 1622.6560009247457, "episode_reward_min": 0.0, "episode_reward_mean": 230.7713061938292, "episode_len_mean": 65.79338842975207, "episodes_this_iter": 242, "policy_reward_mean": {"av": 46.15426123876584}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.7683716530855236e-08, "cur_lr": 1.9999999494757503e-05, "total_loss": 2590.232177734375, "policy_loss": -35.56185531616211, "vf_loss": 2625.790771484375, "vf_explained_var": -0.000841975212097168, "kl": 0.0005224454216659069, "entropy": 2.646765947341919}, "num_steps_trained": 2288000, "num_steps_sampled": 2288000, "sample_time_ms": 147737.27, "grad_time_ms": 4000.604, "update_time_ms": 3.021, "opt_peak_throughput": 3999.396, "sample_peak_throughput": 108.3, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2288000, "episodes_total": 50080, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-19-47", "timestamp": 1569773987, "training_iteration": 143, "time_this_iter_s": 158.9429943561554, "time_total_s": 27392.011966466904, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc299e1d780>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 3445.971701145172, "timesteps_since_restore": 368000, "iterations_since_restore": 23}
{"episode_reward_max": 1597.7332013201558, "episode_reward_min": 0.0, "episode_reward_mean": 283.81306191142454, "episode_len_mean": 79.50980392156863, "episodes_this_iter": 204, "policy_reward_mean": {"av": 52.4912643970359}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.3841858265427618e-08, "cur_lr": 1.9999999494757503e-05, "total_loss": 2486.3271484375, "policy_loss": -35.19208526611328, "vf_loss": 2521.51025390625, "vf_explained_var": -0.000984787940979004, "kl": 0.000622097693849355, "entropy": 2.6335597038269043}, "num_steps_trained": 2304000, "num_steps_sampled": 2304000, "sample_time_ms": 146135.727, "grad_time_ms": 4014.08, "update_time_ms": 3.044, "opt_peak_throughput": 3985.969, "sample_peak_throughput": 109.487, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2304000, "episodes_total": 50284, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-21-59", "timestamp": 1569774119, "training_iteration": 144, "time_this_iter_s": 132.13647890090942, "time_total_s": 27524.148445367813, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621240>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 3578.1081800460815, "timesteps_since_restore": 384000, "iterations_since_restore": 24}
{"episode_reward_max": 2074.9731275418653, "episode_reward_min": 0.0, "episode_reward_mean": 187.51334641938462, "episode_len_mean": 56.496428571428574, "episodes_this_iter": 280, "policy_reward_mean": {"av": 40.14047171057163}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.1920929132713809e-08, "cur_lr": 1.9999999494757503e-05, "total_loss": 2098.38330078125, "policy_loss": -31.64732551574707, "vf_loss": 2130.02490234375, "vf_explained_var": -0.0007086992263793945, "kl": 0.0005441050161607563, "entropy": 2.6283011436462402}, "num_steps_trained": 2320000, "num_steps_sampled": 2320000, "sample_time_ms": 148857.664, "grad_time_ms": 4014.165, "update_time_ms": 3.168, "opt_peak_throughput": 3985.885, "sample_peak_throughput": 107.485, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2320000, "episodes_total": 50564, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-25-01", "timestamp": 1569774301, "training_iteration": 145, "time_this_iter_s": 181.97571277618408, "time_total_s": 27706.124158143997, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621780>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 3760.0838928222656, "timesteps_since_restore": 400000, "iterations_since_restore": 25}
{"episode_reward_max": 1654.5647481889791, "episode_reward_min": 0.0, "episode_reward_mean": 245.22364537352647, "episode_len_mean": 69.47161572052401, "episodes_this_iter": 229, "policy_reward_mean": {"av": 48.20275947685627}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 5.9604645663569045e-09, "cur_lr": 1.9999999494757503e-05, "total_loss": 2404.426025390625, "policy_loss": -34.7314338684082, "vf_loss": 2439.15771484375, "vf_explained_var": -0.0007165670394897461, "kl": 0.00040782138239592314, "entropy": 2.623857021331787}, "num_steps_trained": 2336000, "num_steps_sampled": 2336000, "sample_time_ms": 148104.085, "grad_time_ms": 4030.048, "update_time_ms": 3.225, "opt_peak_throughput": 3970.176, "sample_peak_throughput": 108.032, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2336000, "episodes_total": 50793, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-27-25", "timestamp": 1569774445, "training_iteration": 146, "time_this_iter_s": 144.2221963405609, "time_total_s": 27850.346354484558, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621208>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 3904.3060891628265, "timesteps_since_restore": 416000, "iterations_since_restore": 26}
{"episode_reward_max": 1804.447966917425, "episode_reward_min": 0.0, "episode_reward_mean": 253.8268320567549, "episode_len_mean": 72.13181818181818, "episodes_this_iter": 220, "policy_reward_mean": {"av": 48.9411946121701}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.9802322831784522e-09, "cur_lr": 1.9999999494757503e-05, "total_loss": 2371.5087890625, "policy_loss": -34.79974365234375, "vf_loss": 2406.308349609375, "vf_explained_var": -0.0008550882339477539, "kl": 0.001008163788355887, "entropy": 2.627501964569092}, "num_steps_trained": 2352000, "num_steps_sampled": 2352000, "sample_time_ms": 147496.731, "grad_time_ms": 4054.135, "update_time_ms": 3.24, "opt_peak_throughput": 3946.588, "sample_peak_throughput": 108.477, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2352000, "episodes_total": 51013, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-29-56", "timestamp": 1569774596, "training_iteration": 147, "time_this_iter_s": 150.97042441368103, "time_total_s": 28001.31677889824, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621be0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 4055.2765135765076, "timesteps_since_restore": 432000, "iterations_since_restore": 27}
{"episode_reward_max": 1830.9895326042858, "episode_reward_min": 0.0, "episode_reward_mean": 262.203288653267, "episode_len_mean": 74.03636363636363, "episodes_this_iter": 220, "policy_reward_mean": {"av": 49.900279847507576}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.4901161415892261e-09, "cur_lr": 1.9999999494757503e-05, "total_loss": 2369.101806640625, "policy_loss": -34.40758514404297, "vf_loss": 2403.504150390625, "vf_explained_var": -0.0007801055908203125, "kl": 0.0006965421489439905, "entropy": 2.6373391151428223}, "num_steps_trained": 2368000, "num_steps_sampled": 2368000, "sample_time_ms": 144898.772, "grad_time_ms": 4062.358, "update_time_ms": 3.264, "opt_peak_throughput": 3938.6, "sample_peak_throughput": 110.422, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2368000, "episodes_total": 51233, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-32-10", "timestamp": 1569774730, "training_iteration": 148, "time_this_iter_s": 133.7035994529724, "time_total_s": 28135.02037835121, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621160>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 4188.98011302948, "timesteps_since_restore": 448000, "iterations_since_restore": 28}
{"episode_reward_max": 2453.6132177823833, "episode_reward_min": 0.0, "episode_reward_mean": 240.0821703702435, "episode_len_mean": 66.39004149377594, "episodes_this_iter": 241, "policy_reward_mean": {"av": 48.056314833246404}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 7.450580707946131e-10, "cur_lr": 1.9999999494757503e-05, "total_loss": 2713.2998046875, "policy_loss": -36.8264045715332, "vf_loss": 2750.12646484375, "vf_explained_var": -0.0006662607192993164, "kl": 0.0011073756031692028, "entropy": 2.633017063140869}, "num_steps_trained": 2384000, "num_steps_sampled": 2384000, "sample_time_ms": 145433.414, "grad_time_ms": 4073.232, "update_time_ms": 3.345, "opt_peak_throughput": 3928.085, "sample_peak_throughput": 110.016, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2384000, "episodes_total": 51474, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-34-48", "timestamp": 1569774888, "training_iteration": 149, "time_this_iter_s": 157.86342334747314, "time_total_s": 28292.883801698685, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621748>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 4346.843536376953, "timesteps_since_restore": 464000, "iterations_since_restore": 29}
{"episode_reward_max": 1912.1362100498686, "episode_reward_min": 0.0, "episode_reward_mean": 274.0888368595604, "episode_len_mean": 74.2394366197183, "episodes_this_iter": 213, "policy_reward_mean": {"av": 52.406572936343224}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.7252903539730653e-10, "cur_lr": 1.9999999494757503e-05, "total_loss": 2680.56689453125, "policy_loss": -37.296142578125, "vf_loss": 2717.85986328125, "vf_explained_var": -0.0006862878799438477, "kl": 0.000367181928595528, "entropy": 2.6326334476470947}, "num_steps_trained": 2400000, "num_steps_sampled": 2400000, "sample_time_ms": 145296.688, "grad_time_ms": 4082.121, "update_time_ms": 3.428, "opt_peak_throughput": 3919.531, "sample_peak_throughput": 110.12, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2400000, "episodes_total": 51687, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-37-12", "timestamp": 1569775032, "training_iteration": 150, "time_this_iter_s": 144.3416028022766, "time_total_s": 28437.22540450096, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621080>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 4491.18513917923, "timesteps_since_restore": 480000, "iterations_since_restore": 30}
{"episode_reward_max": 2552.1196743422192, "episode_reward_min": 0.0, "episode_reward_mean": 226.02702975628887, "episode_len_mean": 65.12903225806451, "episodes_this_iter": 248, "policy_reward_mean": {"av": 45.53590851304601}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.8626451769865326e-10, "cur_lr": 1.9999999494757503e-05, "total_loss": 2483.361572265625, "policy_loss": -35.06367874145508, "vf_loss": 2518.41845703125, "vf_explained_var": -0.0007238388061523438, "kl": 0.0011868381407111883, "entropy": 2.632507801055908}, "num_steps_trained": 2416000, "num_steps_sampled": 2416000, "sample_time_ms": 146009.169, "grad_time_ms": 4087.909, "update_time_ms": 3.486, "opt_peak_throughput": 3913.982, "sample_peak_throughput": 109.582, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2416000, "episodes_total": 51935, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-39-49", "timestamp": 1569775189, "training_iteration": 151, "time_this_iter_s": 156.62344884872437, "time_total_s": 28593.848853349686, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621860>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 4647.808588027954, "timesteps_since_restore": 496000, "iterations_since_restore": 31}
{"episode_reward_max": 2324.919075636213, "episode_reward_min": 0.0, "episode_reward_mean": 252.93492361803712, "episode_len_mean": 71.74107142857143, "episodes_this_iter": 224, "policy_reward_mean": {"av": 48.969250553535275}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 9.313225884932663e-11, "cur_lr": 1.9999999494757503e-05, "total_loss": 2461.00244140625, "policy_loss": -34.699485778808594, "vf_loss": 2495.69677734375, "vf_explained_var": -0.0005223751068115234, "kl": 0.0025865051429718733, "entropy": 2.6150286197662354}, "num_steps_trained": 2432000, "num_steps_sampled": 2432000, "sample_time_ms": 146602.385, "grad_time_ms": 4100.939, "update_time_ms": 3.493, "opt_peak_throughput": 3901.546, "sample_peak_throughput": 109.139, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2432000, "episodes_total": 52159, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-42-15", "timestamp": 1569775335, "training_iteration": 152, "time_this_iter_s": 146.39550733566284, "time_total_s": 28740.24436068535, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621ba8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 4794.204095363617, "timesteps_since_restore": 512000, "iterations_since_restore": 32}
{"episode_reward_max": 2023.529091455645, "episode_reward_min": 0.0, "episode_reward_mean": 320.7386650965063, "episode_len_mean": 86.63387978142076, "episodes_this_iter": 183, "policy_reward_mean": {"av": 56.65557501222071}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.6566129424663316e-11, "cur_lr": 1.9999999494757503e-05, "total_loss": 2805.072998046875, "policy_loss": -38.059085845947266, "vf_loss": 2843.12158203125, "vf_explained_var": -0.0007129907608032227, "kl": 0.0021676651667803526, "entropy": 2.589348793029785}, "num_steps_trained": 2448000, "num_steps_sampled": 2448000, "sample_time_ms": 143489.526, "grad_time_ms": 4109.865, "update_time_ms": 3.513, "opt_peak_throughput": 3893.072, "sample_peak_throughput": 111.506, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2448000, "episodes_total": 52342, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-44-23", "timestamp": 1569775463, "training_iteration": 153, "time_this_iter_s": 127.90287351608276, "time_total_s": 28868.14723420143, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621780>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 4922.1069688797, "timesteps_since_restore": 528000, "iterations_since_restore": 33}
{"episode_reward_max": 2858.6793434168594, "episode_reward_min": 0.0, "episode_reward_mean": 285.03587825813054, "episode_len_mean": 77.49029126213593, "episodes_this_iter": 206, "policy_reward_mean": {"av": 53.1860425010642}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.3283064712331658e-11, "cur_lr": 1.9999999494757503e-05, "total_loss": 2774.601806640625, "policy_loss": -37.42255401611328, "vf_loss": 2812.0263671875, "vf_explained_var": -0.0007177591323852539, "kl": 0.000829700322356075, "entropy": 2.5841617584228516}, "num_steps_trained": 2464000, "num_steps_sampled": 2464000, "sample_time_ms": 145176.137, "grad_time_ms": 4090.314, "update_time_ms": 3.471, "opt_peak_throughput": 3911.681, "sample_peak_throughput": 110.211, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2464000, "episodes_total": 52548, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-46-52", "timestamp": 1569775612, "training_iteration": 154, "time_this_iter_s": 148.80626821517944, "time_total_s": 29016.95350241661, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621080>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 5070.913237094879, "timesteps_since_restore": 544000, "iterations_since_restore": 34}
{"episode_reward_max": 2920.827311263985, "episode_reward_min": 0.0, "episode_reward_mean": 343.47381293277795, "episode_len_mean": 88.76373626373626, "episodes_this_iter": 182, "policy_reward_mean": {"av": 60.28180709138433}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.1641532356165829e-11, "cur_lr": 1.9999999494757503e-05, "total_loss": 2873.24169921875, "policy_loss": -38.87558364868164, "vf_loss": 2912.112548828125, "vf_explained_var": -0.0005477666854858398, "kl": 0.0003915868292097002, "entropy": 2.5803170204162598}, "num_steps_trained": 2480000, "num_steps_sampled": 2480000, "sample_time_ms": 139212.518, "grad_time_ms": 4115.839, "update_time_ms": 3.391, "opt_peak_throughput": 3887.421, "sample_peak_throughput": 114.932, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2480000, "episodes_total": 52730, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-48-55", "timestamp": 1569775735, "training_iteration": 155, "time_this_iter_s": 122.59275770187378, "time_total_s": 29139.546260118484, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621c88>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 5193.505994796753, "timesteps_since_restore": 560000, "iterations_since_restore": 35}
{"episode_reward_max": 2446.861838435626, "episode_reward_min": 0.0, "episode_reward_mean": 339.71678459037804, "episode_len_mean": 86.24043715846994, "episodes_this_iter": 183, "policy_reward_mean": {"av": 60.12395704065685}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 5.8207661780829145e-12, "cur_lr": 1.9999999494757503e-05, "total_loss": 3008.34619140625, "policy_loss": -40.36166763305664, "vf_loss": 3048.701171875, "vf_explained_var": -0.0006140470504760742, "kl": 0.0005188450450077653, "entropy": 2.5758748054504395}, "num_steps_trained": 2496000, "num_steps_sampled": 2496000, "sample_time_ms": 138206.942, "grad_time_ms": 4132.673, "update_time_ms": 3.427, "opt_peak_throughput": 3871.586, "sample_peak_throughput": 115.768, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2496000, "episodes_total": 52913, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-51-09", "timestamp": 1569775869, "training_iteration": 156, "time_this_iter_s": 134.3356635570526, "time_total_s": 29273.881923675537, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6212e8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 5327.8416583538055, "timesteps_since_restore": 576000, "iterations_since_restore": 36}
{"episode_reward_max": 2525.352170713542, "episode_reward_min": 0.0, "episode_reward_mean": 313.2748451400976, "episode_len_mean": 82.9381443298969, "episodes_this_iter": 194, "policy_reward_mean": {"av": 57.012495269398634}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.9103830890414573e-12, "cur_lr": 1.9999999494757503e-05, "total_loss": 2764.5458984375, "policy_loss": -38.01402282714844, "vf_loss": 2802.55517578125, "vf_explained_var": -0.0005654096603393555, "kl": 0.0008828880381770432, "entropy": 2.5748627185821533}, "num_steps_trained": 2512000, "num_steps_sampled": 2512000, "sample_time_ms": 136851.72, "grad_time_ms": 4161.079, "update_time_ms": 3.445, "opt_peak_throughput": 3845.157, "sample_peak_throughput": 116.915, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2512000, "episodes_total": 53107, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-53-27", "timestamp": 1569776007, "training_iteration": 157, "time_this_iter_s": 137.70055961608887, "time_total_s": 29411.582483291626, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621780>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 5465.542217969894, "timesteps_since_restore": 592000, "iterations_since_restore": 37}
{"episode_reward_max": 2030.8577977644195, "episode_reward_min": 0.0, "episode_reward_mean": 304.9311103429229, "episode_len_mean": 82.00523560209425, "episodes_this_iter": 191, "policy_reward_mean": {"av": 55.31039133475621}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.4551915445207286e-12, "cur_lr": 1.9999999494757503e-05, "total_loss": 2829.13623046875, "policy_loss": -38.50615692138672, "vf_loss": 2867.643310546875, "vf_explained_var": -0.0004949569702148438, "kl": 0.0003544050850905478, "entropy": 2.5772879123687744}, "num_steps_trained": 2528000, "num_steps_sampled": 2528000, "sample_time_ms": 136479.08, "grad_time_ms": 4179.136, "update_time_ms": 3.517, "opt_peak_throughput": 3828.543, "sample_peak_throughput": 117.234, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2528000, "episodes_total": 53298, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-55-37", "timestamp": 1569776137, "training_iteration": 158, "time_this_iter_s": 130.15885519981384, "time_total_s": 29541.74133849144, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6214e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 5595.701073169708, "timesteps_since_restore": 608000, "iterations_since_restore": 38}
{"episode_reward_max": 1783.5740059803766, "episode_reward_min": 0.0, "episode_reward_mean": 334.53477281714567, "episode_len_mean": 88.07978723404256, "episodes_this_iter": 188, "policy_reward_mean": {"av": 58.39604205164659}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 7.275957722603643e-13, "cur_lr": 1.9999999494757503e-05, "total_loss": 2740.919921875, "policy_loss": -37.630191802978516, "vf_loss": 2778.54345703125, "vf_explained_var": -0.00046563148498535156, "kl": 0.001033291919156909, "entropy": 2.5828895568847656}, "num_steps_trained": 2544000, "num_steps_sampled": 2544000, "sample_time_ms": 134141.861, "grad_time_ms": 4196.558, "update_time_ms": 3.537, "opt_peak_throughput": 3812.648, "sample_peak_throughput": 119.277, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2544000, "episodes_total": 53486, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_18-57-52", "timestamp": 1569776272, "training_iteration": 159, "time_this_iter_s": 134.66601991653442, "time_total_s": 29676.407358407974, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621c88>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 5730.367093086243, "timesteps_since_restore": 624000, "iterations_since_restore": 39}
{"episode_reward_max": 3020.795632656563, "episode_reward_min": 0.0, "episode_reward_mean": 353.4383593298344, "episode_len_mean": 90.25287356321839, "episodes_this_iter": 174, "policy_reward_mean": {"av": 61.375523476438296}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.6379788613018216e-13, "cur_lr": 1.9999999494757503e-05, "total_loss": 2978.7099609375, "policy_loss": -40.00759506225586, "vf_loss": 3018.720703125, "vf_explained_var": -0.0005211830139160156, "kl": 0.0009937286376953125, "entropy": 2.5794565677642822}, "num_steps_trained": 2560000, "num_steps_sampled": 2560000, "sample_time_ms": 132733.072, "grad_time_ms": 4208.468, "update_time_ms": 3.507, "opt_peak_throughput": 3801.859, "sample_peak_throughput": 120.543, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2560000, "episodes_total": 53660, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-00-02", "timestamp": 1569776402, "training_iteration": 160, "time_this_iter_s": 130.37207961082458, "time_total_s": 29806.7794380188, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621f98>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 5860.739172697067, "timesteps_since_restore": 640000, "iterations_since_restore": 40}
{"episode_reward_max": 2223.0032815103423, "episode_reward_min": 0.0, "episode_reward_mean": 362.2009141573613, "episode_len_mean": 93.64117647058823, "episodes_this_iter": 170, "policy_reward_mean": {"av": 61.75943370787505}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.8189894306509108e-13, "cur_lr": 1.9999999494757503e-05, "total_loss": 3010.996337890625, "policy_loss": -40.12367630004883, "vf_loss": 3051.113525390625, "vf_explained_var": -0.0005298852920532227, "kl": 0.0020644650794565678, "entropy": 2.5669057369232178}, "num_steps_trained": 2576000, "num_steps_sampled": 2576000, "sample_time_ms": 129297.851, "grad_time_ms": 4224.949, "update_time_ms": 3.457, "opt_peak_throughput": 3787.028, "sample_peak_throughput": 123.745, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2576000, "episodes_total": 53830, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-02-04", "timestamp": 1569776524, "training_iteration": 161, "time_this_iter_s": 122.43475675582886, "time_total_s": 29929.214194774628, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61fcf8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 5983.173929452896, "timesteps_since_restore": 656000, "iterations_since_restore": 41}
{"episode_reward_max": 2301.96579191353, "episode_reward_min": 0.0, "episode_reward_mean": 370.45463623728006, "episode_len_mean": 92.65497076023392, "episodes_this_iter": 171, "policy_reward_mean": {"av": 63.411153950525446}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 9.094947153254554e-14, "cur_lr": 1.9999999494757503e-05, "total_loss": 3092.634521484375, "policy_loss": -40.8970947265625, "vf_loss": 3133.530517578125, "vf_explained_var": -0.0004477500915527344, "kl": 0.0006819891277700663, "entropy": 2.575981616973877}, "num_steps_trained": 2592000, "num_steps_sampled": 2592000, "sample_time_ms": 127672.051, "grad_time_ms": 4242.733, "update_time_ms": 3.491, "opt_peak_throughput": 3771.154, "sample_peak_throughput": 125.321, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2592000, "episodes_total": 54001, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-04-15", "timestamp": 1569776655, "training_iteration": 162, "time_this_iter_s": 130.31566166877747, "time_total_s": 30059.529856443405, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621f28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 6113.489591121674, "timesteps_since_restore": 672000, "iterations_since_restore": 42}
{"episode_reward_max": 3758.839100434287, "episode_reward_min": 0.0, "episode_reward_mean": 358.99179769211355, "episode_len_mean": 91.52486187845304, "episodes_this_iter": 181, "policy_reward_mean": {"av": 62.00144597545093}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.547473576627277e-14, "cur_lr": 1.9999999494757503e-05, "total_loss": 2894.056884765625, "policy_loss": -39.05219268798828, "vf_loss": 2933.0966796875, "vf_explained_var": -0.0003895759582519531, "kl": 0.0011438404908403754, "entropy": 2.588974952697754}, "num_steps_trained": 2608000, "num_steps_sampled": 2608000, "sample_time_ms": 128254.499, "grad_time_ms": 4259.132, "update_time_ms": 3.491, "opt_peak_throughput": 3756.634, "sample_peak_throughput": 124.752, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2608000, "episodes_total": 54182, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-06-29", "timestamp": 1569776789, "training_iteration": 163, "time_this_iter_s": 133.89196515083313, "time_total_s": 30193.42182159424, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621a58>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 6247.381556272507, "timesteps_since_restore": 688000, "iterations_since_restore": 43}
{"episode_reward_max": 2605.216948575314, "episode_reward_min": 0.0, "episode_reward_mean": 416.4435441507588, "episode_len_mean": 107.66896551724138, "episodes_this_iter": 145, "policy_reward_mean": {"av": 65.84985158327157}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.2737367883136385e-14, "cur_lr": 1.9999999494757503e-05, "total_loss": 2942.6376953125, "policy_loss": -39.9941291809082, "vf_loss": 2982.6220703125, "vf_explained_var": -0.00046312808990478516, "kl": 0.0023086275905370712, "entropy": 2.5943996906280518}, "num_steps_trained": 2624000, "num_steps_sampled": 2624000, "sample_time_ms": 123830.978, "grad_time_ms": 4266.783, "update_time_ms": 3.646, "opt_peak_throughput": 3749.898, "sample_peak_throughput": 129.208, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2624000, "episodes_total": 54327, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-08-13", "timestamp": 1569776893, "training_iteration": 164, "time_this_iter_s": 104.64841485023499, "time_total_s": 30298.070236444473, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c607a90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 6352.029971122742, "timesteps_since_restore": 704000, "iterations_since_restore": 44}
{"episode_reward_max": 2552.1520017344046, "episode_reward_min": 0.0, "episode_reward_mean": 320.13259892651087, "episode_len_mean": 82.87113402061856, "episodes_this_iter": 194, "policy_reward_mean": {"av": 58.53508406384835}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.1368683941568192e-14, "cur_lr": 1.9999999494757503e-05, "total_loss": 3000.80908203125, "policy_loss": -39.86638259887695, "vf_loss": 3040.66845703125, "vf_explained_var": -0.0004405975341796875, "kl": 0.0024554096162319183, "entropy": 2.5846822261810303}, "num_steps_trained": 2640000, "num_steps_sampled": 2640000, "sample_time_ms": 125215.631, "grad_time_ms": 4316.23, "update_time_ms": 3.741, "opt_peak_throughput": 3706.939, "sample_peak_throughput": 127.78, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2640000, "episodes_total": 54521, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-10-30", "timestamp": 1569777030, "training_iteration": 165, "time_this_iter_s": 136.93923020362854, "time_total_s": 30435.0094666481, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f9e8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 6488.96920132637, "timesteps_since_restore": 720000, "iterations_since_restore": 45}
{"episode_reward_max": 2617.8442870373965, "episode_reward_min": 0.0, "episode_reward_mean": 514.5690914035431, "episode_len_mean": 123.76377952755905, "episodes_this_iter": 127, "policy_reward_mean": {"av": 75.37517255853514}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 5.684341970784096e-15, "cur_lr": 1.9999999494757503e-05, "total_loss": 3334.921875, "policy_loss": -43.47918701171875, "vf_loss": 3378.400390625, "vf_explained_var": -0.00040411949157714844, "kl": 0.00033516710391268134, "entropy": 2.57598614692688}, "num_steps_trained": 2656000, "num_steps_sampled": 2656000, "sample_time_ms": 122333.936, "grad_time_ms": 4343.049, "update_time_ms": 3.639, "opt_peak_throughput": 3684.048, "sample_peak_throughput": 130.79, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2656000, "episodes_total": 54648, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-12-16", "timestamp": 1569777136, "training_iteration": 166, "time_this_iter_s": 105.78537678718567, "time_total_s": 30540.794843435287, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f278>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 6594.754578113556, "timesteps_since_restore": 736000, "iterations_since_restore": 46}
{"episode_reward_max": 2308.7366153840817, "episode_reward_min": 0.0, "episode_reward_mean": 411.29355663205183, "episode_len_mean": 103.01898734177215, "episodes_this_iter": 158, "policy_reward_mean": {"av": 66.58235855313954}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.842170985392048e-15, "cur_lr": 1.9999999494757503e-05, "total_loss": 3118.912109375, "policy_loss": -40.86430358886719, "vf_loss": 3159.77001953125, "vf_explained_var": -0.00040435791015625, "kl": 0.0018545902566984296, "entropy": 2.574981451034546}, "num_steps_trained": 2672000, "num_steps_sampled": 2672000, "sample_time_ms": 120400.625, "grad_time_ms": 4317.993, "update_time_ms": 3.689, "opt_peak_throughput": 3705.426, "sample_peak_throughput": 132.89, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2672000, "episodes_total": 54806, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-14-14", "timestamp": 1569777254, "training_iteration": 167, "time_this_iter_s": 118.11452865600586, "time_total_s": 30658.909372091293, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c607ef0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 6712.869106769562, "timesteps_since_restore": 752000, "iterations_since_restore": 47}
{"episode_reward_max": 2422.3783325977424, "episode_reward_min": 0.0, "episode_reward_mean": 356.342459936786, "episode_len_mean": 91.0909090909091, "episodes_this_iter": 176, "policy_reward_mean": {"av": 61.91142443126787}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.421085492696024e-15, "cur_lr": 1.9999999494757503e-05, "total_loss": 3069.52783203125, "policy_loss": -40.45524597167969, "vf_loss": 3109.9775390625, "vf_explained_var": -0.00041735172271728516, "kl": 0.00031029892852529883, "entropy": 2.5718178749084473}, "num_steps_trained": 2688000, "num_steps_sampled": 2688000, "sample_time_ms": 119857.868, "grad_time_ms": 4324.365, "update_time_ms": 3.683, "opt_peak_throughput": 3699.965, "sample_peak_throughput": 133.491, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2688000, "episodes_total": 54982, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-16-19", "timestamp": 1569777379, "training_iteration": 168, "time_this_iter_s": 124.79557514190674, "time_total_s": 30783.7049472332, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f278>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 6837.6646819114685, "timesteps_since_restore": 768000, "iterations_since_restore": 48}
{"episode_reward_max": 3161.3546257085945, "episode_reward_min": 0.0, "episode_reward_mean": 404.10452245843135, "episode_len_mean": 100.76923076923077, "episodes_this_iter": 156, "policy_reward_mean": {"av": 66.35821631948978}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 7.10542746348012e-16, "cur_lr": 1.9999999494757503e-05, "total_loss": 3341.53125, "policy_loss": -42.44606018066406, "vf_loss": 3383.971923828125, "vf_explained_var": -0.0003757476806640625, "kl": 0.0017671366222202778, "entropy": 2.559569835662842}, "num_steps_trained": 2704000, "num_steps_sampled": 2704000, "sample_time_ms": 118590.072, "grad_time_ms": 4338.644, "update_time_ms": 3.594, "opt_peak_throughput": 3687.788, "sample_peak_throughput": 134.919, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2704000, "episodes_total": 55138, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-18-21", "timestamp": 1569777501, "training_iteration": 169, "time_this_iter_s": 122.13018584251404, "time_total_s": 30905.835133075714, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621710>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 6959.7948677539825, "timesteps_since_restore": 784000, "iterations_since_restore": 49}
{"episode_reward_max": 3335.2638857332536, "episode_reward_min": 0.0, "episode_reward_mean": 408.48794729991954, "episode_len_mean": 102.25974025974025, "episodes_this_iter": 154, "policy_reward_mean": {"av": 66.70959054526786}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.55271373174006e-16, "cur_lr": 1.9999999494757503e-05, "total_loss": 2994.393798828125, "policy_loss": -40.06179428100586, "vf_loss": 3034.4560546875, "vf_explained_var": -0.0004131793975830078, "kl": 0.0012718694051727653, "entropy": 2.541480541229248}, "num_steps_trained": 2720000, "num_steps_sampled": 2720000, "sample_time_ms": 116962.042, "grad_time_ms": 4344.858, "update_time_ms": 3.51, "opt_peak_throughput": 3682.514, "sample_peak_throughput": 136.797, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2720000, "episodes_total": 55292, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-20-15", "timestamp": 1569777615, "training_iteration": 170, "time_this_iter_s": 114.15317893028259, "time_total_s": 31019.988312005997, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f0f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 7073.948046684265, "timesteps_since_restore": 800000, "iterations_since_restore": 50}
{"episode_reward_max": 3841.369655463197, "episode_reward_min": 0.0, "episode_reward_mean": 434.5135259407488, "episode_len_mean": 106.84177215189874, "episodes_this_iter": 158, "policy_reward_mean": {"av": 69.55738307866092}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.77635686587003e-16, "cur_lr": 1.9999999494757503e-05, "total_loss": 3045.614990234375, "policy_loss": -40.5303840637207, "vf_loss": 3086.140380859375, "vf_explained_var": -0.0003082752227783203, "kl": 0.003957458771765232, "entropy": 2.5360817909240723}, "num_steps_trained": 2736000, "num_steps_sampled": 2736000, "sample_time_ms": 116849.751, "grad_time_ms": 4365.53, "update_time_ms": 3.596, "opt_peak_throughput": 3665.076, "sample_peak_throughput": 136.928, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2736000, "episodes_total": 55450, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-22-17", "timestamp": 1569777737, "training_iteration": 171, "time_this_iter_s": 121.51969313621521, "time_total_s": 31141.508005142212, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f8d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 7195.46773982048, "timesteps_since_restore": 816000, "iterations_since_restore": 51}
{"episode_reward_max": 3461.2978022318043, "episode_reward_min": 0.0, "episode_reward_mean": 413.7175615562115, "episode_len_mean": 101.85620915032679, "episodes_this_iter": 153, "policy_reward_mean": {"av": 67.62690910053456}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 8.88178432935015e-17, "cur_lr": 1.9999999494757503e-05, "total_loss": 3313.2353515625, "policy_loss": -42.828895568847656, "vf_loss": 3356.071044921875, "vf_explained_var": -0.0003648996353149414, "kl": 0.0015238783089444041, "entropy": 2.5295512676239014}, "num_steps_trained": 2752000, "num_steps_sampled": 2752000, "sample_time_ms": 116009.252, "grad_time_ms": 4372.0, "update_time_ms": 3.54, "opt_peak_throughput": 3659.652, "sample_peak_throughput": 137.92, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2752000, "episodes_total": 55603, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-24-19", "timestamp": 1569777859, "training_iteration": 172, "time_this_iter_s": 121.97455024719238, "time_total_s": 31263.482555389404, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f208>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 7317.442290067673, "timesteps_since_restore": 832000, "iterations_since_restore": 52}
{"episode_reward_max": 3100.411285488472, "episode_reward_min": 0.0, "episode_reward_mean": 561.6031624207831, "episode_len_mean": 130.712, "episodes_this_iter": 125, "policy_reward_mean": {"av": 79.95489214418893}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.440892164675075e-17, "cur_lr": 1.9999999494757503e-05, "total_loss": 3477.8046875, "policy_loss": -44.137691497802734, "vf_loss": 3521.930908203125, "vf_explained_var": -0.00022482872009277344, "kl": 0.003355153137817979, "entropy": 2.5061142444610596}, "num_steps_trained": 2768000, "num_steps_sampled": 2768000, "sample_time_ms": 113481.265, "grad_time_ms": 4420.934, "update_time_ms": 3.574, "opt_peak_throughput": 3619.145, "sample_peak_throughput": 140.992, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2768000, "episodes_total": 55728, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-26-08", "timestamp": 1569777968, "training_iteration": 173, "time_this_iter_s": 109.10162711143494, "time_total_s": 31372.58418250084, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61fa20>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 7426.543917179108, "timesteps_since_restore": 848000, "iterations_since_restore": 53}
{"episode_reward_max": 2708.155538032181, "episode_reward_min": 0.0, "episode_reward_mean": 518.7799623460977, "episode_len_mean": 124.12096774193549, "episodes_this_iter": 124, "policy_reward_mean": {"av": 76.12865719635045}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.2204460823375376e-17, "cur_lr": 1.9999999494757503e-05, "total_loss": 3362.200927734375, "policy_loss": -43.55430221557617, "vf_loss": 3405.7470703125, "vf_explained_var": -0.00036323070526123047, "kl": 0.0019163958495482802, "entropy": 2.4780545234680176}, "num_steps_trained": 2784000, "num_steps_sampled": 2784000, "sample_time_ms": 113459.834, "grad_time_ms": 4444.336, "update_time_ms": 3.5, "opt_peak_throughput": 3600.088, "sample_peak_throughput": 141.019, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2784000, "episodes_total": 55852, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-27-53", "timestamp": 1569778073, "training_iteration": 174, "time_this_iter_s": 104.66777634620667, "time_total_s": 31477.251958847046, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61fc50>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 7531.211693525314, "timesteps_since_restore": 864000, "iterations_since_restore": 54}
{"episode_reward_max": 2530.536263325576, "episode_reward_min": 0.0, "episode_reward_mean": 579.8339235909748, "episode_len_mean": 136.34745762711864, "episodes_this_iter": 118, "policy_reward_mean": {"av": 80.87518083183811}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.1102230411687688e-17, "cur_lr": 1.9999999494757503e-05, "total_loss": 3648.11181640625, "policy_loss": -45.65629577636719, "vf_loss": 3693.769287109375, "vf_explained_var": -0.0003610849380493164, "kl": 0.002553638769313693, "entropy": 2.474113941192627}, "num_steps_trained": 2800000, "num_steps_sampled": 2800000, "sample_time_ms": 109565.242, "grad_time_ms": 4445.651, "update_time_ms": 3.412, "opt_peak_throughput": 3599.023, "sample_peak_throughput": 146.032, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2800000, "episodes_total": 55970, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-29-31", "timestamp": 1569778171, "training_iteration": 175, "time_this_iter_s": 98.00034666061401, "time_total_s": 31575.25230550766, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61fcc0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 7629.212040185928, "timesteps_since_restore": 880000, "iterations_since_restore": 55}
{"episode_reward_max": 4222.912151001515, "episode_reward_min": 0.0, "episode_reward_mean": 601.0238117071511, "episode_len_mean": 137.6271186440678, "episodes_this_iter": 118, "policy_reward_mean": {"av": 82.754737201218}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 5.551115205843844e-18, "cur_lr": 1.9999999494757503e-05, "total_loss": 3496.520263671875, "policy_loss": -44.44461441040039, "vf_loss": 3540.960693359375, "vf_explained_var": -0.00027954578399658203, "kl": 0.0012695780023932457, "entropy": 2.475080966949463}, "num_steps_trained": 2816000, "num_steps_sampled": 2816000, "sample_time_ms": 109110.236, "grad_time_ms": 4455.376, "update_time_ms": 3.47, "opt_peak_throughput": 3591.167, "sample_peak_throughput": 146.641, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2816000, "episodes_total": 56088, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-31-12", "timestamp": 1569778272, "training_iteration": 176, "time_this_iter_s": 101.33245849609375, "time_total_s": 31676.584764003754, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f278>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 7730.544498682022, "timesteps_since_restore": 896000, "iterations_since_restore": 56}
{"episode_reward_max": 3261.500240166899, "episode_reward_min": 0.0, "episode_reward_mean": 514.3995633428303, "episode_len_mean": 123.28461538461538, "episodes_this_iter": 130, "policy_reward_mean": {"av": 75.39114231631109}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.775557602921922e-18, "cur_lr": 1.9999999494757503e-05, "total_loss": 3304.279296875, "policy_loss": -42.735130310058594, "vf_loss": 3347.01513671875, "vf_explained_var": -0.0002614259719848633, "kl": 0.002008058363571763, "entropy": 2.476146936416626}, "num_steps_trained": 2832000, "num_steps_sampled": 2832000, "sample_time_ms": 108045.11, "grad_time_ms": 4532.75, "update_time_ms": 3.249, "opt_peak_throughput": 3529.866, "sample_peak_throughput": 148.086, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2832000, "episodes_total": 56218, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-33-00", "timestamp": 1569778380, "training_iteration": 177, "time_this_iter_s": 108.23578906059265, "time_total_s": 31784.820553064346, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f5f8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 7838.780287742615, "timesteps_since_restore": 912000, "iterations_since_restore": 57}
{"episode_reward_max": 3153.4424385772572, "episode_reward_min": 0.0, "episode_reward_mean": 648.278702719527, "episode_len_mean": 145.85454545454544, "episodes_this_iter": 110, "policy_reward_mean": {"av": 86.33251489000966}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.387778801460961e-18, "cur_lr": 1.9999999494757503e-05, "total_loss": 3531.514892578125, "policy_loss": -44.649803161621094, "vf_loss": 3576.156005859375, "vf_explained_var": -0.0003114938735961914, "kl": 0.0045397295616567135, "entropy": 2.4551713466644287}, "num_steps_trained": 2848000, "num_steps_sampled": 2848000, "sample_time_ms": 105292.977, "grad_time_ms": 4580.457, "update_time_ms": 3.286, "opt_peak_throughput": 3493.101, "sample_peak_throughput": 151.957, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2848000, "episodes_total": 56328, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-34-38", "timestamp": 1569778478, "training_iteration": 178, "time_this_iter_s": 97.75141716003418, "time_total_s": 31882.57197022438, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f390>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 7936.531704902649, "timesteps_since_restore": 928000, "iterations_since_restore": 58}
{"episode_reward_max": 3390.665869254174, "episode_reward_min": 0.0, "episode_reward_mean": 605.1541474908532, "episode_len_mean": 135.6386554621849, "episodes_this_iter": 119, "policy_reward_mean": {"av": 83.93163584080598}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.938894007304805e-19, "cur_lr": 1.9999999494757503e-05, "total_loss": 3588.64990234375, "policy_loss": -45.27832794189453, "vf_loss": 3633.932373046875, "vf_explained_var": -0.0002652406692504883, "kl": 0.002612887881696224, "entropy": 2.4412875175476074}, "num_steps_trained": 2864000, "num_steps_sampled": 2864000, "sample_time_ms": 103506.458, "grad_time_ms": 4620.252, "update_time_ms": 3.33, "opt_peak_throughput": 3463.014, "sample_peak_throughput": 154.58, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2864000, "episodes_total": 56447, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-36-23", "timestamp": 1569778583, "training_iteration": 179, "time_this_iter_s": 104.6626341342926, "time_total_s": 31987.234604358673, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f8d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 8041.1943390369415, "timesteps_since_restore": 944000, "iterations_since_restore": 59}
{"episode_reward_max": 2850.104428455375, "episode_reward_min": 0.0, "episode_reward_mean": 597.1986115252591, "episode_len_mean": 138.4561403508772, "episodes_this_iter": 114, "policy_reward_mean": {"av": 81.9261633139345}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 1.9999999494757503e-05, "total_loss": 3448.5361328125, "policy_loss": -43.840187072753906, "vf_loss": 3492.37841796875, "vf_explained_var": -0.00026798248291015625, "kl": 0.008138456381857395, "entropy": 2.423224925994873}, "num_steps_trained": 2880000, "num_steps_sampled": 2880000, "sample_time_ms": 101905.151, "grad_time_ms": 4682.944, "update_time_ms": 3.444, "opt_peak_throughput": 3416.654, "sample_peak_throughput": 157.009, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2880000, "episodes_total": 56561, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-38-01", "timestamp": 1569778681, "training_iteration": 180, "time_this_iter_s": 98.76718378067017, "time_total_s": 32086.001788139343, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f278>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 8139.961522817612, "timesteps_since_restore": 960000, "iterations_since_restore": 60}
{"episode_reward_max": 4017.1031545234746, "episode_reward_min": 0.0, "episode_reward_mean": 671.2678142446226, "episode_len_mean": 152.98019801980197, "episodes_this_iter": 101, "policy_reward_mean": {"av": 87.03215563377005}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.4694470036524025e-19, "cur_lr": 1.9999999494757503e-05, "total_loss": 3513.717529296875, "policy_loss": -44.58958053588867, "vf_loss": 3558.29736328125, "vf_explained_var": -0.0002633333206176758, "kl": 0.002410676097497344, "entropy": 2.397064208984375}, "num_steps_trained": 2896000, "num_steps_sampled": 2896000, "sample_time_ms": 99726.093, "grad_time_ms": 4729.556, "update_time_ms": 3.387, "opt_peak_throughput": 3382.982, "sample_peak_throughput": 160.439, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2896000, "episodes_total": 56662, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-39-42", "timestamp": 1569778782, "training_iteration": 181, "time_this_iter_s": 100.19306516647339, "time_total_s": 32186.194853305817, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621ef0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 8240.154587984085, "timesteps_since_restore": 976000, "iterations_since_restore": 61}
{"episode_reward_max": 2946.1775201415535, "episode_reward_min": 0.0, "episode_reward_mean": 740.1129059127932, "episode_len_mean": 166.91, "episodes_this_iter": 94, "policy_reward_mean": {"av": 90.25767145277968}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.7347235018262012e-19, "cur_lr": 1.9999999494757503e-05, "total_loss": 3782.3505859375, "policy_loss": -47.05924606323242, "vf_loss": 3829.406494140625, "vf_explained_var": -0.0002474784851074219, "kl": 0.002601041691377759, "entropy": 2.376014232635498}, "num_steps_trained": 2912000, "num_steps_sampled": 2912000, "sample_time_ms": 96706.181, "grad_time_ms": 4760.561, "update_time_ms": 3.407, "opt_peak_throughput": 3360.948, "sample_peak_throughput": 165.45, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2912000, "episodes_total": 56756, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-41-14", "timestamp": 1569778874, "training_iteration": 182, "time_this_iter_s": 92.08542799949646, "time_total_s": 32278.280281305313, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f780>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 8332.240015983582, "timesteps_since_restore": 992000, "iterations_since_restore": 62}
{"episode_reward_max": 3975.6192882035384, "episode_reward_min": 0.0, "episode_reward_mean": 602.6431973389003, "episode_len_mean": 138.61206896551724, "episodes_this_iter": 116, "policy_reward_mean": {"av": 82.53436941123071}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 8.673617509131006e-20, "cur_lr": 1.9999999494757503e-05, "total_loss": 3349.27783203125, "policy_loss": -43.274471282958984, "vf_loss": 3392.5498046875, "vf_explained_var": -0.0001920461654663086, "kl": 0.0017349799163639545, "entropy": 2.377990484237671}, "num_steps_trained": 2928000, "num_steps_sampled": 2928000, "sample_time_ms": 96153.553, "grad_time_ms": 4751.784, "update_time_ms": 3.429, "opt_peak_throughput": 3367.157, "sample_peak_throughput": 166.401, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2928000, "episodes_total": 56872, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-42-57", "timestamp": 1569778977, "training_iteration": 183, "time_this_iter_s": 103.4868175983429, "time_total_s": 32381.767098903656, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621f98>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 8435.726833581924, "timesteps_since_restore": 1008000, "iterations_since_restore": 63}
{"episode_reward_max": 5002.018206557938, "episode_reward_min": 0.0, "episode_reward_mean": 727.4762252764323, "episode_len_mean": 160.55, "episodes_this_iter": 100, "policy_reward_mean": {"av": 91.96918145087632}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.336808754565503e-20, "cur_lr": 1.9999999494757503e-05, "total_loss": 3617.110107421875, "policy_loss": -45.79616928100586, "vf_loss": 3662.910400390625, "vf_explained_var": -0.0003650188446044922, "kl": 0.001301018986850977, "entropy": 2.358945846557617}, "num_steps_trained": 2944000, "num_steps_sampled": 2944000, "sample_time_ms": 94901.339, "grad_time_ms": 4808.266, "update_time_ms": 3.384, "opt_peak_throughput": 3327.603, "sample_peak_throughput": 168.596, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2944000, "episodes_total": 56972, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-44-30", "timestamp": 1569779070, "training_iteration": 184, "time_this_iter_s": 92.71216464042664, "time_total_s": 32474.479263544083, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c636f98>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 8528.438998222351, "timesteps_since_restore": 1024000, "iterations_since_restore": 64}
{"episode_reward_max": 3814.3741063551493, "episode_reward_min": 0.0, "episode_reward_mean": 714.7738888436842, "episode_len_mean": 155.88235294117646, "episodes_this_iter": 102, "policy_reward_mean": {"av": 91.93812946034782}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.1684043772827515e-20, "cur_lr": 1.9999999494757503e-05, "total_loss": 3664.550048828125, "policy_loss": -45.89684295654297, "vf_loss": 3710.44189453125, "vf_explained_var": -0.00022590160369873047, "kl": 0.0017002078238874674, "entropy": 2.358555793762207}, "num_steps_trained": 2960000, "num_steps_sampled": 2960000, "sample_time_ms": 95043.319, "grad_time_ms": 4836.216, "update_time_ms": 3.357, "opt_peak_throughput": 3308.372, "sample_peak_throughput": 168.344, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2960000, "episodes_total": 57074, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-46-10", "timestamp": 1569779170, "training_iteration": 185, "time_this_iter_s": 99.70001935958862, "time_total_s": 32574.17928290367, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621d30>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 8628.13901758194, "timesteps_since_restore": 1040000, "iterations_since_restore": 65}
{"episode_reward_max": 3581.0285596957333, "episode_reward_min": 0.0, "episode_reward_mean": 589.8290203673643, "episode_len_mean": 136.14285714285714, "episodes_this_iter": 119, "policy_reward_mean": {"av": 81.710888735409}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.0842021886413758e-20, "cur_lr": 1.9999999494757503e-05, "total_loss": 3307.6689453125, "policy_loss": -42.979896545410156, "vf_loss": 3350.64404296875, "vf_explained_var": -0.00027549266815185547, "kl": 0.0008378585334867239, "entropy": 2.3419089317321777}, "num_steps_trained": 2976000, "num_steps_sampled": 2976000, "sample_time_ms": 95335.836, "grad_time_ms": 4841.992, "update_time_ms": 3.358, "opt_peak_throughput": 3304.425, "sample_peak_throughput": 167.828, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2976000, "episodes_total": 57193, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-47-54", "timestamp": 1569779274, "training_iteration": 186, "time_this_iter_s": 104.31552863121033, "time_total_s": 32678.49481153488, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621550>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 8732.45454621315, "timesteps_since_restore": 1056000, "iterations_since_restore": 66}
{"episode_reward_max": 4854.181509738603, "episode_reward_min": 0.0, "episode_reward_mean": 715.538973714781, "episode_len_mean": 160.88, "episodes_this_iter": 98, "policy_reward_mean": {"av": 90.23190084675673}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 1.9999999494757503e-05, "total_loss": 3588.52490234375, "policy_loss": -45.450294494628906, "vf_loss": 3633.961181640625, "vf_explained_var": -0.0002497434616088867, "kl": 0.008061695843935013, "entropy": 2.3297646045684814}, "num_steps_trained": 2992000, "num_steps_sampled": 2992000, "sample_time_ms": 94114.686, "grad_time_ms": 4850.828, "update_time_ms": 3.517, "opt_peak_throughput": 3298.406, "sample_peak_throughput": 170.005, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 2992000, "episodes_total": 57291, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-49-30", "timestamp": 1569779370, "training_iteration": 187, "time_this_iter_s": 96.11326241493225, "time_total_s": 32774.608073949814, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621c50>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 8828.567808628082, "timesteps_since_restore": 1072000, "iterations_since_restore": 67}
{"episode_reward_max": 3150.709288671003, "episode_reward_min": 0.0, "episode_reward_mean": 740.8553839914867, "episode_len_mean": 163.38, "episodes_this_iter": 98, "policy_reward_mean": {"av": 92.03172471943935}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 5.421010943206879e-21, "cur_lr": 1.9999999494757503e-05, "total_loss": 3849.232421875, "policy_loss": -47.14341735839844, "vf_loss": 3896.38134765625, "vf_explained_var": -0.0002224445343017578, "kl": 0.0009454719256609678, "entropy": 2.3404221534729004}, "num_steps_trained": 3008000, "num_steps_sampled": 3008000, "sample_time_ms": 93500.142, "grad_time_ms": 4893.351, "update_time_ms": 3.494, "opt_peak_throughput": 3269.743, "sample_peak_throughput": 171.123, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3008000, "episodes_total": 57389, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-51-02", "timestamp": 1569779462, "training_iteration": 188, "time_this_iter_s": 92.03121161460876, "time_total_s": 32866.63928556442, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6219b0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 8920.599020242691, "timesteps_since_restore": 1088000, "iterations_since_restore": 68}
{"episode_reward_max": 3016.029342324003, "episode_reward_min": 0.0, "episode_reward_mean": 722.6281583009525, "episode_len_mean": 162.97, "episodes_this_iter": 97, "policy_reward_mean": {"av": 89.3236289617988}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.7105054716034394e-21, "cur_lr": 1.9999999494757503e-05, "total_loss": 3619.94921875, "policy_loss": -45.41640090942383, "vf_loss": 3665.37060546875, "vf_explained_var": -0.00022852420806884766, "kl": 0.0005751877906732261, "entropy": 2.328031063079834}, "num_steps_trained": 3024000, "num_steps_sampled": 3024000, "sample_time_ms": 91924.417, "grad_time_ms": 4928.765, "update_time_ms": 3.495, "opt_peak_throughput": 3246.249, "sample_peak_throughput": 174.056, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3024000, "episodes_total": 57486, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-52-31", "timestamp": 1569779551, "training_iteration": 189, "time_this_iter_s": 89.25898909568787, "time_total_s": 32955.89827466011, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621d30>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 9009.858009338379, "timesteps_since_restore": 1104000, "iterations_since_restore": 69}
{"episode_reward_max": 3085.9641462174964, "episode_reward_min": 0.0, "episode_reward_mean": 734.1486446295104, "episode_len_mean": 164.25, "episodes_this_iter": 95, "policy_reward_mean": {"av": 90.52387726627748}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 1.9999999494757503e-05, "total_loss": 3686.94140625, "policy_loss": -46.37925338745117, "vf_loss": 3733.32275390625, "vf_explained_var": -0.0002599954605102539, "kl": 0.008533326908946037, "entropy": 2.3117048740386963}, "num_steps_trained": 3040000, "num_steps_sampled": 3040000, "sample_time_ms": 91239.405, "grad_time_ms": 4936.476, "update_time_ms": 3.48, "opt_peak_throughput": 3241.179, "sample_peak_throughput": 175.363, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3040000, "episodes_total": 57581, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-54-03", "timestamp": 1569779643, "training_iteration": 190, "time_this_iter_s": 91.99470591545105, "time_total_s": 33047.89298057556, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621518>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 9101.85271525383, "timesteps_since_restore": 1120000, "iterations_since_restore": 70}
{"episode_reward_max": 3600.3889018887944, "episode_reward_min": 0.0, "episode_reward_mean": 826.2347684993097, "episode_len_mean": 182.05, "episodes_this_iter": 87, "policy_reward_mean": {"av": 95.73983412506487}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.3552527358017197e-21, "cur_lr": 1.9999999494757503e-05, "total_loss": 3661.38720703125, "policy_loss": -46.17884826660156, "vf_loss": 3707.56640625, "vf_explained_var": -0.00020003318786621094, "kl": 0.003995203413069248, "entropy": 2.3088462352752686}, "num_steps_trained": 3056000, "num_steps_sampled": 3056000, "sample_time_ms": 90118.502, "grad_time_ms": 4970.851, "update_time_ms": 3.468, "opt_peak_throughput": 3218.765, "sample_peak_throughput": 177.544, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3056000, "episodes_total": 57668, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-55-33", "timestamp": 1569779733, "training_iteration": 191, "time_this_iter_s": 89.32819151878357, "time_total_s": 33137.221172094345, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6211d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 9191.180906772614, "timesteps_since_restore": 1136000, "iterations_since_restore": 71}
{"episode_reward_max": 3492.0695430872133, "episode_reward_min": 0.0, "episode_reward_mean": 740.7480829265139, "episode_len_mean": 167.93, "episodes_this_iter": 94, "policy_reward_mean": {"av": 91.11292532921452}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 1.9999999494757503e-05, "total_loss": 3673.1005859375, "policy_loss": -45.918418884277344, "vf_loss": 3719.00341796875, "vf_explained_var": -0.00018858909606933594, "kl": 0.006239073351025581, "entropy": 2.3085262775421143}, "num_steps_trained": 3072000, "num_steps_sampled": 3072000, "sample_time_ms": 89651.318, "grad_time_ms": 5004.918, "update_time_ms": 3.53, "opt_peak_throughput": 3196.856, "sample_peak_throughput": 178.469, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3072000, "episodes_total": 57762, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-57-01", "timestamp": 1569779821, "training_iteration": 192, "time_this_iter_s": 87.75437307357788, "time_total_s": 33224.97554516792, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621cc0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 9278.935279846191, "timesteps_since_restore": 1152000, "iterations_since_restore": 72}
{"episode_reward_max": 3561.6447336239266, "episode_reward_min": 0.0, "episode_reward_mean": 727.4875346075041, "episode_len_mean": 161.0990099009901, "episodes_this_iter": 101, "policy_reward_mean": {"av": 91.73063794676395}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.776263679008599e-22, "cur_lr": 1.9999999494757503e-05, "total_loss": 3667.1787109375, "policy_loss": -45.74814987182617, "vf_loss": 3712.92822265625, "vf_explained_var": -0.00017821788787841797, "kl": 0.0028455383144319057, "entropy": 2.298389434814453}, "num_steps_trained": 3088000, "num_steps_sampled": 3088000, "sample_time_ms": 88413.936, "grad_time_ms": 5068.34, "update_time_ms": 3.464, "opt_peak_throughput": 3156.852, "sample_peak_throughput": 180.967, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3088000, "episodes_total": 57863, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_19-58-32", "timestamp": 1569779912, "training_iteration": 193, "time_this_iter_s": 91.74740147590637, "time_total_s": 33316.72294664383, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621ef0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 9370.682681322098, "timesteps_since_restore": 1168000, "iterations_since_restore": 73}
{"episode_reward_max": 3156.162640742348, "episode_reward_min": 0.0, "episode_reward_mean": 612.8719601900435, "episode_len_mean": 141.07207207207207, "episodes_this_iter": 111, "policy_reward_mean": {"av": 83.26656986670108}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.3881318395042993e-22, "cur_lr": 1.9999999494757503e-05, "total_loss": 3453.416748046875, "policy_loss": -44.237709045410156, "vf_loss": 3497.6630859375, "vf_explained_var": -0.00015914440155029297, "kl": 0.00039314129389822483, "entropy": 2.299283981323242}, "num_steps_trained": 3104000, "num_steps_sampled": 3104000, "sample_time_ms": 89149.82, "grad_time_ms": 5022.471, "update_time_ms": 3.455, "opt_peak_throughput": 3185.683, "sample_peak_throughput": 179.473, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3104000, "episodes_total": 57974, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-00-12", "timestamp": 1569780012, "training_iteration": 194, "time_this_iter_s": 99.60962677001953, "time_total_s": 33416.33257341385, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621710>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 9470.292308092117, "timesteps_since_restore": 1184000, "iterations_since_restore": 74}
{"episode_reward_max": 3318.1194188011254, "episode_reward_min": 0.0, "episode_reward_mean": 740.0064628101983, "episode_len_mean": 161.73529411764707, "episodes_this_iter": 102, "policy_reward_mean": {"av": 92.72808256344003}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.6940659197521496e-22, "cur_lr": 1.9999999494757503e-05, "total_loss": 3774.13037109375, "policy_loss": -46.6003303527832, "vf_loss": 3820.73046875, "vf_explained_var": -0.000202178955078125, "kl": 0.0010562896495684981, "entropy": 2.3168201446533203}, "num_steps_trained": 3120000, "num_steps_sampled": 3120000, "sample_time_ms": 88542.957, "grad_time_ms": 5007.616, "update_time_ms": 3.476, "opt_peak_throughput": 3195.133, "sample_peak_throughput": 180.703, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3120000, "episodes_total": 58076, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-01-45", "timestamp": 1569780105, "training_iteration": 195, "time_this_iter_s": 93.48249197006226, "time_total_s": 33509.81506538391, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632278>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 9563.77480006218, "timesteps_since_restore": 1200000, "iterations_since_restore": 75}
{"episode_reward_max": 3802.895565753038, "episode_reward_min": 0.0, "episode_reward_mean": 833.6352647099025, "episode_len_mean": 181.21, "episodes_this_iter": 89, "policy_reward_mean": {"av": 96.82174967594682}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 8.470329598760748e-23, "cur_lr": 1.9999999494757503e-05, "total_loss": 3787.676025390625, "policy_loss": -46.5980339050293, "vf_loss": 3834.268310546875, "vf_explained_var": -0.00014126300811767578, "kl": 0.0018838433315977454, "entropy": 2.31508469581604}, "num_steps_trained": 3136000, "num_steps_sampled": 3136000, "sample_time_ms": 87453.009, "grad_time_ms": 5041.157, "update_time_ms": 3.509, "opt_peak_throughput": 3173.875, "sample_peak_throughput": 182.955, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3136000, "episodes_total": 58165, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-03-19", "timestamp": 1569780199, "training_iteration": 196, "time_this_iter_s": 93.7517294883728, "time_total_s": 33603.566794872284, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632518>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 9657.526529550552, "timesteps_since_restore": 1216000, "iterations_since_restore": 76}
{"episode_reward_max": 4092.7645351576125, "episode_reward_min": 0.0, "episode_reward_mean": 774.8915996316902, "episode_len_mean": 171.61, "episodes_this_iter": 93, "policy_reward_mean": {"av": 93.0242016364574}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 1.9999999494757503e-05, "total_loss": 3760.793701171875, "policy_loss": -46.623722076416016, "vf_loss": 3807.408935546875, "vf_explained_var": -0.0001882314682006836, "kl": 0.005092984531074762, "entropy": 2.3056020736694336}, "num_steps_trained": 3152000, "num_steps_sampled": 3152000, "sample_time_ms": 87280.463, "grad_time_ms": 5025.174, "update_time_ms": 3.51, "opt_peak_throughput": 3183.969, "sample_peak_throughput": 183.317, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3152000, "episodes_total": 58258, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-04-53", "timestamp": 1569780293, "training_iteration": 197, "time_this_iter_s": 94.22826385498047, "time_total_s": 33697.795058727264, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6322e8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 9751.754793405533, "timesteps_since_restore": 1232000, "iterations_since_restore": 77}
{"episode_reward_max": 4912.347975626894, "episode_reward_min": 0.0, "episode_reward_mean": 906.44001277762, "episode_len_mean": 189.23, "episodes_this_iter": 92, "policy_reward_mean": {"av": 102.30699918483292}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.235164799380374e-23, "cur_lr": 1.9999999494757503e-05, "total_loss": 3693.362060546875, "policy_loss": -46.54068374633789, "vf_loss": 3739.900634765625, "vf_explained_var": -4.5418739318847656e-05, "kl": 0.001342364470474422, "entropy": 2.3258860111236572}, "num_steps_trained": 3168000, "num_steps_sampled": 3168000, "sample_time_ms": 87379.076, "grad_time_ms": 5017.355, "update_time_ms": 3.39, "opt_peak_throughput": 3188.931, "sample_peak_throughput": 183.11, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3168000, "episodes_total": 58350, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-06-26", "timestamp": 1569780386, "training_iteration": 198, "time_this_iter_s": 92.93763995170593, "time_total_s": 33790.73269867897, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6320b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 9844.692433357239, "timesteps_since_restore": 1248000, "iterations_since_restore": 78}
{"episode_reward_max": 3609.585395209584, "episode_reward_min": 0.0, "episode_reward_mean": 826.0047811195952, "episode_len_mean": 179.43, "episodes_this_iter": 87, "policy_reward_mean": {"av": 96.3832883453437}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.117582399690187e-23, "cur_lr": 1.9999999494757503e-05, "total_loss": 3868.024658203125, "policy_loss": -47.38182067871094, "vf_loss": 3915.40234375, "vf_explained_var": -7.772445678710938e-05, "kl": 0.003822393249720335, "entropy": 2.3176510334014893}, "num_steps_trained": 3184000, "num_steps_sampled": 3184000, "sample_time_ms": 87412.77, "grad_time_ms": 4998.98, "update_time_ms": 3.446, "opt_peak_throughput": 3200.653, "sample_peak_throughput": 183.04, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3184000, "episodes_total": 58437, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-07-56", "timestamp": 1569780476, "training_iteration": 199, "time_this_iter_s": 89.4120523929596, "time_total_s": 33880.14475107193, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632278>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 9934.104485750198, "timesteps_since_restore": 1264000, "iterations_since_restore": 79}
{"episode_reward_max": 3426.1088264054742, "episode_reward_min": 0.0, "episode_reward_mean": 761.514745444485, "episode_len_mean": 170.13, "episodes_this_iter": 93, "policy_reward_mean": {"av": 92.64169652609309}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 1.9999999494757503e-05, "total_loss": 3637.21240234375, "policy_loss": -45.75699996948242, "vf_loss": 3682.9677734375, "vf_explained_var": -0.00019812583923339844, "kl": 0.006693672854453325, "entropy": 2.292426824569702}, "num_steps_trained": 3200000, "num_steps_sampled": 3200000, "sample_time_ms": 87414.535, "grad_time_ms": 4958.686, "update_time_ms": 3.397, "opt_peak_throughput": 3226.661, "sample_peak_throughput": 183.036, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3200000, "episodes_total": 58530, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-09-27", "timestamp": 1569780567, "training_iteration": 200, "time_this_iter_s": 91.60934901237488, "time_total_s": 33971.754100084305, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6323c8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 10025.713834762573, "timesteps_since_restore": 1280000, "iterations_since_restore": 80}
{"episode_reward_max": 3504.252279304657, "episode_reward_min": 0.0, "episode_reward_mean": 790.8856783414933, "episode_len_mean": 173.21, "episodes_this_iter": 94, "policy_reward_mean": {"av": 94.60355004084853}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.0587911998450935e-23, "cur_lr": 1.9999999494757503e-05, "total_loss": 3663.075927734375, "policy_loss": -45.835391998291016, "vf_loss": 3708.904052734375, "vf_explained_var": -0.00017440319061279297, "kl": 0.0023001369554549456, "entropy": 2.2934789657592773}, "num_steps_trained": 3216000, "num_steps_sampled": 3216000, "sample_time_ms": 87525.916, "grad_time_ms": 4912.718, "update_time_ms": 3.42, "opt_peak_throughput": 3256.853, "sample_peak_throughput": 182.803, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3216000, "episodes_total": 58624, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-10-57", "timestamp": 1569780657, "training_iteration": 201, "time_this_iter_s": 89.98178625106812, "time_total_s": 34061.73588633537, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621c18>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 10115.695621013641, "timesteps_since_restore": 1296000, "iterations_since_restore": 81}
{"episode_reward_max": 3112.1845089186177, "episode_reward_min": 0.0, "episode_reward_mean": 867.3647082173818, "episode_len_mean": 188.46, "episodes_this_iter": 87, "policy_reward_mean": {"av": 98.00731166298098}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 1.9999999494757503e-05, "total_loss": 3755.34228515625, "policy_loss": -47.31344223022461, "vf_loss": 3802.647705078125, "vf_explained_var": -0.0001239776611328125, "kl": 0.009940417483448982, "entropy": 2.2694249153137207}, "num_steps_trained": 3232000, "num_steps_sampled": 3232000, "sample_time_ms": 87845.69, "grad_time_ms": 4908.718, "update_time_ms": 3.329, "opt_peak_throughput": 3259.507, "sample_peak_throughput": 182.138, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3232000, "episodes_total": 58711, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-12-28", "timestamp": 1569780748, "training_iteration": 202, "time_this_iter_s": 90.912282705307, "time_total_s": 34152.64816904068, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6326d8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 10206.607903718948, "timesteps_since_restore": 1312000, "iterations_since_restore": 82}
{"episode_reward_max": 3036.5895441632265, "episode_reward_min": 0.0, "episode_reward_mean": 593.4256269099777, "episode_len_mean": 140.86238532110093, "episodes_this_iter": 109, "policy_reward_mean": {"av": 80.85424166648446}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 5.293955999225468e-24, "cur_lr": 1.9999999494757503e-05, "total_loss": 3387.745361328125, "policy_loss": -43.166358947753906, "vf_loss": 3430.91015625, "vf_explained_var": -0.00015413761138916016, "kl": 0.004920554347336292, "entropy": 2.251089572906494}, "num_steps_trained": 3248000, "num_steps_sampled": 3248000, "sample_time_ms": 88603.235, "grad_time_ms": 4839.119, "update_time_ms": 3.468, "opt_peak_throughput": 3306.387, "sample_peak_throughput": 180.58, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3248000, "episodes_total": 58820, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-14-07", "timestamp": 1569780847, "training_iteration": 203, "time_this_iter_s": 98.6265480518341, "time_total_s": 34251.274717092514, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26debf8d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 10305.234451770782, "timesteps_since_restore": 1328000, "iterations_since_restore": 83}
{"episode_reward_max": 3572.3138089414197, "episode_reward_min": 0.0, "episode_reward_mean": 888.0715340705226, "episode_len_mean": 192.69, "episodes_this_iter": 76, "policy_reward_mean": {"av": 98.894380186027}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 1.9999999494757503e-05, "total_loss": 3835.820556640625, "policy_loss": -47.044864654541016, "vf_loss": 3882.86328125, "vf_explained_var": -0.0001367330551147461, "kl": 0.00766450259834528, "entropy": 2.2441046237945557}, "num_steps_trained": 3264000, "num_steps_sampled": 3264000, "sample_time_ms": 86744.291, "grad_time_ms": 4862.559, "update_time_ms": 3.551, "opt_peak_throughput": 3290.448, "sample_peak_throughput": 184.45, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3264000, "episodes_total": 58896, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-15-28", "timestamp": 1569780928, "training_iteration": 204, "time_this_iter_s": 81.25601029396057, "time_total_s": 34332.530727386475, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6324a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 10386.490462064743, "timesteps_since_restore": 1344000, "iterations_since_restore": 84}
{"episode_reward_max": 4496.606418985539, "episode_reward_min": 0.0, "episode_reward_mean": 907.4311172973185, "episode_len_mean": 197.11, "episodes_this_iter": 86, "policy_reward_mean": {"av": 99.82740564326939}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.646977999612734e-24, "cur_lr": 1.9999999494757503e-05, "total_loss": 3637.562255859375, "policy_loss": -45.84400939941406, "vf_loss": 3683.406982421875, "vf_explained_var": -0.00014889240264892578, "kl": 0.004823334515094757, "entropy": 2.224052667617798}, "num_steps_trained": 3280000, "num_steps_sampled": 3280000, "sample_time_ms": 85645.054, "grad_time_ms": 4855.547, "update_time_ms": 3.603, "opt_peak_throughput": 3295.2, "sample_peak_throughput": 186.818, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3280000, "episodes_total": 58982, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-16-51", "timestamp": 1569781011, "training_iteration": 205, "time_this_iter_s": 82.42085480690002, "time_total_s": 34414.951582193375, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c607b00>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 10468.911316871643, "timesteps_since_restore": 1360000, "iterations_since_restore": 85}
{"episode_reward_max": 4496.606418985539, "episode_reward_min": 1.450861263784915, "episode_reward_mean": 896.139435760129, "episode_len_mean": 196.71, "episodes_this_iter": 83, "policy_reward_mean": {"av": 98.69377045816404}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.323488999806367e-24, "cur_lr": 1.9999999494757503e-05, "total_loss": 3640.73876953125, "policy_loss": -45.9652099609375, "vf_loss": 3686.70361328125, "vf_explained_var": -0.00016415119171142578, "kl": 0.0014188818167895079, "entropy": 2.2191522121429443}, "num_steps_trained": 3296000, "num_steps_sampled": 3296000, "sample_time_ms": 84550.959, "grad_time_ms": 4836.153, "update_time_ms": 3.506, "opt_peak_throughput": 3308.415, "sample_peak_throughput": 189.235, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3296000, "episodes_total": 59065, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-18-13", "timestamp": 1569781093, "training_iteration": 206, "time_this_iter_s": 82.6160249710083, "time_total_s": 34497.56760716438, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6324a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 10551.527341842651, "timesteps_since_restore": 1376000, "iterations_since_restore": 86}
{"episode_reward_max": 3363.6006718669914, "episode_reward_min": 0.0, "episode_reward_mean": 844.5372445907683, "episode_len_mean": 185.73, "episodes_this_iter": 87, "policy_reward_mean": {"av": 96.408361254654}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 1.9999999494757503e-05, "total_loss": 3731.800537109375, "policy_loss": -46.249412536621094, "vf_loss": 3778.042724609375, "vf_explained_var": -0.00013720989227294922, "kl": 0.008387870155274868, "entropy": 2.212364673614502}, "num_steps_trained": 3312000, "num_steps_sampled": 3312000, "sample_time_ms": 83415.038, "grad_time_ms": 4835.358, "update_time_ms": 3.462, "opt_peak_throughput": 3308.958, "sample_peak_throughput": 191.812, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3312000, "episodes_total": 59152, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-19-36", "timestamp": 1569781176, "training_iteration": 207, "time_this_iter_s": 82.86013555526733, "time_total_s": 34580.42774271965, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621128>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 10634.387477397919, "timesteps_since_restore": 1392000, "iterations_since_restore": 87}
{"episode_reward_max": 3598.1075660876018, "episode_reward_min": 0.0, "episode_reward_mean": 816.8998968138677, "episode_len_mean": 178.09, "episodes_this_iter": 88, "policy_reward_mean": {"av": 96.3325350016353}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 1.9999999494757503e-05, "total_loss": 3796.595458984375, "policy_loss": -47.06657791137695, "vf_loss": 3843.6669921875, "vf_explained_var": -0.00012981891632080078, "kl": 0.005273596383631229, "entropy": 2.2079837322235107}, "num_steps_trained": 3328000, "num_steps_sampled": 3328000, "sample_time_ms": 82977.78, "grad_time_ms": 4830.923, "update_time_ms": 3.531, "opt_peak_throughput": 3311.997, "sample_peak_throughput": 192.823, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3328000, "episodes_total": 59240, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-21-05", "timestamp": 1569781265, "training_iteration": 208, "time_this_iter_s": 88.52107977867126, "time_total_s": 34668.94882249832, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6324a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 10722.90855717659, "timesteps_since_restore": 1408000, "iterations_since_restore": 88}
{"episode_reward_max": 4381.815802697538, "episode_reward_min": 0.0, "episode_reward_mean": 915.5427918693971, "episode_len_mean": 197.77, "episodes_this_iter": 75, "policy_reward_mean": {"av": 101.05328828580541}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.617444999031835e-25, "cur_lr": 1.9999999494757503e-05, "total_loss": 3773.736572265625, "policy_loss": -46.92439651489258, "vf_loss": 3820.664306640625, "vf_explained_var": -0.00017082691192626953, "kl": 0.0016098347259685397, "entropy": 2.224874496459961}, "num_steps_trained": 3344000, "num_steps_sampled": 3344000, "sample_time_ms": 81888.22, "grad_time_ms": 4827.835, "update_time_ms": 3.494, "opt_peak_throughput": 3314.115, "sample_peak_throughput": 195.388, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3344000, "episodes_total": 59315, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-22-23", "timestamp": 1569781343, "training_iteration": 209, "time_this_iter_s": 78.48580741882324, "time_total_s": 34747.434629917145, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632cc0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 10801.394364595413, "timesteps_since_restore": 1424000, "iterations_since_restore": 89}
{"episode_reward_max": 4264.999173985064, "episode_reward_min": 0.0, "episode_reward_mean": 658.7238223755633, "episode_len_mean": 149.57798165137615, "episodes_this_iter": 109, "policy_reward_mean": {"av": 87.24288777513534}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.3087224995159173e-25, "cur_lr": 1.9999999494757503e-05, "total_loss": 3515.457275390625, "policy_loss": -44.4178466796875, "vf_loss": 3559.87890625, "vf_explained_var": -5.841255187988281e-05, "kl": 0.0026049348525702953, "entropy": 2.2235453128814697}, "num_steps_trained": 3360000, "num_steps_sampled": 3360000, "sample_time_ms": 82678.403, "grad_time_ms": 4869.448, "update_time_ms": 3.537, "opt_peak_throughput": 3285.794, "sample_peak_throughput": 193.521, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3360000, "episodes_total": 59424, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-24-03", "timestamp": 1569781443, "training_iteration": 210, "time_this_iter_s": 99.9271936416626, "time_total_s": 34847.36182355881, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6329e8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 10901.321558237076, "timesteps_since_restore": 1440000, "iterations_since_restore": 90}
{"episode_reward_max": 4744.683112115195, "episode_reward_min": 2.937721294638607, "episode_reward_mean": 932.1533476369742, "episode_len_mean": 198.96, "episodes_this_iter": 72, "policy_reward_mean": {"av": 102.09784749583507}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.6543612497579586e-25, "cur_lr": 1.9999999494757503e-05, "total_loss": 3908.460205078125, "policy_loss": -48.29658126831055, "vf_loss": 3956.740478515625, "vf_explained_var": 7.069110870361328e-05, "kl": 0.004031571093946695, "entropy": 2.206857204437256}, "num_steps_trained": 3376000, "num_steps_sampled": 3376000, "sample_time_ms": 81907.804, "grad_time_ms": 4910.025, "update_time_ms": 3.553, "opt_peak_throughput": 3258.639, "sample_peak_throughput": 195.342, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3376000, "episodes_total": 59496, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-25-26", "timestamp": 1569781526, "training_iteration": 211, "time_this_iter_s": 82.68243050575256, "time_total_s": 34930.04425406456, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632d30>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 10984.003988742828, "timesteps_since_restore": 1456000, "iterations_since_restore": 91}
{"episode_reward_max": 4296.840212783054, "episode_reward_min": 0.0, "episode_reward_mean": 926.220166749854, "episode_len_mean": 201.43, "episodes_this_iter": 84, "policy_reward_mean": {"av": 100.89544300107346}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 8.271806248789793e-26, "cur_lr": 1.9999999494757503e-05, "total_loss": 3638.671630859375, "policy_loss": -45.6098518371582, "vf_loss": 3684.271484375, "vf_explained_var": -0.00016236305236816406, "kl": 0.0020947717130184174, "entropy": 2.2084038257598877}, "num_steps_trained": 3392000, "num_steps_sampled": 3392000, "sample_time_ms": 80754.75, "grad_time_ms": 4889.941, "update_time_ms": 3.592, "opt_peak_throughput": 3272.023, "sample_peak_throughput": 198.131, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3392000, "episodes_total": 59580, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-26-45", "timestamp": 1569781605, "training_iteration": 212, "time_this_iter_s": 79.1806116104126, "time_total_s": 35009.22486567497, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632b38>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 11063.184600353241, "timesteps_since_restore": 1472000, "iterations_since_restore": 92}
{"episode_reward_max": 3303.2037041511758, "episode_reward_min": 0.0, "episode_reward_mean": 816.1195419706529, "episode_len_mean": 181.39, "episodes_this_iter": 87, "policy_reward_mean": {"av": 94.6774410638808}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.1359031243948966e-26, "cur_lr": 1.9999999494757503e-05, "total_loss": 3707.2490234375, "policy_loss": -46.47871780395508, "vf_loss": 3753.725341796875, "vf_explained_var": -0.00013303756713867188, "kl": 0.0006583176436834037, "entropy": 2.2195193767547607}, "num_steps_trained": 3408000, "num_steps_sampled": 3408000, "sample_time_ms": 79283.351, "grad_time_ms": 4906.265, "update_time_ms": 3.487, "opt_peak_throughput": 3261.136, "sample_peak_throughput": 201.808, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3408000, "episodes_total": 59667, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-28-09", "timestamp": 1569781689, "training_iteration": 213, "time_this_iter_s": 84.07500553131104, "time_total_s": 35093.29987120628, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6327f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 11147.259605884552, "timesteps_since_restore": 1488000, "iterations_since_restore": 93}
{"episode_reward_max": 3536.926067453206, "episode_reward_min": 0.0, "episode_reward_mean": 741.9024022513429, "episode_len_mean": 166.85, "episodes_this_iter": 95, "policy_reward_mean": {"av": 91.81960423902757}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.0679515621974483e-26, "cur_lr": 1.9999999494757503e-05, "total_loss": 3582.768798828125, "policy_loss": -45.28233337402344, "vf_loss": 3628.05517578125, "vf_explained_var": -0.00013744831085205078, "kl": 0.0012232469161972404, "entropy": 2.2304673194885254}, "num_steps_trained": 3424000, "num_steps_sampled": 3424000, "sample_time_ms": 80538.519, "grad_time_ms": 4899.192, "update_time_ms": 3.431, "opt_peak_throughput": 3265.845, "sample_peak_throughput": 198.663, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3424000, "episodes_total": 59762, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-29-43", "timestamp": 1569781783, "training_iteration": 214, "time_this_iter_s": 93.7359561920166, "time_total_s": 35187.0358273983, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632908>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 11240.995562076569, "timesteps_since_restore": 1504000, "iterations_since_restore": 94}
{"episode_reward_max": 3182.105793816474, "episode_reward_min": 0.0, "episode_reward_mean": 822.1017719933583, "episode_len_mean": 179.98, "episodes_this_iter": 82, "policy_reward_mean": {"av": 95.92786137612116}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.0339757810987241e-26, "cur_lr": 1.9999999494757503e-05, "total_loss": 3720.019287109375, "policy_loss": -46.25429916381836, "vf_loss": 3766.275146484375, "vf_explained_var": -0.00014197826385498047, "kl": 0.003012735163792968, "entropy": 2.2354300022125244}, "num_steps_trained": 3440000, "num_steps_sampled": 3440000, "sample_time_ms": 80656.826, "grad_time_ms": 4913.893, "update_time_ms": 3.408, "opt_peak_throughput": 3256.074, "sample_peak_throughput": 198.371, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3440000, "episodes_total": 59844, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-31-07", "timestamp": 1569781867, "training_iteration": 215, "time_this_iter_s": 83.75030755996704, "time_total_s": 35270.78613495827, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632fd0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 11324.745869636536, "timesteps_since_restore": 1520000, "iterations_since_restore": 95}
{"episode_reward_max": 4159.003692243833, "episode_reward_min": 0.0, "episode_reward_mean": 961.8554913079507, "episode_len_mean": 201.43, "episodes_this_iter": 79, "policy_reward_mean": {"av": 103.98437743869732}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 5.169878905493621e-27, "cur_lr": 1.9999999494757503e-05, "total_loss": 4005.021240234375, "policy_loss": -48.54627990722656, "vf_loss": 4053.55419921875, "vf_explained_var": -0.00010585784912109375, "kl": 0.0017560283886268735, "entropy": 2.232043504714966}, "num_steps_trained": 3456000, "num_steps_sampled": 3456000, "sample_time_ms": 80972.226, "grad_time_ms": 4972.954, "update_time_ms": 3.457, "opt_peak_throughput": 3217.404, "sample_peak_throughput": 197.599, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3456000, "episodes_total": 59923, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-32-33", "timestamp": 1569781953, "training_iteration": 216, "time_this_iter_s": 86.3605489730835, "time_total_s": 35357.14668393135, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6324a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 11411.10641860962, "timesteps_since_restore": 1536000, "iterations_since_restore": 96}
{"episode_reward_max": 3338.949481467141, "episode_reward_min": 0.0, "episode_reward_mean": 733.0474879800157, "episode_len_mean": 163.99, "episodes_this_iter": 99, "policy_reward_mean": {"av": 90.83611994795731}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.5849394527468104e-27, "cur_lr": 1.9999999494757503e-05, "total_loss": 3670.359619140625, "policy_loss": -45.676692962646484, "vf_loss": 3716.02294921875, "vf_explained_var": -0.00011301040649414062, "kl": 0.004985745996236801, "entropy": 2.226222038269043}, "num_steps_trained": 3472000, "num_steps_sampled": 3472000, "sample_time_ms": 82032.079, "grad_time_ms": 4956.294, "update_time_ms": 3.426, "opt_peak_throughput": 3228.219, "sample_peak_throughput": 195.046, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3472000, "episodes_total": 60022, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-34-06", "timestamp": 1569782046, "training_iteration": 217, "time_this_iter_s": 93.29173731803894, "time_total_s": 35450.43842124939, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6327f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 11504.398155927658, "timesteps_since_restore": 1552000, "iterations_since_restore": 97}
{"episode_reward_max": 5790.46085624404, "episode_reward_min": 0.0, "episode_reward_mean": 856.9200395128878, "episode_len_mean": 181.61, "episodes_this_iter": 86, "policy_reward_mean": {"av": 99.64186505963806}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.2924697263734052e-27, "cur_lr": 1.9999999494757503e-05, "total_loss": 3915.165283203125, "policy_loss": -47.77763748168945, "vf_loss": 3962.9453125, "vf_explained_var": -3.2782554626464844e-05, "kl": 0.005979384295642376, "entropy": 2.2232649326324463}, "num_steps_trained": 3488000, "num_steps_sampled": 3488000, "sample_time_ms": 82551.797, "grad_time_ms": 4978.093, "update_time_ms": 3.428, "opt_peak_throughput": 3214.082, "sample_peak_throughput": 193.818, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3488000, "episodes_total": 60108, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-35-40", "timestamp": 1569782140, "training_iteration": 218, "time_this_iter_s": 93.93711614608765, "time_total_s": 35544.37553739548, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621240>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 11598.335272073746, "timesteps_since_restore": 1568000, "iterations_since_restore": 98}
{"episode_reward_max": 3700.983687506856, "episode_reward_min": 1.4500250051324373, "episode_reward_mean": 778.1788723978904, "episode_len_mean": 176.21, "episodes_this_iter": 88, "policy_reward_mean": {"av": 92.09217424827102}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.2924697263734052e-27, "cur_lr": 1.9999999494757503e-05, "total_loss": 3630.255859375, "policy_loss": -45.17332458496094, "vf_loss": 3675.42578125, "vf_explained_var": -0.00011217594146728516, "kl": 0.001304201316088438, "entropy": 2.215855836868286}, "num_steps_trained": 3504000, "num_steps_sampled": 3504000, "sample_time_ms": 83665.364, "grad_time_ms": 4966.937, "update_time_ms": 3.401, "opt_peak_throughput": 3221.301, "sample_peak_throughput": 191.238, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3504000, "episodes_total": 60196, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-37-10", "timestamp": 1569782230, "training_iteration": 219, "time_this_iter_s": 89.50948429107666, "time_total_s": 35633.885021686554, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632a20>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 11687.844756364822, "timesteps_since_restore": 1584000, "iterations_since_restore": 99}
{"episode_reward_max": 3815.6768473448114, "episode_reward_min": 0.0, "episode_reward_mean": 902.158021426712, "episode_len_mean": 192.94, "episodes_this_iter": 85, "policy_reward_mean": {"av": 101.02553431430151}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.462348631867026e-28, "cur_lr": 1.9999999494757503e-05, "total_loss": 3901.44873046875, "policy_loss": -47.78398895263672, "vf_loss": 3949.22265625, "vf_explained_var": -5.8531761169433594e-05, "kl": 0.006386667024344206, "entropy": 2.208371162414551}, "num_steps_trained": 3520000, "num_steps_sampled": 3520000, "sample_time_ms": 82742.153, "grad_time_ms": 4975.513, "update_time_ms": 3.42, "opt_peak_throughput": 3215.749, "sample_peak_throughput": 193.372, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3520000, "episodes_total": 60281, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-38-40", "timestamp": 1569782320, "training_iteration": 220, "time_this_iter_s": 90.78081583976746, "time_total_s": 35724.66583752632, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f1d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 11778.62557220459, "timesteps_since_restore": 1600000, "iterations_since_restore": 100}
{"episode_reward_max": 3801.3764857436668, "episode_reward_min": 0.0, "episode_reward_mean": 744.0512584546414, "episode_len_mean": 168.94, "episodes_this_iter": 93, "policy_reward_mean": {"av": 90.62743708339116}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.462348631867026e-28, "cur_lr": 1.9999999494757503e-05, "total_loss": 3576.010009765625, "policy_loss": -44.80492401123047, "vf_loss": 3620.8095703125, "vf_explained_var": -0.00010406970977783203, "kl": 0.001533676404505968, "entropy": 2.1965038776397705}, "num_steps_trained": 3536000, "num_steps_sampled": 3536000, "sample_time_ms": 83181.859, "grad_time_ms": 4942.961, "update_time_ms": 3.277, "opt_peak_throughput": 3236.926, "sample_peak_throughput": 192.35, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3536000, "episodes_total": 60374, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-40-07", "timestamp": 1569782407, "training_iteration": 221, "time_this_iter_s": 86.75321102142334, "time_total_s": 35811.419048547745, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621ba8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 11865.378783226013, "timesteps_since_restore": 1616000, "iterations_since_restore": 101}
{"episode_reward_max": 3386.9635896783084, "episode_reward_min": 0.0, "episode_reward_mean": 827.0288754852207, "episode_len_mean": 184.09, "episodes_this_iter": 84, "policy_reward_mean": {"av": 95.1701812986445}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.231174315933513e-28, "cur_lr": 1.9999999494757503e-05, "total_loss": 3521.62744140625, "policy_loss": -44.89018249511719, "vf_loss": 3566.510498046875, "vf_explained_var": -0.0001207590103149414, "kl": 0.001673517981544137, "entropy": 2.180860757827759}, "num_steps_trained": 3552000, "num_steps_sampled": 3552000, "sample_time_ms": 83600.492, "grad_time_ms": 4992.483, "update_time_ms": 3.303, "opt_peak_throughput": 3204.818, "sample_peak_throughput": 191.386, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3552000, "episodes_total": 60458, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-41-31", "timestamp": 1569782491, "training_iteration": 222, "time_this_iter_s": 83.8627724647522, "time_total_s": 35895.2818210125, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6329b0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 11949.241555690765, "timesteps_since_restore": 1632000, "iterations_since_restore": 102}
{"episode_reward_max": 4203.39371468512, "episode_reward_min": 0.0, "episode_reward_mean": 787.6600257341458, "episode_len_mean": 171.74, "episodes_this_iter": 92, "policy_reward_mean": {"av": 95.24305027015058}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.6155871579667565e-28, "cur_lr": 1.9999999494757503e-05, "total_loss": 3681.50390625, "policy_loss": -46.09006881713867, "vf_loss": 3727.59521484375, "vf_explained_var": -7.534027099609375e-05, "kl": 0.0026323653291910887, "entropy": 2.1886067390441895}, "num_steps_trained": 3568000, "num_steps_sampled": 3568000, "sample_time_ms": 84670.658, "grad_time_ms": 5022.758, "update_time_ms": 3.256, "opt_peak_throughput": 3185.501, "sample_peak_throughput": 188.967, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3568000, "episodes_total": 60550, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-43-06", "timestamp": 1569782586, "training_iteration": 223, "time_this_iter_s": 95.0794415473938, "time_total_s": 35990.36126255989, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621358>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 12044.32099723816, "timesteps_since_restore": 1648000, "iterations_since_restore": 103}
{"episode_reward_max": 4340.515408962468, "episode_reward_min": 0.0, "episode_reward_mean": 898.6656449183432, "episode_len_mean": 192.44, "episodes_this_iter": 71, "policy_reward_mean": {"av": 100.07412526930325}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 8.077935789833782e-29, "cur_lr": 1.9999999494757503e-05, "total_loss": 3775.880859375, "policy_loss": -47.233795166015625, "vf_loss": 3823.112548828125, "vf_explained_var": -4.100799560546875e-05, "kl": 0.0015712809981778264, "entropy": 2.191798686981201}, "num_steps_trained": 3584000, "num_steps_sampled": 3584000, "sample_time_ms": 83019.299, "grad_time_ms": 5063.358, "update_time_ms": 3.182, "opt_peak_throughput": 3159.958, "sample_peak_throughput": 192.726, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3584000, "episodes_total": 60621, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-44-24", "timestamp": 1569782664, "training_iteration": 224, "time_this_iter_s": 77.62777185440063, "time_total_s": 36067.98903441429, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6322b0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 12121.94876909256, "timesteps_since_restore": 1664000, "iterations_since_restore": 104}
{"episode_reward_max": 4250.100152940715, "episode_reward_min": 0.0, "episode_reward_mean": 888.8399537258422, "episode_len_mean": 195.5, "episodes_this_iter": 83, "policy_reward_mean": {"av": 98.10595515737771}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.038967894916891e-29, "cur_lr": 1.9999999494757503e-05, "total_loss": 3484.7216796875, "policy_loss": -44.712013244628906, "vf_loss": 3529.424072265625, "vf_explained_var": -0.00010156631469726562, "kl": 0.0013214031932875514, "entropy": 2.1987144947052}, "num_steps_trained": 3600000, "num_steps_sampled": 3600000, "sample_time_ms": 83027.06, "grad_time_ms": 5063.807, "update_time_ms": 3.092, "opt_peak_throughput": 3159.678, "sample_peak_throughput": 192.708, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3600000, "episodes_total": 60704, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-45-48", "timestamp": 1569782748, "training_iteration": 225, "time_this_iter_s": 83.83204579353333, "time_total_s": 36151.821080207825, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621978>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 12205.780814886093, "timesteps_since_restore": 1680000, "iterations_since_restore": 105}
{"episode_reward_max": 4250.100152940715, "episode_reward_min": 0.0, "episode_reward_mean": 944.1001593747569, "episode_len_mean": 201.06, "episodes_this_iter": 77, "policy_reward_mean": {"av": 102.17534192367502}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.0194839474584456e-29, "cur_lr": 1.9999999494757503e-05, "total_loss": 3803.572265625, "policy_loss": -46.98121643066406, "vf_loss": 3850.547119140625, "vf_explained_var": -8.308887481689453e-05, "kl": 0.007261333987116814, "entropy": 2.1887922286987305}, "num_steps_trained": 3616000, "num_steps_sampled": 3616000, "sample_time_ms": 82792.51, "grad_time_ms": 5029.806, "update_time_ms": 3.206, "opt_peak_throughput": 3181.037, "sample_peak_throughput": 193.254, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3616000, "episodes_total": 60781, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-47-11", "timestamp": 1569782831, "training_iteration": 226, "time_this_iter_s": 83.67656373977661, "time_total_s": 36235.4976439476, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632a58>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 12289.45737862587, "timesteps_since_restore": 1696000, "iterations_since_restore": 106}
{"episode_reward_max": 3461.598604940313, "episode_reward_min": 0.0, "episode_reward_mean": 870.2239043964983, "episode_len_mean": 190.68, "episodes_this_iter": 86, "policy_reward_mean": {"av": 97.55873367673745}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.0194839474584456e-29, "cur_lr": 1.9999999494757503e-05, "total_loss": 3545.14697265625, "policy_loss": -44.69855880737305, "vf_loss": 3589.842041015625, "vf_explained_var": -0.00011205673217773438, "kl": 0.003984319046139717, "entropy": 2.185380697250366}, "num_steps_trained": 3632000, "num_steps_sampled": 3632000, "sample_time_ms": 81827.755, "grad_time_ms": 5027.752, "update_time_ms": 3.299, "opt_peak_throughput": 3182.337, "sample_peak_throughput": 195.533, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3632000, "episodes_total": 60867, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-48-35", "timestamp": 1569782915, "training_iteration": 227, "time_this_iter_s": 83.62481474876404, "time_total_s": 36319.122458696365, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61fa20>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 12373.082193374634, "timesteps_since_restore": 1712000, "iterations_since_restore": 107}
{"episode_reward_max": 3824.147190118628, "episode_reward_min": 0.0, "episode_reward_mean": 929.1343658102834, "episode_len_mean": 202.97, "episodes_this_iter": 79, "policy_reward_mean": {"av": 100.23024442397873}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.0097419737292228e-29, "cur_lr": 1.9999999494757503e-05, "total_loss": 3703.6337890625, "policy_loss": -45.877506256103516, "vf_loss": 3749.500244140625, "vf_explained_var": -9.191036224365234e-05, "kl": 0.0027760097291320562, "entropy": 2.1910502910614014}, "num_steps_trained": 3648000, "num_steps_sampled": 3648000, "sample_time_ms": 80952.397, "grad_time_ms": 5047.912, "update_time_ms": 3.317, "opt_peak_throughput": 3169.627, "sample_peak_throughput": 197.647, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3648000, "episodes_total": 60946, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-50-00", "timestamp": 1569783000, "training_iteration": 228, "time_this_iter_s": 85.38481068611145, "time_total_s": 36404.50726938248, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6320b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 12458.467004060745, "timesteps_since_restore": 1728000, "iterations_since_restore": 108}
{"episode_reward_max": 3824.147190118628, "episode_reward_min": 2.9267454270373046, "episode_reward_mean": 1010.7225093800622, "episode_len_mean": 215.22, "episodes_this_iter": 74, "policy_reward_mean": {"av": 104.41348237397335}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 5.048709868646114e-30, "cur_lr": 1.9999999494757503e-05, "total_loss": 3737.298583984375, "policy_loss": -46.28116226196289, "vf_loss": 3783.578125, "vf_explained_var": -9.143352508544922e-05, "kl": 0.0019644019193947315, "entropy": 2.188055992126465}, "num_steps_trained": 3664000, "num_steps_sampled": 3664000, "sample_time_ms": 80326.1, "grad_time_ms": 5098.386, "update_time_ms": 3.379, "opt_peak_throughput": 3138.248, "sample_peak_throughput": 199.188, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3664000, "episodes_total": 61020, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-51-24", "timestamp": 1569783084, "training_iteration": 229, "time_this_iter_s": 83.75178170204163, "time_total_s": 36488.25905108452, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632d30>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 12542.218785762787, "timesteps_since_restore": 1744000, "iterations_since_restore": 109}
{"episode_reward_max": 3758.0254446939803, "episode_reward_min": 1.4663407169196316, "episode_reward_mean": 1045.3238588978163, "episode_len_mean": 220.61, "episodes_this_iter": 77, "policy_reward_mean": {"av": 106.01661854947427}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.524354934323057e-30, "cur_lr": 1.9999999494757503e-05, "total_loss": 3742.799072265625, "policy_loss": -46.4130973815918, "vf_loss": 3789.207763671875, "vf_explained_var": -0.00010013580322265625, "kl": 0.002699874807149172, "entropy": 2.1790354251861572}, "num_steps_trained": 3680000, "num_steps_sampled": 3680000, "sample_time_ms": 79774.656, "grad_time_ms": 5134.596, "update_time_ms": 3.247, "opt_peak_throughput": 3116.117, "sample_peak_throughput": 200.565, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3680000, "episodes_total": 61097, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-52-50", "timestamp": 1569783170, "training_iteration": 230, "time_this_iter_s": 85.62735891342163, "time_total_s": 36573.88640999794, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632a90>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 12627.846144676208, "timesteps_since_restore": 1760000, "iterations_since_restore": 110}
{"episode_reward_max": 3594.7585252707095, "episode_reward_min": 0.0, "episode_reward_mean": 913.5669731703879, "episode_len_mean": 198.13, "episodes_this_iter": 83, "policy_reward_mean": {"av": 100.17181723359516}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.2621774671615285e-30, "cur_lr": 1.9999999494757503e-05, "total_loss": 3686.8828125, "policy_loss": -45.80424880981445, "vf_loss": 3732.67724609375, "vf_explained_var": -9.66787338256836e-05, "kl": 0.0023508796002715826, "entropy": 2.1800553798675537}, "num_steps_trained": 3696000, "num_steps_sampled": 3696000, "sample_time_ms": 79736.919, "grad_time_ms": 5173.413, "update_time_ms": 3.364, "opt_peak_throughput": 3092.736, "sample_peak_throughput": 200.66, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3696000, "episodes_total": 61180, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-54-17", "timestamp": 1569783257, "training_iteration": 231, "time_this_iter_s": 86.76548981666565, "time_total_s": 36660.651899814606, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6324a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 12714.611634492874, "timesteps_since_restore": 1776000, "iterations_since_restore": 111}
{"episode_reward_max": 2741.196319613101, "episode_reward_min": 0.0, "episode_reward_mean": 681.757582008706, "episode_len_mean": 157.99, "episodes_this_iter": 99, "policy_reward_mean": {"av": 86.84809961894345}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.3108873358076425e-31, "cur_lr": 1.9999999494757503e-05, "total_loss": 3360.2236328125, "policy_loss": -42.77704620361328, "vf_loss": 3403.0009765625, "vf_explained_var": -0.00010371208190917969, "kl": 0.005121129099279642, "entropy": 2.1639864444732666}, "num_steps_trained": 3712000, "num_steps_sampled": 3712000, "sample_time_ms": 81051.956, "grad_time_ms": 5122.759, "update_time_ms": 3.423, "opt_peak_throughput": 3123.317, "sample_peak_throughput": 197.404, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3712000, "episodes_total": 61279, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-55-53", "timestamp": 1569783353, "training_iteration": 232, "time_this_iter_s": 96.50705289840698, "time_total_s": 36757.15895271301, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632550>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 12811.118687391281, "timesteps_since_restore": 1792000, "iterations_since_restore": 112}
{"episode_reward_max": 3255.062760937237, "episode_reward_min": 0.0, "episode_reward_mean": 1048.428464036337, "episode_len_mean": 221.97, "episodes_this_iter": 70, "policy_reward_mean": {"av": 106.00894479639408}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.3108873358076425e-31, "cur_lr": 1.9999999494757503e-05, "total_loss": 3898.777587890625, "policy_loss": -47.518218994140625, "vf_loss": 3946.295654296875, "vf_explained_var": -8.797645568847656e-05, "kl": 0.007872330024838448, "entropy": 2.144118309020996}, "num_steps_trained": 3728000, "num_steps_sampled": 3728000, "sample_time_ms": 79555.689, "grad_time_ms": 5135.134, "update_time_ms": 3.518, "opt_peak_throughput": 3115.79, "sample_peak_throughput": 201.117, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3728000, "episodes_total": 61349, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-57-13", "timestamp": 1569783433, "training_iteration": 233, "time_this_iter_s": 80.24140954017639, "time_total_s": 36837.40036225319, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632438>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 12891.360096931458, "timesteps_since_restore": 1808000, "iterations_since_restore": 113}
{"episode_reward_max": 3318.2763876464796, "episode_reward_min": 3.113415677797111, "episode_reward_mean": 1094.0500468189302, "episode_len_mean": 234.48, "episodes_this_iter": 72, "policy_reward_mean": {"av": 106.32167607569784}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.3108873358076425e-31, "cur_lr": 1.9999999494757503e-05, "total_loss": 3587.2841796875, "policy_loss": -45.02283477783203, "vf_loss": 3632.2998046875, "vf_explained_var": -8.392333984375e-05, "kl": 0.0009830581257119775, "entropy": 2.153477668762207}, "num_steps_trained": 3744000, "num_steps_sampled": 3744000, "sample_time_ms": 79793.527, "grad_time_ms": 5162.835, "update_time_ms": 3.629, "opt_peak_throughput": 3099.073, "sample_peak_throughput": 200.518, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3744000, "episodes_total": 61421, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_20-58-34", "timestamp": 1569783514, "training_iteration": 234, "time_this_iter_s": 80.285080909729, "time_total_s": 36917.68544316292, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632518>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 12971.645177841187, "timesteps_since_restore": 1824000, "iterations_since_restore": 114}
{"episode_reward_max": 4490.439677921593, "episode_reward_min": 0.0, "episode_reward_mean": 1101.9083795225267, "episode_len_mean": 231.41, "episodes_this_iter": 66, "policy_reward_mean": {"av": 107.81882382803592}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.1554436679038213e-31, "cur_lr": 1.9999999494757503e-05, "total_loss": 3836.5, "policy_loss": -47.296958923339844, "vf_loss": 3883.798583984375, "vf_explained_var": -8.857250213623047e-05, "kl": 0.0030541957821696997, "entropy": 2.14715838432312}, "num_steps_trained": 3760000, "num_steps_sampled": 3760000, "sample_time_ms": 79954.236, "grad_time_ms": 5520.381, "update_time_ms": 3.801, "opt_peak_throughput": 2898.351, "sample_peak_throughput": 200.114, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3760000, "episodes_total": 61487, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-00-03", "timestamp": 1569783603, "training_iteration": 235, "time_this_iter_s": 89.01603698730469, "time_total_s": 37006.70148015022, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6324a8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 13060.661214828491, "timesteps_since_restore": 1840000, "iterations_since_restore": 115}
{"episode_reward_max": 4225.356265066707, "episode_reward_min": 0.0, "episode_reward_mean": 937.957369696628, "episode_len_mean": 204.4, "episodes_this_iter": 78, "policy_reward_mean": {"av": 100.42370125231567}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.5777218339519106e-31, "cur_lr": 1.9999999494757503e-05, "total_loss": 3695.61083984375, "policy_loss": -45.80576705932617, "vf_loss": 3741.40869140625, "vf_explained_var": -8.594989776611328e-05, "kl": 0.0017258176812902093, "entropy": 2.1300301551818848}, "num_steps_trained": 3776000, "num_steps_sampled": 3776000, "sample_time_ms": 80543.267, "grad_time_ms": 5558.633, "update_time_ms": 4.009, "opt_peak_throughput": 2878.406, "sample_peak_throughput": 198.651, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3776000, "episodes_total": 61565, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-01-33", "timestamp": 1569783693, "training_iteration": 236, "time_this_iter_s": 89.95134663581848, "time_total_s": 37096.65282678604, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632390>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 13150.61256146431, "timesteps_since_restore": 1856000, "iterations_since_restore": 116}
{"episode_reward_max": 4904.420945208343, "episode_reward_min": 1.4774945351731097, "episode_reward_mean": 947.7800816563915, "episode_len_mean": 205.3, "episodes_this_iter": 75, "policy_reward_mean": {"av": 101.69314180862577}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 7.888609169759553e-32, "cur_lr": 1.9999999494757503e-05, "total_loss": 3677.6337890625, "policy_loss": -45.633480072021484, "vf_loss": 3723.275146484375, "vf_explained_var": 3.719329833984375e-05, "kl": 0.0017727676313370466, "entropy": 2.133730173110962}, "num_steps_trained": 3792000, "num_steps_sampled": 3792000, "sample_time_ms": 80645.391, "grad_time_ms": 5609.228, "update_time_ms": 3.986, "opt_peak_throughput": 2852.442, "sample_peak_throughput": 198.399, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3792000, "episodes_total": 61640, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-02-58", "timestamp": 1569783778, "training_iteration": 237, "time_this_iter_s": 85.15165185928345, "time_total_s": 37181.804478645325, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632d30>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 13235.764213323593, "timesteps_since_restore": 1872000, "iterations_since_restore": 117}
{"episode_reward_max": 4935.250650468181, "episode_reward_min": 0.0, "episode_reward_mean": 1228.7624326430819, "episode_len_mean": 250.57, "episodes_this_iter": 66, "policy_reward_mean": {"av": 114.19725210437562}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.9443045848797766e-32, "cur_lr": 1.9999999494757503e-05, "total_loss": 3870.626708984375, "policy_loss": -47.887115478515625, "vf_loss": 3918.516357421875, "vf_explained_var": 4.965066909790039e-05, "kl": 0.012660304084420204, "entropy": 2.1124067306518555}, "num_steps_trained": 3808000, "num_steps_sampled": 3808000, "sample_time_ms": 80092.14, "grad_time_ms": 5615.061, "update_time_ms": 3.985, "opt_peak_throughput": 2849.48, "sample_peak_throughput": 199.77, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3808000, "episodes_total": 61706, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-04-18", "timestamp": 1569783858, "training_iteration": 238, "time_this_iter_s": 79.91188311576843, "time_total_s": 37261.71636176109, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632f28>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 13315.676096439362, "timesteps_since_restore": 1888000, "iterations_since_restore": 118}
{"episode_reward_max": 4652.904773269648, "episode_reward_min": 0.0, "episode_reward_mean": 1183.8869403155786, "episode_len_mean": 245.89, "episodes_this_iter": 68, "policy_reward_mean": {"av": 111.26756957853179}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.9443045848797766e-32, "cur_lr": 1.9999999494757503e-05, "total_loss": 3892.309814453125, "policy_loss": -48.09627151489258, "vf_loss": 3940.388671875, "vf_explained_var": -0.00012576580047607422, "kl": 0.0010280051501467824, "entropy": 2.119328737258911}, "num_steps_trained": 3824000, "num_steps_sampled": 3824000, "sample_time_ms": 79835.585, "grad_time_ms": 5669.921, "update_time_ms": 3.889, "opt_peak_throughput": 2821.909, "sample_peak_throughput": 200.412, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3824000, "episodes_total": 61774, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-05-39", "timestamp": 1569783939, "training_iteration": 239, "time_this_iter_s": 81.73507118225098, "time_total_s": 37343.451432943344, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632470>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 13397.411167621613, "timesteps_since_restore": 1904000, "iterations_since_restore": 119}
{"episode_reward_max": 3896.4942246548308, "episode_reward_min": 0.0, "episode_reward_mean": 1110.9561907092661, "episode_len_mean": 237.62, "episodes_this_iter": 61, "policy_reward_mean": {"av": 106.61767665156103}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.9721522924398883e-32, "cur_lr": 1.9999999494757503e-05, "total_loss": 3794.72216796875, "policy_loss": -47.00870132446289, "vf_loss": 3841.734130859375, "vf_explained_var": 5.555152893066406e-05, "kl": 0.001644579111598432, "entropy": 2.124490261077881}, "num_steps_trained": 3840000, "num_steps_sampled": 3840000, "sample_time_ms": 79020.303, "grad_time_ms": 5669.399, "update_time_ms": 4.036, "opt_peak_throughput": 2822.168, "sample_peak_throughput": 202.48, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3840000, "episodes_total": 61835, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-06-57", "timestamp": 1569784017, "training_iteration": 240, "time_this_iter_s": 77.47051763534546, "time_total_s": 37420.92195057869, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632978>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 13474.881685256958, "timesteps_since_restore": 1920000, "iterations_since_restore": 120}
{"episode_reward_max": 4886.6986509849385, "episode_reward_min": 0.0, "episode_reward_mean": 1174.9252808827125, "episode_len_mean": 245.58, "episodes_this_iter": 62, "policy_reward_mean": {"av": 110.42530835363844}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 9.860761462199441e-33, "cur_lr": 1.9999999494757503e-05, "total_loss": 3809.2890625, "policy_loss": -47.355613708496094, "vf_loss": 3856.64697265625, "vf_explained_var": -4.470348358154297e-05, "kl": 0.0016272017965093255, "entropy": 2.1150882244110107}, "num_steps_trained": 3856000, "num_steps_sampled": 3856000, "sample_time_ms": 78567.449, "grad_time_ms": 5703.156, "update_time_ms": 4.087, "opt_peak_throughput": 2805.464, "sample_peak_throughput": 203.647, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3856000, "episodes_total": 61897, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-08-20", "timestamp": 1569784100, "training_iteration": 241, "time_this_iter_s": 82.57402896881104, "time_total_s": 37503.4959795475, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621ef0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 13557.455714225769, "timesteps_since_restore": 1936000, "iterations_since_restore": 121}
{"episode_reward_max": 5654.210698198141, "episode_reward_min": 1.5334556474058263, "episode_reward_mean": 1258.6230372358375, "episode_len_mean": 254.65, "episodes_this_iter": 64, "policy_reward_mean": {"av": 115.6822644518233}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 1.9999999494757503e-05, "total_loss": 3802.7333984375, "policy_loss": -46.856422424316406, "vf_loss": 3849.576904296875, "vf_explained_var": -6.532669067382812e-05, "kl": 0.008059767074882984, "entropy": 2.0859382152557373}, "num_steps_trained": 3872000, "num_steps_sampled": 3872000, "sample_time_ms": 76976.68, "grad_time_ms": 5788.738, "update_time_ms": 3.962, "opt_peak_throughput": 2763.987, "sample_peak_throughput": 207.855, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3872000, "episodes_total": 61961, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-09-41", "timestamp": 1569784181, "training_iteration": 242, "time_this_iter_s": 81.45453214645386, "time_total_s": 37584.950511693954, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632cc0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 13638.910246372223, "timesteps_since_restore": 1952000, "iterations_since_restore": 122}
{"episode_reward_max": 5654.210698198141, "episode_reward_min": 1.5334556474058263, "episode_reward_mean": 1397.9882462028504, "episode_len_mean": 278.03, "episodes_this_iter": 50, "policy_reward_mean": {"av": 120.10208300711776}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 1.9999999494757503e-05, "total_loss": 4094.73486328125, "policy_loss": -50.02638244628906, "vf_loss": 4144.7607421875, "vf_explained_var": 0.00021201372146606445, "kl": 0.006768686231225729, "entropy": 2.083528995513916}, "num_steps_trained": 3888000, "num_steps_sampled": 3888000, "sample_time_ms": 76820.709, "grad_time_ms": 5876.684, "update_time_ms": 3.838, "opt_peak_throughput": 2722.624, "sample_peak_throughput": 208.277, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3888000, "episodes_total": 62011, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-11-01", "timestamp": 1569784261, "training_iteration": 243, "time_this_iter_s": 79.56012082099915, "time_total_s": 37664.51063251495, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621080>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 13718.470367193222, "timesteps_since_restore": 1968000, "iterations_since_restore": 123}
{"episode_reward_max": 4876.533265768345, "episode_reward_min": 6.253530615991553, "episode_reward_mean": 1738.910539983193, "episode_len_mean": 335.12, "episodes_this_iter": 44, "policy_reward_mean": {"av": 128.90367234864289}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 1.9999999494757503e-05, "total_loss": 4222.8271484375, "policy_loss": -50.53445816040039, "vf_loss": 4273.35595703125, "vf_explained_var": 0.00024020671844482422, "kl": 0.012442694045603275, "entropy": 2.0638816356658936}, "num_steps_trained": 3904000, "num_steps_sampled": 3904000, "sample_time_ms": 76654.535, "grad_time_ms": 5918.416, "update_time_ms": 3.739, "opt_peak_throughput": 2703.426, "sample_peak_throughput": 208.729, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3904000, "episodes_total": 62055, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-12-20", "timestamp": 1569784340, "training_iteration": 244, "time_this_iter_s": 79.03991031646729, "time_total_s": 37743.55054283142, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632080>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 13797.51027750969, "timesteps_since_restore": 1984000, "iterations_since_restore": 124}
{"episode_reward_max": 5698.868351010684, "episode_reward_min": 1.4875190714163464, "episode_reward_mean": 1910.6480515754654, "episode_len_mean": 360.47, "episodes_this_iter": 46, "policy_reward_mean": {"av": 133.51838236027007}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 1.9999999494757503e-05, "total_loss": 3950.0712890625, "policy_loss": -48.89277648925781, "vf_loss": 3998.958740234375, "vf_explained_var": 1.7642974853515625e-05, "kl": 0.010620425455272198, "entropy": 2.0486183166503906}, "num_steps_trained": 3920000, "num_steps_sampled": 3920000, "sample_time_ms": 75759.313, "grad_time_ms": 5662.059, "update_time_ms": 3.711, "opt_peak_throughput": 2825.827, "sample_peak_throughput": 211.195, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3920000, "episodes_total": 62101, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-13-37", "timestamp": 1569784417, "training_iteration": 245, "time_this_iter_s": 77.5005235671997, "time_total_s": 37821.05106639862, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6321d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 13875.010801076889, "timesteps_since_restore": 2000000, "iterations_since_restore": 125}
{"episode_reward_max": 6904.203476779808, "episode_reward_min": 1.4875190714163464, "episode_reward_mean": 1896.899174076987, "episode_len_mean": 359.35, "episodes_this_iter": 43, "policy_reward_mean": {"av": 132.83607661603548}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.930380731099721e-33, "cur_lr": 1.9999999494757503e-05, "total_loss": 4182.59375, "policy_loss": -50.9127197265625, "vf_loss": 4233.4990234375, "vf_explained_var": 0.00019741058349609375, "kl": 0.0017653421964496374, "entropy": 2.0415964126586914}, "num_steps_trained": 3936000, "num_steps_sampled": 3936000, "sample_time_ms": 74518.294, "grad_time_ms": 5758.392, "update_time_ms": 3.427, "opt_peak_throughput": 2778.553, "sample_peak_throughput": 214.712, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3936000, "episodes_total": 62144, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-14-56", "timestamp": 1569784496, "training_iteration": 246, "time_this_iter_s": 78.50228953361511, "time_total_s": 37899.553355932236, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632128>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 13953.513090610504, "timesteps_since_restore": 2016000, "iterations_since_restore": 126}
{"episode_reward_max": 6904.203476779808, "episode_reward_min": 2.719359577578177, "episode_reward_mean": 2045.8549468432593, "episode_len_mean": 379.26, "episodes_this_iter": 38, "policy_reward_mean": {"av": 137.1216452307814}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.4651903655498604e-33, "cur_lr": 1.9999999494757503e-05, "total_loss": 4293.076171875, "policy_loss": -51.73140335083008, "vf_loss": 4344.81201171875, "vf_explained_var": 0.00015807151794433594, "kl": 0.00509747676551342, "entropy": 2.024491786956787}, "num_steps_trained": 3952000, "num_steps_sampled": 3952000, "sample_time_ms": 73783.296, "grad_time_ms": 5871.567, "update_time_ms": 3.456, "opt_peak_throughput": 2724.997, "sample_peak_throughput": 216.851, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3952000, "episodes_total": 62182, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-16-15", "timestamp": 1569784575, "training_iteration": 247, "time_this_iter_s": 78.93379545211792, "time_total_s": 37978.48715138435, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f320>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 14032.446886062622, "timesteps_since_restore": 2032000, "iterations_since_restore": 127}
{"episode_reward_max": 6373.786274302603, "episode_reward_min": 2.719359577578177, "episode_reward_mean": 2107.9167568661724, "episode_len_mean": 387.38, "episodes_this_iter": 47, "policy_reward_mean": {"av": 138.67873400435346}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.4651903655498604e-33, "cur_lr": 1.9999999494757503e-05, "total_loss": 4040.918701171875, "policy_loss": -49.79802703857422, "vf_loss": 4090.71630859375, "vf_explained_var": 0.00024276971817016602, "kl": 0.005417484324425459, "entropy": 2.0100107192993164}, "num_steps_trained": 3968000, "num_steps_sampled": 3968000, "sample_time_ms": 74087.221, "grad_time_ms": 6046.187, "update_time_ms": 3.401, "opt_peak_throughput": 2646.296, "sample_peak_throughput": 215.962, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3968000, "episodes_total": 62229, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-17-39", "timestamp": 1569784659, "training_iteration": 248, "time_this_iter_s": 84.69737696647644, "time_total_s": 38063.18452835083, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6321d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 14117.144263029099, "timesteps_since_restore": 2048000, "iterations_since_restore": 128}
{"episode_reward_max": 6373.786274302603, "episode_reward_min": 2.719359577578177, "episode_reward_mean": 2120.8634961877124, "episode_len_mean": 387.95, "episodes_this_iter": 33, "policy_reward_mean": {"av": 139.53049317024423}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.4651903655498604e-33, "cur_lr": 1.9999999494757503e-05, "total_loss": 4396.77783203125, "policy_loss": -52.89640808105469, "vf_loss": 4449.6748046875, "vf_explained_var": 0.00024086236953735352, "kl": 0.0018672709120437503, "entropy": 2.0056543350219727}, "num_steps_trained": 3984000, "num_steps_sampled": 3984000, "sample_time_ms": 73984.668, "grad_time_ms": 6103.728, "update_time_ms": 3.373, "opt_peak_throughput": 2621.349, "sample_peak_throughput": 216.261, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 3984000, "episodes_total": 62262, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-19-01", "timestamp": 1569784741, "training_iteration": 249, "time_this_iter_s": 81.28369760513306, "time_total_s": 38144.46822595596, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61fbe0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 14198.427960634232, "timesteps_since_restore": 2064000, "iterations_since_restore": 129}
{"episode_reward_max": 5526.223813660234, "episode_reward_min": 2.975712801248249, "episode_reward_mean": 2236.848822122934, "episode_len_mean": 410.61, "episodes_this_iter": 42, "policy_reward_mean": {"av": 140.50557927907872}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.2325951827749302e-33, "cur_lr": 1.9999999494757503e-05, "total_loss": 4000.779052734375, "policy_loss": -49.9102783203125, "vf_loss": 4050.673583984375, "vf_explained_var": 0.0001437664031982422, "kl": 0.00039381213719025254, "entropy": 1.9989936351776123}, "num_steps_trained": 4000000, "num_steps_sampled": 4000000, "sample_time_ms": 74162.492, "grad_time_ms": 6182.155, "update_time_ms": 3.266, "opt_peak_throughput": 2588.094, "sample_peak_throughput": 215.742, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4000000, "episodes_total": 62304, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-20-21", "timestamp": 1569784821, "training_iteration": 250, "time_this_iter_s": 80.03203701972961, "time_total_s": 38224.50026297569, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f0f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 14278.459997653961, "timesteps_since_restore": 2080000, "iterations_since_restore": 130}
{"episode_reward_max": 7173.033189148756, "episode_reward_min": 0.0, "episode_reward_mean": 2419.316350859878, "episode_len_mean": 437.06, "episodes_this_iter": 35, "policy_reward_mean": {"av": 144.35061759307135}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.162975913874651e-34, "cur_lr": 1.9999999494757503e-05, "total_loss": 4145.412109375, "policy_loss": -50.60544967651367, "vf_loss": 4196.001953125, "vf_explained_var": 0.00022721290588378906, "kl": 0.00032241613371297717, "entropy": 2.0041775703430176}, "num_steps_trained": 4016000, "num_steps_sampled": 4016000, "sample_time_ms": 74054.529, "grad_time_ms": 6545.482, "update_time_ms": 3.257, "opt_peak_throughput": 2444.434, "sample_peak_throughput": 216.057, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4016000, "episodes_total": 62339, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-21-46", "timestamp": 1569784906, "training_iteration": 251, "time_this_iter_s": 85.127614736557, "time_total_s": 38309.62787771225, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f320>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 14363.587612390518, "timesteps_since_restore": 2096000, "iterations_since_restore": 131}
{"episode_reward_max": 7173.033189148756, "episode_reward_min": 0.0, "episode_reward_mean": 2354.4366812707694, "episode_len_mean": 423.79, "episodes_this_iter": 36, "policy_reward_mean": {"av": 144.1786087734702}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.0814879569373254e-34, "cur_lr": 1.9999999494757503e-05, "total_loss": 4394.5380859375, "policy_loss": -52.76382064819336, "vf_loss": 4447.31689453125, "vf_explained_var": 0.00016289949417114258, "kl": 0.0018134640995413065, "entropy": 1.9850810766220093}, "num_steps_trained": 4032000, "num_steps_sampled": 4032000, "sample_time_ms": 73552.699, "grad_time_ms": 6634.997, "update_time_ms": 3.322, "opt_peak_throughput": 2411.455, "sample_peak_throughput": 217.531, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4032000, "episodes_total": 62375, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-23-03", "timestamp": 1569784983, "training_iteration": 252, "time_this_iter_s": 77.33155393600464, "time_total_s": 38386.959431648254, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6075f8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 14440.919166326523, "timesteps_since_restore": 2112000, "iterations_since_restore": 132}
{"episode_reward_max": 7173.033189148756, "episode_reward_min": 0.0, "episode_reward_mean": 2493.2557985055378, "episode_len_mean": 446.48, "episodes_this_iter": 34, "policy_reward_mean": {"av": 145.8044326611425}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.5407439784686627e-34, "cur_lr": 1.9999999494757503e-05, "total_loss": 4164.0537109375, "policy_loss": -50.761505126953125, "vf_loss": 4214.80859375, "vf_explained_var": 0.00015234947204589844, "kl": 0.004928277805447578, "entropy": 1.965221881866455}, "num_steps_trained": 4048000, "num_steps_sampled": 4048000, "sample_time_ms": 73575.448, "grad_time_ms": 6676.814, "update_time_ms": 3.389, "opt_peak_throughput": 2396.352, "sample_peak_throughput": 217.464, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4048000, "episodes_total": 62409, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-24-23", "timestamp": 1569785063, "training_iteration": 253, "time_this_iter_s": 80.20681071281433, "time_total_s": 38467.16624236107, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621080>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 14521.125977039337, "timesteps_since_restore": 2128000, "iterations_since_restore": 133}
{"episode_reward_max": 7026.131365902534, "episode_reward_min": 1.5069217277634623, "episode_reward_mean": 2623.7709045602296, "episode_len_mean": 471.35, "episodes_this_iter": 29, "policy_reward_mean": {"av": 146.82545632681754}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 7.703719892343314e-35, "cur_lr": 1.9999999494757503e-05, "total_loss": 4589.953125, "policy_loss": -54.36692810058594, "vf_loss": 4644.31005859375, "vf_explained_var": 0.0003013014793395996, "kl": 0.013314840383827686, "entropy": 1.946259617805481}, "num_steps_trained": 4064000, "num_steps_sampled": 4064000, "sample_time_ms": 73007.47, "grad_time_ms": 6744.394, "update_time_ms": 3.471, "opt_peak_throughput": 2372.341, "sample_peak_throughput": 219.156, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4064000, "episodes_total": 62438, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-25-37", "timestamp": 1569785137, "training_iteration": 254, "time_this_iter_s": 74.0365424156189, "time_total_s": 38541.20278477669, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26debf8d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 14595.162519454956, "timesteps_since_restore": 2144000, "iterations_since_restore": 134}
{"episode_reward_max": 7026.131365902534, "episode_reward_min": 3.0355321843882956, "episode_reward_mean": 2818.0714173794668, "episode_len_mean": 496.82, "episodes_this_iter": 34, "policy_reward_mean": {"av": 151.0220480910754}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 7.703719892343314e-35, "cur_lr": 1.9999999494757503e-05, "total_loss": 4263.14892578125, "policy_loss": -51.7842903137207, "vf_loss": 4314.9482421875, "vf_explained_var": 0.00022113323211669922, "kl": 0.0011161757865920663, "entropy": 1.9715886116027832}, "num_steps_trained": 4080000, "num_steps_sampled": 4080000, "sample_time_ms": 73387.478, "grad_time_ms": 6812.414, "update_time_ms": 3.477, "opt_peak_throughput": 2348.654, "sample_peak_throughput": 218.021, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4080000, "episodes_total": 62472, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-26-59", "timestamp": 1569785219, "training_iteration": 255, "time_this_iter_s": 81.9818480014801, "time_total_s": 38623.18463277817, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621470>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 14677.144367456436, "timesteps_since_restore": 2160000, "iterations_since_restore": 135}
{"episode_reward_max": 7026.131365902534, "episode_reward_min": 10.838593613111428, "episode_reward_mean": 3100.066821738757, "episode_len_mean": 537.12, "episodes_this_iter": 25, "policy_reward_mean": {"av": 155.54775824078067}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.851859946171657e-35, "cur_lr": 1.9999999494757503e-05, "total_loss": 4513.0205078125, "policy_loss": -53.740238189697266, "vf_loss": 4566.765625, "vf_explained_var": 0.0002550482749938965, "kl": 0.001731199212372303, "entropy": 1.9682767391204834}, "num_steps_trained": 4096000, "num_steps_sampled": 4096000, "sample_time_ms": 73263.057, "grad_time_ms": 6862.024, "update_time_ms": 3.442, "opt_peak_throughput": 2331.674, "sample_peak_throughput": 218.391, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4096000, "episodes_total": 62497, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-28-17", "timestamp": 1569785297, "training_iteration": 256, "time_this_iter_s": 77.75291967391968, "time_total_s": 38700.93755245209, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621240>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 14754.897287130356, "timesteps_since_restore": 2176000, "iterations_since_restore": 136}
{"episode_reward_max": 6667.1014053912895, "episode_reward_min": 3.1276221608736554, "episode_reward_mean": 3110.3914988136135, "episode_len_mean": 535.64, "episodes_this_iter": 31, "policy_reward_mean": {"av": 156.37966308766286}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.9259299730858284e-35, "cur_lr": 1.9999999494757503e-05, "total_loss": 4285.30224609375, "policy_loss": -52.12263107299805, "vf_loss": 4337.41064453125, "vf_explained_var": 0.00035947561264038086, "kl": 0.001984652131795883, "entropy": 1.9761931896209717}, "num_steps_trained": 4112000, "num_steps_sampled": 4112000, "sample_time_ms": 73274.749, "grad_time_ms": 6909.244, "update_time_ms": 3.385, "opt_peak_throughput": 2315.738, "sample_peak_throughput": 218.356, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4112000, "episodes_total": 62528, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-29-37", "timestamp": 1569785377, "training_iteration": 257, "time_this_iter_s": 79.52306318283081, "time_total_s": 38780.46061563492, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6217f0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 14834.420350313187, "timesteps_since_restore": 2192000, "iterations_since_restore": 137}
{"episode_reward_max": 6667.1014053912895, "episode_reward_min": 3.1276221608736554, "episode_reward_mean": 3301.6471422681116, "episode_len_mean": 565.88, "episodes_this_iter": 28, "policy_reward_mean": {"av": 158.12486313544602}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 9.629649865429142e-36, "cur_lr": 1.9999999494757503e-05, "total_loss": 4320.6953125, "policy_loss": -52.28780746459961, "vf_loss": 4372.966796875, "vf_explained_var": 8.320808410644531e-05, "kl": 0.0006675320328213274, "entropy": 1.954487919807434}, "num_steps_trained": 4128000, "num_steps_sampled": 4128000, "sample_time_ms": 72691.854, "grad_time_ms": 6834.769, "update_time_ms": 3.375, "opt_peak_throughput": 2340.972, "sample_peak_throughput": 220.107, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4128000, "episodes_total": 62556, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-30-55", "timestamp": 1569785455, "training_iteration": 258, "time_this_iter_s": 78.12185573577881, "time_total_s": 38858.5824713707, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621908>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 14912.542206048965, "timesteps_since_restore": 2208000, "iterations_since_restore": 138}
{"episode_reward_max": 6828.595864977776, "episode_reward_min": 3.1276221608736554, "episode_reward_mean": 3207.0054823646733, "episode_len_mean": 552.98, "episodes_this_iter": 32, "policy_reward_mean": {"av": 156.66856289031134}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.814824932714571e-36, "cur_lr": 1.9999999494757503e-05, "total_loss": 4454.10009765625, "policy_loss": -53.31658935546875, "vf_loss": 4507.427734375, "vf_explained_var": 0.0002516508102416992, "kl": 0.005102495662868023, "entropy": 1.940923810005188}, "num_steps_trained": 4144000, "num_steps_sampled": 4144000, "sample_time_ms": 72319.651, "grad_time_ms": 6858.881, "update_time_ms": 3.433, "opt_peak_throughput": 2332.742, "sample_peak_throughput": 221.24, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4144000, "episodes_total": 62588, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-32-13", "timestamp": 1569785533, "training_iteration": 259, "time_this_iter_s": 77.80433511734009, "time_total_s": 38936.38680648804, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621d30>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 14990.346541166306, "timesteps_since_restore": 2224000, "iterations_since_restore": 139}
{"episode_reward_max": 6828.595864977776, "episode_reward_min": 10.560281169396548, "episode_reward_mean": 3023.483051665987, "episode_len_mean": 526.24, "episodes_this_iter": 33, "policy_reward_mean": {"av": 154.02358897941863}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.814824932714571e-36, "cur_lr": 1.9999999494757503e-05, "total_loss": 4231.6484375, "policy_loss": -51.374107360839844, "vf_loss": 4283.00732421875, "vf_explained_var": 0.00015246868133544922, "kl": 0.0005364791722968221, "entropy": 1.9425960779190063}, "num_steps_trained": 4160000, "num_steps_sampled": 4160000, "sample_time_ms": 72024.992, "grad_time_ms": 6861.388, "update_time_ms": 3.594, "opt_peak_throughput": 2331.89, "sample_peak_throughput": 222.145, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4160000, "episodes_total": 62621, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-33-30", "timestamp": 1569785610, "training_iteration": 260, "time_this_iter_s": 77.1135036945343, "time_total_s": 39013.50031018257, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621e10>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 15067.46004486084, "timesteps_since_restore": 2240000, "iterations_since_restore": 140}
{"episode_reward_max": 6828.595864977776, "episode_reward_min": 10.560281169396548, "episode_reward_mean": 2908.360689471001, "episode_len_mean": 510.61, "episodes_this_iter": 31, "policy_reward_mean": {"av": 152.03140039053855}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.4074124663572855e-36, "cur_lr": 1.9999999494757503e-05, "total_loss": 4296.08203125, "policy_loss": -52.24142074584961, "vf_loss": 4348.33154296875, "vf_explained_var": 0.00020629167556762695, "kl": 0.0012936788843944669, "entropy": 1.9696030616760254}, "num_steps_trained": 4176000, "num_steps_sampled": 4176000, "sample_time_ms": 71545.381, "grad_time_ms": 6595.333, "update_time_ms": 3.518, "opt_peak_throughput": 2425.958, "sample_peak_throughput": 223.634, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4176000, "episodes_total": 62652, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-34-47", "timestamp": 1569785687, "training_iteration": 261, "time_this_iter_s": 77.67095232009888, "time_total_s": 39091.17126250267, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61fdd8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 15145.130997180939, "timesteps_since_restore": 2256000, "iterations_since_restore": 141}
{"episode_reward_max": 6888.8571614499215, "episode_reward_min": 10.560281169396548, "episode_reward_mean": 2923.2153635899526, "episode_len_mean": 511.93, "episodes_this_iter": 27, "policy_reward_mean": {"av": 152.5686515443609}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.2037062331786428e-36, "cur_lr": 1.9999999494757503e-05, "total_loss": 4336.91943359375, "policy_loss": -52.79855728149414, "vf_loss": 4389.7080078125, "vf_explained_var": 0.00022715330123901367, "kl": 0.0022584320977330208, "entropy": 1.9611756801605225}, "num_steps_trained": 4192000, "num_steps_sampled": 4192000, "sample_time_ms": 71693.984, "grad_time_ms": 6646.905, "update_time_ms": 3.568, "opt_peak_throughput": 2407.135, "sample_peak_throughput": 223.171, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4192000, "episodes_total": 62679, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-36-07", "timestamp": 1569785767, "training_iteration": 262, "time_this_iter_s": 79.33476185798645, "time_total_s": 39170.50602436066, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61fc50>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 15224.465759038925, "timesteps_since_restore": 2272000, "iterations_since_restore": 142}
{"episode_reward_max": 6888.8571614499215, "episode_reward_min": 18.905958535527603, "episode_reward_mean": 2983.901873957066, "episode_len_mean": 517.48, "episodes_this_iter": 34, "policy_reward_mean": {"av": 154.92740778593287}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 1.9999999494757503e-05, "total_loss": 4233.0859375, "policy_loss": -51.36434555053711, "vf_loss": 4284.45263671875, "vf_explained_var": 0.00023066997528076172, "kl": 0.0057464661076664925, "entropy": 1.951029896736145}, "num_steps_trained": 4208000, "num_steps_sampled": 4208000, "sample_time_ms": 72074.228, "grad_time_ms": 6697.528, "update_time_ms": 3.509, "opt_peak_throughput": 2388.941, "sample_peak_throughput": 221.993, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4208000, "episodes_total": 62713, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-37-31", "timestamp": 1569785851, "training_iteration": 263, "time_this_iter_s": 84.52987384796143, "time_total_s": 39255.03589820862, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f4e0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 15308.995632886887, "timesteps_since_restore": 2288000, "iterations_since_restore": 143}
{"episode_reward_max": 7431.128090123632, "episode_reward_min": 6.238529473739216, "episode_reward_mean": 3110.938418184132, "episode_len_mean": 531.34, "episodes_this_iter": 29, "policy_reward_mean": {"av": 157.99585668786858}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 1.9999999494757503e-05, "total_loss": 4350.74755859375, "policy_loss": -52.52339172363281, "vf_loss": 4403.25927734375, "vf_explained_var": 0.0003070235252380371, "kl": 0.00828707218170166, "entropy": 1.9499292373657227}, "num_steps_trained": 4224000, "num_steps_sampled": 4224000, "sample_time_ms": 73198.657, "grad_time_ms": 6733.049, "update_time_ms": 3.477, "opt_peak_throughput": 2376.338, "sample_peak_throughput": 218.583, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4224000, "episodes_total": 62742, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-38-57", "timestamp": 1569785937, "training_iteration": 264, "time_this_iter_s": 85.63517141342163, "time_total_s": 39340.67106962204, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c61f390>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 15394.630804300308, "timesteps_since_restore": 2304000, "iterations_since_restore": 144}
{"episode_reward_max": 7431.128090123632, "episode_reward_min": 6.238529473739216, "episode_reward_mean": 3163.501272578374, "episode_len_mean": 538.99, "episodes_this_iter": 26, "policy_reward_mean": {"av": 158.65101667895556}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 1.9999999494757503e-05, "total_loss": 4292.8408203125, "policy_loss": -52.31840515136719, "vf_loss": 4345.166015625, "vf_explained_var": 0.00027567148208618164, "kl": 0.010694212280213833, "entropy": 1.9255338907241821}, "num_steps_trained": 4240000, "num_steps_sampled": 4240000, "sample_time_ms": 73131.643, "grad_time_ms": 6765.461, "update_time_ms": 3.431, "opt_peak_throughput": 2364.953, "sample_peak_throughput": 218.784, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4240000, "episodes_total": 62768, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-40-19", "timestamp": 1569786019, "training_iteration": 265, "time_this_iter_s": 81.63527822494507, "time_total_s": 39422.306347846985, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63bf60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 15476.266082525253, "timesteps_since_restore": 2320000, "iterations_since_restore": 145}
{"episode_reward_max": 7431.128090123632, "episode_reward_min": 6.238529473739216, "episode_reward_mean": 3307.6299495746566, "episode_len_mean": 562.04, "episodes_this_iter": 29, "policy_reward_mean": {"av": 159.63465007599683}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 1.9999999494757503e-05, "total_loss": 4232.10498046875, "policy_loss": -51.45829391479492, "vf_loss": 4283.54638671875, "vf_explained_var": 0.00023812055587768555, "kl": 0.005148374941200018, "entropy": 1.912165880203247}, "num_steps_trained": 4256000, "num_steps_sampled": 4256000, "sample_time_ms": 73268.302, "grad_time_ms": 6772.787, "update_time_ms": 3.377, "opt_peak_throughput": 2362.395, "sample_peak_throughput": 218.375, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4256000, "episodes_total": 62797, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-41-38", "timestamp": 1569786098, "training_iteration": 266, "time_this_iter_s": 79.19249057769775, "time_total_s": 39501.49883842468, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b390>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 15555.458573102951, "timesteps_since_restore": 2336000, "iterations_since_restore": 146}
{"episode_reward_max": 7431.128090123632, "episode_reward_min": 14.649407170891365, "episode_reward_mean": 3485.3236430224833, "episode_len_mean": 586.82, "episodes_this_iter": 24, "policy_reward_mean": {"av": 161.7319555926906}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 1.9999999494757503e-05, "total_loss": 4336.39013671875, "policy_loss": -52.59107971191406, "vf_loss": 4388.9609375, "vf_explained_var": 0.00033271312713623047, "kl": 0.012291066348552704, "entropy": 1.8992055654525757}, "num_steps_trained": 4272000, "num_steps_sampled": 4272000, "sample_time_ms": 73868.766, "grad_time_ms": 6839.459, "update_time_ms": 3.319, "opt_peak_throughput": 2339.366, "sample_peak_throughput": 216.6, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4272000, "episodes_total": 62821, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-43-04", "timestamp": 1569786184, "training_iteration": 267, "time_this_iter_s": 86.19398355484009, "time_total_s": 39587.69282197952, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b320>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 15641.652556657791, "timesteps_since_restore": 2352000, "iterations_since_restore": 147}
{"episode_reward_max": 7137.577120692877, "episode_reward_min": 14.649407170891365, "episode_reward_mean": 3588.01088158756, "episode_len_mean": 603.42, "episodes_this_iter": 27, "policy_reward_mean": {"av": 162.50049282552354}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 1.9999999494757503e-05, "total_loss": 4340.912109375, "policy_loss": -52.529842376708984, "vf_loss": 4393.4306640625, "vf_explained_var": 0.00030165910720825195, "kl": 0.0065767536871135235, "entropy": 1.88546621799469}, "num_steps_trained": 4288000, "num_steps_sampled": 4288000, "sample_time_ms": 73930.943, "grad_time_ms": 6878.587, "update_time_ms": 3.309, "opt_peak_throughput": 2326.059, "sample_peak_throughput": 216.418, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4288000, "episodes_total": 62848, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-44-23", "timestamp": 1569786263, "training_iteration": 268, "time_this_iter_s": 79.1350326538086, "time_total_s": 39666.82785463333, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b2b0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 15720.7875893116, "timesteps_since_restore": 2368000, "iterations_since_restore": 148}
{"episode_reward_max": 7082.1466479331175, "episode_reward_min": 13.618214610834936, "episode_reward_mean": 3666.8112647946386, "episode_len_mean": 610.71, "episodes_this_iter": 26, "policy_reward_mean": {"av": 164.13658302572242}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 1.9999999494757503e-05, "total_loss": 4452.75927734375, "policy_loss": -53.42508316040039, "vf_loss": 4506.173828125, "vf_explained_var": 0.00023818016052246094, "kl": 0.011237101629376411, "entropy": 1.8678076267242432}, "num_steps_trained": 4304000, "num_steps_sampled": 4304000, "sample_time_ms": 74480.26, "grad_time_ms": 6937.391, "update_time_ms": 3.371, "opt_peak_throughput": 2306.342, "sample_peak_throughput": 214.822, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4304000, "episodes_total": 62874, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-45-47", "timestamp": 1569786347, "training_iteration": 269, "time_this_iter_s": 83.88559484481812, "time_total_s": 39750.71344947815, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b9b0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 15804.673184156418, "timesteps_since_restore": 2384000, "iterations_since_restore": 149}
{"episode_reward_max": 7082.1466479331175, "episode_reward_min": 0.0, "episode_reward_mean": 3799.0737168098653, "episode_len_mean": 625.07, "episodes_this_iter": 25, "policy_reward_mean": {"av": 166.69915387493927}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 6.018531165893214e-37, "cur_lr": 1.9999999494757503e-05, "total_loss": 4401.16845703125, "policy_loss": -53.227378845214844, "vf_loss": 4454.40869140625, "vf_explained_var": 0.0003552436828613281, "kl": 0.0037295955698937178, "entropy": 1.8514983654022217}, "num_steps_trained": 4320000, "num_steps_sampled": 4320000, "sample_time_ms": 74986.944, "grad_time_ms": 7045.532, "update_time_ms": 3.219, "opt_peak_throughput": 2270.943, "sample_peak_throughput": 213.37, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4320000, "episodes_total": 62899, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-47-10", "timestamp": 1569786430, "training_iteration": 270, "time_this_iter_s": 83.25961399078369, "time_total_s": 39833.97306346893, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632b70>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 15887.932798147202, "timesteps_since_restore": 2400000, "iterations_since_restore": 150}
{"episode_reward_max": 7302.5351505792, "episode_reward_min": 0.0, "episode_reward_mean": 3863.1377131318127, "episode_len_mean": 634.58, "episodes_this_iter": 24, "policy_reward_mean": {"av": 167.235398836875}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.009265582946607e-37, "cur_lr": 1.9999999494757503e-05, "total_loss": 4538.81005859375, "policy_loss": -54.05043029785156, "vf_loss": 4592.8642578125, "vf_explained_var": 0.00020998716354370117, "kl": 0.00183080171700567, "entropy": 1.8288754224777222}, "num_steps_trained": 4336000, "num_steps_sampled": 4336000, "sample_time_ms": 75339.554, "grad_time_ms": 7135.714, "update_time_ms": 3.208, "opt_peak_throughput": 2242.242, "sample_peak_throughput": 212.372, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4336000, "episodes_total": 62923, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-48-32", "timestamp": 1569786512, "training_iteration": 271, "time_this_iter_s": 82.09821629524231, "time_total_s": 39916.071279764175, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632f60>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 15970.031014442444, "timesteps_since_restore": 2416000, "iterations_since_restore": 151}
{"episode_reward_max": 7302.5351505792, "episode_reward_min": 0.0, "episode_reward_mean": 3980.856279898493, "episode_len_mean": 645.09, "episodes_this_iter": 23, "policy_reward_mean": {"av": 169.97678394101166}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.5046327914733034e-37, "cur_lr": 1.9999999494757503e-05, "total_loss": 4748.00341796875, "policy_loss": -55.79683303833008, "vf_loss": 4803.79345703125, "vf_explained_var": 0.00017368793487548828, "kl": 0.001853685243986547, "entropy": 1.81251859664917}, "num_steps_trained": 4352000, "num_steps_sampled": 4352000, "sample_time_ms": 75630.482, "grad_time_ms": 7171.039, "update_time_ms": 3.094, "opt_peak_throughput": 2231.197, "sample_peak_throughput": 211.555, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4352000, "episodes_total": 62946, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-49-55", "timestamp": 1569786595, "training_iteration": 272, "time_this_iter_s": 82.59580826759338, "time_total_s": 39998.66708803177, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632630>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 16052.626822710037, "timesteps_since_restore": 2432000, "iterations_since_restore": 152}
{"episode_reward_max": 7392.4376389889785, "episode_reward_min": 0.0, "episode_reward_mean": 3995.7689375365985, "episode_len_mean": 641.56, "episodes_this_iter": 26, "policy_reward_mean": {"av": 171.5658624962042}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 7.523163957366517e-38, "cur_lr": 1.9999999494757503e-05, "total_loss": 4629.63525390625, "policy_loss": -54.75807189941406, "vf_loss": 4684.37646484375, "vf_explained_var": 0.0003196597099304199, "kl": 0.0015600200276821852, "entropy": 1.806829571723938}, "num_steps_trained": 4368000, "num_steps_sampled": 4368000, "sample_time_ms": 75583.818, "grad_time_ms": 7234.717, "update_time_ms": 3.142, "opt_peak_throughput": 2211.558, "sample_peak_throughput": 211.686, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4368000, "episodes_total": 62972, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-51-20", "timestamp": 1569786680, "training_iteration": 273, "time_this_iter_s": 84.68510341644287, "time_total_s": 40083.35219144821, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6325f8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 16137.31192612648, "timesteps_since_restore": 2448000, "iterations_since_restore": 153}
{"episode_reward_max": 7392.4376389889785, "episode_reward_min": 9.116748968832745, "episode_reward_mean": 4137.110989208798, "episode_len_mean": 661.03, "episodes_this_iter": 23, "policy_reward_mean": {"av": 173.02848135544951}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.7615819786832586e-38, "cur_lr": 1.9999999494757503e-05, "total_loss": 4436.84765625, "policy_loss": -53.35515213012695, "vf_loss": 4490.2060546875, "vf_explained_var": 0.0003349781036376953, "kl": 0.00495216716080904, "entropy": 1.7767984867095947}, "num_steps_trained": 4384000, "num_steps_sampled": 4384000, "sample_time_ms": 75532.129, "grad_time_ms": 7268.181, "update_time_ms": 3.087, "opt_peak_throughput": 2201.376, "sample_peak_throughput": 211.83, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4384000, "episodes_total": 62995, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-52-45", "timestamp": 1569786765, "training_iteration": 274, "time_this_iter_s": 85.45384621620178, "time_total_s": 40168.80603766441, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63ba20>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 16222.765772342682, "timesteps_since_restore": 2464000, "iterations_since_restore": 154}
{"episode_reward_max": 7392.4376389889785, "episode_reward_min": 9.116748968832745, "episode_reward_mean": 3991.31472013356, "episode_len_mean": 643.74, "episodes_this_iter": 27, "policy_reward_mean": {"av": 170.71491531794524}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.8807909893416293e-38, "cur_lr": 1.9999999494757503e-05, "total_loss": 4351.59375, "policy_loss": -52.296993255615234, "vf_loss": 4403.8857421875, "vf_explained_var": 0.00019365549087524414, "kl": 0.008115110918879509, "entropy": 1.7300502061843872}, "num_steps_trained": 4400000, "num_steps_sampled": 4400000, "sample_time_ms": 75809.944, "grad_time_ms": 7254.987, "update_time_ms": 3.027, "opt_peak_throughput": 2205.38, "sample_peak_throughput": 211.054, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4400000, "episodes_total": 63022, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-54-10", "timestamp": 1569786850, "training_iteration": 275, "time_this_iter_s": 84.280202627182, "time_total_s": 40253.086240291595, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b8d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 16307.045974969864, "timesteps_since_restore": 2480000, "iterations_since_restore": 155}
{"episode_reward_max": 7392.4376389889785, "episode_reward_min": 9.92612567692755, "episode_reward_mean": 4025.0517082586052, "episode_len_mean": 649.25, "episodes_this_iter": 24, "policy_reward_mean": {"av": 170.77011914546478}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.8807909893416293e-38, "cur_lr": 1.9999999494757503e-05, "total_loss": 4513.86669921875, "policy_loss": -53.871036529541016, "vf_loss": 4567.7314453125, "vf_explained_var": 0.0002471804618835449, "kl": 0.00625139893963933, "entropy": 1.731284499168396}, "num_steps_trained": 4416000, "num_steps_sampled": 4416000, "sample_time_ms": 76641.453, "grad_time_ms": 7318.486, "update_time_ms": 3.095, "opt_peak_throughput": 2186.245, "sample_peak_throughput": 208.764, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4416000, "episodes_total": 63046, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-55-38", "timestamp": 1569786938, "training_iteration": 276, "time_this_iter_s": 88.14386892318726, "time_total_s": 40341.23010921478, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b278>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 16395.18984389305, "timesteps_since_restore": 2496000, "iterations_since_restore": 156}
{"episode_reward_max": 7275.418989443076, "episode_reward_min": 9.92612567692755, "episode_reward_mean": 4218.704763912621, "episode_len_mean": 679.68, "episodes_this_iter": 21, "policy_reward_mean": {"av": 171.84133457892548}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.8807909893416293e-38, "cur_lr": 1.9999999494757503e-05, "total_loss": 4636.859375, "policy_loss": -54.9960823059082, "vf_loss": 4691.8544921875, "vf_explained_var": 0.00036460161209106445, "kl": 0.0036263172514736652, "entropy": 1.7262276411056519}, "num_steps_trained": 4432000, "num_steps_sampled": 4432000, "sample_time_ms": 76418.736, "grad_time_ms": 7341.288, "update_time_ms": 3.089, "opt_peak_throughput": 2179.454, "sample_peak_throughput": 209.373, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4432000, "episodes_total": 63067, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-57-02", "timestamp": 1569787022, "training_iteration": 277, "time_this_iter_s": 84.19545149803162, "time_total_s": 40425.425560712814, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b0b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 16479.385295391083, "timesteps_since_restore": 2512000, "iterations_since_restore": 157}
{"episode_reward_max": 7275.418989443076, "episode_reward_min": 5.961949066296872, "episode_reward_mean": 4211.214450842959, "episode_len_mean": 679.18, "episodes_this_iter": 23, "policy_reward_mean": {"av": 171.6760884974707}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 9.403954246058914e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4508.1640625, "policy_loss": -54.09919357299805, "vf_loss": 4562.27587890625, "vf_explained_var": 0.00029021501541137695, "kl": 0.004691221751272678, "entropy": 1.721943736076355}, "num_steps_trained": 4448000, "num_steps_sampled": 4448000, "sample_time_ms": 76915.258, "grad_time_ms": 7378.165, "update_time_ms": 3.199, "opt_peak_throughput": 2168.561, "sample_peak_throughput": 208.021, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4448000, "episodes_total": 63090, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-58-26", "timestamp": 1569787106, "training_iteration": 278, "time_this_iter_s": 84.47071480751038, "time_total_s": 40509.896275520325, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63ba20>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 16563.856010198593, "timesteps_since_restore": 2528000, "iterations_since_restore": 158}
{"episode_reward_max": 7251.351893302982, "episode_reward_min": 3.145615708818861, "episode_reward_mean": 4284.254854594997, "episode_len_mean": 685.96, "episodes_this_iter": 22, "policy_reward_mean": {"av": 173.2411991344519}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 4.701977123029457e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4614.669921875, "policy_loss": -54.943450927734375, "vf_loss": 4669.59912109375, "vf_explained_var": 0.00025898218154907227, "kl": 0.000745729950722307, "entropy": 1.732133150100708}, "num_steps_trained": 4464000, "num_steps_sampled": 4464000, "sample_time_ms": 76986.844, "grad_time_ms": 7394.407, "update_time_ms": 3.167, "opt_peak_throughput": 2163.798, "sample_peak_throughput": 207.828, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4464000, "episodes_total": 63112, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_21-59-51", "timestamp": 1569787191, "training_iteration": 279, "time_this_iter_s": 84.76393747329712, "time_total_s": 40594.66021299362, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b2e8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 16648.61994767189, "timesteps_since_restore": 2544000, "iterations_since_restore": 159}
{"episode_reward_max": 7349.745469739286, "episode_reward_min": 3.145615708818861, "episode_reward_mean": 4337.530483450945, "episode_len_mean": 687.98, "episodes_this_iter": 27, "policy_reward_mean": {"av": 175.04158528857724}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.3509892621639607e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4476.0263671875, "policy_loss": -53.6081428527832, "vf_loss": 4529.642578125, "vf_explained_var": 0.00033968687057495117, "kl": 0.007141653448343277, "entropy": 1.7347853183746338}, "num_steps_trained": 4480000, "num_steps_sampled": 4480000, "sample_time_ms": 77694.573, "grad_time_ms": 7396.663, "update_time_ms": 3.228, "opt_peak_throughput": 2163.137, "sample_peak_throughput": 205.935, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4480000, "episodes_total": 63139, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-01-22", "timestamp": 1569787282, "training_iteration": 280, "time_this_iter_s": 90.36028170585632, "time_total_s": 40685.02049469948, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b278>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 16738.980229377747, "timesteps_since_restore": 2560000, "iterations_since_restore": 160}
{"episode_reward_max": 7349.745469739286, "episode_reward_min": 3.145615708818861, "episode_reward_mean": 4397.468340972474, "episode_len_mean": 698.01, "episodes_this_iter": 22, "policy_reward_mean": {"av": 175.1281696922531}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.3509892621639607e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4590.49169921875, "policy_loss": -54.542884826660156, "vf_loss": 4645.03466796875, "vf_explained_var": 0.0001875758171081543, "kl": 0.008348696865141392, "entropy": 1.7010127305984497}, "num_steps_trained": 4496000, "num_steps_sampled": 4496000, "sample_time_ms": 77755.11, "grad_time_ms": 7401.742, "update_time_ms": 3.275, "opt_peak_throughput": 2161.653, "sample_peak_throughput": 205.774, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4496000, "episodes_total": 63161, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-02-44", "timestamp": 1569787364, "training_iteration": 281, "time_this_iter_s": 82.75548672676086, "time_total_s": 40767.77598142624, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c6327b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 16821.735716104507, "timesteps_since_restore": 2576000, "iterations_since_restore": 161}
{"episode_reward_max": 7653.35348435244, "episode_reward_min": 3.145615708818861, "episode_reward_mean": 4496.868229817152, "episode_len_mean": 711.16, "episodes_this_iter": 19, "policy_reward_mean": {"av": 176.3477737183198}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.3509892621639607e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4747.24169921875, "policy_loss": -56.08682632446289, "vf_loss": 4803.3310546875, "vf_explained_var": 0.00027108192443847656, "kl": 0.009999105706810951, "entropy": 1.6912208795547485}, "num_steps_trained": 4512000, "num_steps_sampled": 4512000, "sample_time_ms": 78471.652, "grad_time_ms": 7459.213, "update_time_ms": 3.285, "opt_peak_throughput": 2144.998, "sample_peak_throughput": 203.895, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4512000, "episodes_total": 63180, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-04-15", "timestamp": 1569787455, "training_iteration": 282, "time_this_iter_s": 90.3364646434784, "time_total_s": 40858.11244606972, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b668>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 16912.072180747986, "timesteps_since_restore": 2592000, "iterations_since_restore": 162}
{"episode_reward_max": 7664.414122586946, "episode_reward_min": 3.145615708818861, "episode_reward_mean": 4702.6108555138935, "episode_len_mean": 730.08, "episodes_this_iter": 19, "policy_reward_mean": {"av": 180.03870044080767}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.3509892621639607e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4764.15771484375, "policy_loss": -56.10650634765625, "vf_loss": 4820.26513671875, "vf_explained_var": 0.0003063082695007324, "kl": 0.00649707717821002, "entropy": 1.6774024963378906}, "num_steps_trained": 4528000, "num_steps_sampled": 4528000, "sample_time_ms": 79312.857, "grad_time_ms": 7509.663, "update_time_ms": 3.462, "opt_peak_throughput": 2130.588, "sample_peak_throughput": 201.733, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4528000, "episodes_total": 63199, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-05-48", "timestamp": 1569787548, "training_iteration": 283, "time_this_iter_s": 93.60430026054382, "time_total_s": 40951.71674633026, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621ac8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 17005.67648100853, "timesteps_since_restore": 2608000, "iterations_since_restore": 163}
{"episode_reward_max": 7664.414122586946, "episode_reward_min": 17.472653946021566, "episode_reward_mean": 4879.952916351516, "episode_len_mean": 754.9, "episodes_this_iter": 21, "policy_reward_mean": {"av": 181.14153364333774}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.3509892621639607e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4580.25537109375, "policy_loss": -54.43027114868164, "vf_loss": 4634.69091796875, "vf_explained_var": 0.0002962946891784668, "kl": 0.00670328363776207, "entropy": 1.6465468406677246}, "num_steps_trained": 4544000, "num_steps_sampled": 4544000, "sample_time_ms": 79365.218, "grad_time_ms": 7537.928, "update_time_ms": 3.512, "opt_peak_throughput": 2122.599, "sample_peak_throughput": 201.6, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4544000, "episodes_total": 63220, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-07-15", "timestamp": 1569787635, "training_iteration": 284, "time_this_iter_s": 86.25941252708435, "time_total_s": 41037.976158857346, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63bc50>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 17091.935893535614, "timesteps_since_restore": 2624000, "iterations_since_restore": 164}
{"episode_reward_max": 7664.414122586946, "episode_reward_min": 17.472653946021566, "episode_reward_mean": 5000.412620202172, "episode_len_mean": 771.23, "episodes_this_iter": 22, "policy_reward_mean": {"av": 182.23078061961277}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.3509892621639607e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4545.0009765625, "policy_loss": -54.4150505065918, "vf_loss": 4599.416015625, "vf_explained_var": 0.00023919343948364258, "kl": 0.010444987565279007, "entropy": 1.6216951608657837}, "num_steps_trained": 4560000, "num_steps_sampled": 4560000, "sample_time_ms": 79699.709, "grad_time_ms": 7599.585, "update_time_ms": 3.498, "opt_peak_throughput": 2105.378, "sample_peak_throughput": 200.754, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4560000, "episodes_total": 63242, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-08-43", "timestamp": 1569787723, "training_iteration": 285, "time_this_iter_s": 88.24166584014893, "time_total_s": 41126.217824697495, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c632390>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 17180.177559375763, "timesteps_since_restore": 2640000, "iterations_since_restore": 165}
{"episode_reward_max": 7930.8695646522165, "episode_reward_min": 17.472653946021566, "episode_reward_mean": 5019.82785337654, "episode_len_mean": 766.61, "episodes_this_iter": 21, "policy_reward_mean": {"av": 183.8764781456609}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.3509892621639607e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4689.2431640625, "policy_loss": -55.606292724609375, "vf_loss": 4744.85400390625, "vf_explained_var": 0.00024396181106567383, "kl": 0.0051369317807257175, "entropy": 1.6378179788589478}, "num_steps_trained": 4576000, "num_steps_sampled": 4576000, "sample_time_ms": 80113.239, "grad_time_ms": 7646.137, "update_time_ms": 3.586, "opt_peak_throughput": 2092.56, "sample_peak_throughput": 199.717, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4576000, "episodes_total": 63263, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-10-16", "timestamp": 1569787816, "training_iteration": 286, "time_this_iter_s": 92.74658513069153, "time_total_s": 41218.964409828186, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c607780>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 17272.924144506454, "timesteps_since_restore": 2656000, "iterations_since_restore": 166}
{"episode_reward_max": 7930.8695646522165, "episode_reward_min": 17.472653946021566, "episode_reward_mean": 5094.726768791508, "episode_len_mean": 772.15, "episodes_this_iter": 20, "policy_reward_mean": {"av": 185.1954477932211}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.3509892621639607e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4573.63037109375, "policy_loss": -54.69403839111328, "vf_loss": 4628.31787109375, "vf_explained_var": 0.00024950504302978516, "kl": 0.0026073604822158813, "entropy": 1.6329700946807861}, "num_steps_trained": 4592000, "num_steps_sampled": 4592000, "sample_time_ms": 80836.981, "grad_time_ms": 7693.349, "update_time_ms": 3.62, "opt_peak_throughput": 2079.718, "sample_peak_throughput": 197.929, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4592000, "episodes_total": 63283, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-11-47", "timestamp": 1569787907, "training_iteration": 287, "time_this_iter_s": 91.90532898902893, "time_total_s": 41310.869738817215, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63bd68>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 17364.829473495483, "timesteps_since_restore": 2672000, "iterations_since_restore": 167}
{"episode_reward_max": 7930.8695646522165, "episode_reward_min": 53.81829818589175, "episode_reward_mean": 5141.328032758891, "episode_len_mean": 777.73, "episodes_this_iter": 20, "policy_reward_mean": {"av": 185.54052806780564}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.1754946310819804e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4741.88916015625, "policy_loss": -55.93538284301758, "vf_loss": 4797.8076171875, "vf_explained_var": 0.0001659393310546875, "kl": 0.005363986361771822, "entropy": 1.6384824514389038}, "num_steps_trained": 4608000, "num_steps_sampled": 4608000, "sample_time_ms": 81777.249, "grad_time_ms": 7796.674, "update_time_ms": 3.509, "opt_peak_throughput": 2052.157, "sample_peak_throughput": 195.653, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4608000, "episodes_total": 63303, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-13-22", "timestamp": 1569788002, "training_iteration": 288, "time_this_iter_s": 94.90608263015747, "time_total_s": 41405.77582144737, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b0b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 17459.73555612564, "timesteps_since_restore": 2688000, "iterations_since_restore": 168}
{"episode_reward_max": 7930.8695646522165, "episode_reward_min": 53.81829818589175, "episode_reward_mean": 5212.671467900086, "episode_len_mean": 784.04, "episodes_this_iter": 21, "policy_reward_mean": {"av": 186.63342169352262}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.1754946310819804e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4579.16162109375, "policy_loss": -54.27802276611328, "vf_loss": 4633.42822265625, "vf_explained_var": 0.0001773238182067871, "kl": 0.0145574901252985, "entropy": 1.5882337093353271}, "num_steps_trained": 4624000, "num_steps_sampled": 4624000, "sample_time_ms": 82286.777, "grad_time_ms": 7851.122, "update_time_ms": 3.494, "opt_peak_throughput": 2037.925, "sample_peak_throughput": 194.442, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4624000, "episodes_total": 63324, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-14-53", "timestamp": 1569788093, "training_iteration": 289, "time_this_iter_s": 90.40518617630005, "time_total_s": 41496.18100762367, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b8d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 17550.14074230194, "timesteps_since_restore": 2704000, "iterations_since_restore": 169}
{"episode_reward_max": 7930.8695646522165, "episode_reward_min": 1.551335625246619, "episode_reward_mean": 5183.3785579015, "episode_len_mean": 777.79, "episodes_this_iter": 21, "policy_reward_mean": {"av": 186.92313587816437}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.1754946310819804e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4743.6484375, "policy_loss": -56.08346939086914, "vf_loss": 4799.72998046875, "vf_explained_var": 9.816884994506836e-05, "kl": 0.018325548619031906, "entropy": 1.5526491403579712}, "num_steps_trained": 4640000, "num_steps_sampled": 4640000, "sample_time_ms": 81912.917, "grad_time_ms": 7887.234, "update_time_ms": 3.406, "opt_peak_throughput": 2028.595, "sample_peak_throughput": 195.329, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4640000, "episodes_total": 63345, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-16-20", "timestamp": 1569788180, "training_iteration": 290, "time_this_iter_s": 86.98198819160461, "time_total_s": 41583.16299581528, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63bbe0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 17637.122730493546, "timesteps_since_restore": 2720000, "iterations_since_restore": 170}
{"episode_reward_max": 7839.641324568461, "episode_reward_min": 1.551335625246619, "episode_reward_mean": 5295.78915171869, "episode_len_mean": 788.51, "episodes_this_iter": 21, "policy_reward_mean": {"av": 188.4622473921242}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.1754946310819804e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4584.849609375, "policy_loss": -54.92607498168945, "vf_loss": 4639.76806640625, "vf_explained_var": 0.00020587444305419922, "kl": 0.009317141026258469, "entropy": 1.565378189086914}, "num_steps_trained": 4656000, "num_steps_sampled": 4656000, "sample_time_ms": 83315.604, "grad_time_ms": 7962.709, "update_time_ms": 3.394, "opt_peak_throughput": 2009.367, "sample_peak_throughput": 192.041, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4656000, "episodes_total": 63366, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-17-57", "timestamp": 1569788277, "training_iteration": 291, "time_this_iter_s": 97.53728818893433, "time_total_s": 41680.70028400421, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63bd68>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 17734.66001868248, "timesteps_since_restore": 2736000, "iterations_since_restore": 171}
{"episode_reward_max": 7874.314156694822, "episode_reward_min": 1.551335625246619, "episode_reward_mean": 5257.778512993757, "episode_len_mean": 785.82, "episodes_this_iter": 19, "policy_reward_mean": {"av": 187.57682886171082}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.1754946310819804e-39, "cur_lr": 1.9999999494757503e-05, "total_loss": 4547.7119140625, "policy_loss": -54.21678924560547, "vf_loss": 4601.9365234375, "vf_explained_var": 0.00023037195205688477, "kl": 0.0032503928523510695, "entropy": 1.5574208498001099}, "num_steps_trained": 4672000, "num_steps_sampled": 4672000, "sample_time_ms": 83643.911, "grad_time_ms": 8011.999, "update_time_ms": 3.377, "opt_peak_throughput": 1997.005, "sample_peak_throughput": 191.287, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4672000, "episodes_total": 63385, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-19-31", "timestamp": 1569788371, "training_iteration": 292, "time_this_iter_s": 94.1144745349884, "time_total_s": 41774.8147585392, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b470>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 17828.77449321747, "timesteps_since_restore": 2752000, "iterations_since_restore": 172}
{"episode_reward_max": 7874.314156694822, "episode_reward_min": 1.551335625246619, "episode_reward_mean": 5323.573355055193, "episode_len_mean": 791.12, "episodes_this_iter": 19, "policy_reward_mean": {"av": 188.7791969877727}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 5.87746614891758e-40, "cur_lr": 1.9999999494757503e-05, "total_loss": 4684.31494140625, "policy_loss": -55.34858322143555, "vf_loss": 4739.677734375, "vf_explained_var": 0.00024896860122680664, "kl": 0.011078139767050743, "entropy": 1.531378149986267}, "num_steps_trained": 4688000, "num_steps_sampled": 4688000, "sample_time_ms": 83815.505, "grad_time_ms": 8059.743, "update_time_ms": 3.224, "opt_peak_throughput": 1985.175, "sample_peak_throughput": 190.895, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4688000, "episodes_total": 63404, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-21-07", "timestamp": 1569788467, "training_iteration": 293, "time_this_iter_s": 95.7965099811554, "time_total_s": 41870.611268520355, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b8d0>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 17924.571003198624, "timesteps_since_restore": 2768000, "iterations_since_restore": 173}
{"episode_reward_max": 7874.314156694822, "episode_reward_min": 1.551335625246619, "episode_reward_mean": 5503.506047193263, "episode_len_mean": 809.56, "episodes_this_iter": 18, "policy_reward_mean": {"av": 191.22675633055115}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 5.87746614891758e-40, "cur_lr": 1.9999999494757503e-05, "total_loss": 4912.76171875, "policy_loss": -57.229183197021484, "vf_loss": 4970.00048828125, "vf_explained_var": 0.00021946430206298828, "kl": 0.002209335332736373, "entropy": 1.5394877195358276}, "num_steps_trained": 4704000, "num_steps_sampled": 4704000, "sample_time_ms": 84586.281, "grad_time_ms": 8301.188, "update_time_ms": 3.161, "opt_peak_throughput": 1927.435, "sample_peak_throughput": 189.156, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4704000, "episodes_total": 63422, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-22-44", "timestamp": 1569788564, "training_iteration": 294, "time_this_iter_s": 96.38146686553955, "time_total_s": 41966.992735385895, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b668>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 18020.952470064163, "timesteps_since_restore": 2784000, "iterations_since_restore": 174}
{"episode_reward_max": 7874.314156694822, "episode_reward_min": 55.1107124837388, "episode_reward_mean": 5775.982740883287, "episode_len_mean": 838.3, "episodes_this_iter": 17, "policy_reward_mean": {"av": 194.34666019122778}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 2.93873307445879e-40, "cur_lr": 1.9999999494757503e-05, "total_loss": 4760.419921875, "policy_loss": -56.56499099731445, "vf_loss": 4816.96435546875, "vf_explained_var": 0.0002409219741821289, "kl": 0.0005700491019524634, "entropy": 1.5316426753997803}, "num_steps_trained": 4720000, "num_steps_sampled": 4720000, "sample_time_ms": 86862.39, "grad_time_ms": 8523.251, "update_time_ms": 3.175, "opt_peak_throughput": 1877.218, "sample_peak_throughput": 184.199, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4720000, "episodes_total": 63439, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-24-37", "timestamp": 1569788677, "training_iteration": 295, "time_this_iter_s": 113.22877073287964, "time_total_s": 42080.221506118774, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63beb8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 18134.181240797043, "timesteps_since_restore": 2800000, "iterations_since_restore": 175}
{"episode_reward_max": 7874.314156694822, "episode_reward_min": 55.1107124837388, "episode_reward_mean": 5943.461832416827, "episode_len_mean": 855.94, "episodes_this_iter": 19, "policy_reward_mean": {"av": 196.15385585534088}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.4693735437217167e-40, "cur_lr": 1.9999999494757503e-05, "total_loss": 4756.98388671875, "policy_loss": -56.30542755126953, "vf_loss": 4813.27294921875, "vf_explained_var": 0.0001334547996520996, "kl": 0.01024005375802517, "entropy": 1.4949268102645874}, "num_steps_trained": 4736000, "num_steps_sampled": 4736000, "sample_time_ms": 88098.426, "grad_time_ms": 8742.288, "update_time_ms": 3.057, "opt_peak_throughput": 1830.184, "sample_peak_throughput": 181.615, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4736000, "episodes_total": 63458, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-26-24", "timestamp": 1569788784, "training_iteration": 296, "time_this_iter_s": 107.29695391654968, "time_total_s": 42187.518460035324, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b0b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 18241.478194713593, "timesteps_since_restore": 2816000, "iterations_since_restore": 176}
{"episode_reward_max": 7874.314156694822, "episode_reward_min": 198.19445330523527, "episode_reward_mean": 5963.790878540437, "episode_len_mean": 863.58, "episodes_this_iter": 19, "policy_reward_mean": {"av": 195.21410404387677}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 1.4693735437217167e-40, "cur_lr": 1.9999999494757503e-05, "total_loss": 4645.23486328125, "policy_loss": -55.4713249206543, "vf_loss": 4700.69287109375, "vf_explained_var": 0.00012439489364624023, "kl": 0.0031170842703431845, "entropy": 1.4848030805587769}, "num_steps_trained": 4752000, "num_steps_sampled": 4752000, "sample_time_ms": 89111.164, "grad_time_ms": 8917.354, "update_time_ms": 3.16, "opt_peak_throughput": 1794.254, "sample_peak_throughput": 179.551, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4752000, "episodes_total": 63477, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-28-08", "timestamp": 1569788888, "training_iteration": 297, "time_this_iter_s": 103.78792572021484, "time_total_s": 42291.30638575554, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b550>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 18345.266120433807, "timesteps_since_restore": 2832000, "iterations_since_restore": 177}
{"episode_reward_max": 8066.506923203512, "episode_reward_min": 216.2522322447876, "episode_reward_mean": 6176.690474670289, "episode_len_mean": 887.3, "episodes_this_iter": 18, "policy_reward_mean": {"av": 197.21233954885994}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 7.346867718608583e-41, "cur_lr": 1.9999999494757503e-05, "total_loss": 4623.57080078125, "policy_loss": -55.092864990234375, "vf_loss": 4678.64599609375, "vf_explained_var": 0.00018417835235595703, "kl": 0.01107900682836771, "entropy": 1.498818039894104}, "num_steps_trained": 4768000, "num_steps_sampled": 4768000, "sample_time_ms": 90144.466, "grad_time_ms": 9149.604, "update_time_ms": 3.141, "opt_peak_throughput": 1748.71, "sample_peak_throughput": 177.493, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4768000, "episodes_total": 63495, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-29-56", "timestamp": 1569788996, "training_iteration": 298, "time_this_iter_s": 107.56251430511475, "time_total_s": 42398.868900060654, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b198>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 18452.828634738922, "timesteps_since_restore": 2848000, "iterations_since_restore": 178}
{"episode_reward_max": 8066.506923203512, "episode_reward_min": 97.03282130235759, "episode_reward_mean": 6128.831917737498, "episode_len_mean": 880.32, "episodes_this_iter": 18, "policy_reward_mean": {"av": 197.1953641485682}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 7.346867718608583e-41, "cur_lr": 1.9999999494757503e-05, "total_loss": 4689.39306640625, "policy_loss": -55.56515884399414, "vf_loss": 4744.96435546875, "vf_explained_var": 0.00025075674057006836, "kl": 0.003630515420809388, "entropy": 1.46022629737854}, "num_steps_trained": 4784000, "num_steps_sampled": 4784000, "sample_time_ms": 91108.784, "grad_time_ms": 9339.079, "update_time_ms": 4.409, "opt_peak_throughput": 1713.231, "sample_peak_throughput": 175.614, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4784000, "episodes_total": 63513, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-31-38", "timestamp": 1569789098, "training_iteration": 299, "time_this_iter_s": 101.95575761795044, "time_total_s": 42500.824657678604, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63bd68>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 18554.784392356873, "timesteps_since_restore": 2864000, "iterations_since_restore": 179}
{"episode_reward_max": 8066.506923203512, "episode_reward_min": 97.03282130235759, "episode_reward_mean": 6186.785378727955, "episode_len_mean": 890.0, "episodes_this_iter": 18, "policy_reward_mean": {"av": 196.90596367689233}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.6733637943810755e-41, "cur_lr": 1.9999999494757503e-05, "total_loss": 4559.01416015625, "policy_loss": -54.644718170166016, "vf_loss": 4613.634765625, "vf_explained_var": 0.00024896860122680664, "kl": 0.006510896608233452, "entropy": 1.4439140558242798}, "num_steps_trained": 4800000, "num_steps_sampled": 4800000, "sample_time_ms": 92422.74, "grad_time_ms": 9507.859, "update_time_ms": 4.367, "opt_peak_throughput": 1682.818, "sample_peak_throughput": 173.118, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4800000, "episodes_total": 63531, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-33-19", "timestamp": 1569789199, "training_iteration": 300, "time_this_iter_s": 101.810542345047, "time_total_s": 42602.63520002365, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c63b0b8>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 18656.59493470192, "timesteps_since_restore": 2880000, "iterations_since_restore": 180}
{"episode_reward_max": 8066.506923203512, "episode_reward_min": 97.03282130235759, "episode_reward_mean": 6259.711060709355, "episode_len_mean": 897.18, "episodes_this_iter": 16, "policy_reward_mean": {"av": 197.84168965579497}, "custom_metrics": {}, "num_metric_batches_dropped": 0, "info": {"av": {"cur_kl_coeff": 3.6733637943810755e-41, "cur_lr": 1.9999999494757503e-05, "total_loss": 4897.00927734375, "policy_loss": -57.36883544921875, "vf_loss": 4954.3916015625, "vf_explained_var": 0.00021880865097045898, "kl": 0.0015070224180817604, "entropy": 1.4670429229736328}, "num_steps_trained": 4816000, "num_steps_sampled": 4816000, "sample_time_ms": 93259.025, "grad_time_ms": 9932.909, "update_time_ms": 4.27, "opt_peak_throughput": 1610.807, "sample_peak_throughput": 171.565, "opt_samples": 16000.0, "learner": {}}, "timesteps_this_iter": 16000, "done": false, "timesteps_total": 4816000, "episodes_total": 63547, "experiment_id": "f3ec4b424ffe467686b631e284d876e2", "date": "2019-09-29_22-35-10", "timestamp": 1569789310, "training_iteration": 301, "time_this_iter_s": 110.14985132217407, "time_total_s": 42712.785051345825, "pid": 2337, "hostname": "ewout-ubuntu", "node_ip": "192.168.178.16", "config": {"monitor": false, "log_level": "INFO", "callbacks": {"on_episode_start": null, "on_episode_step": null, "on_episode_end": null, "on_sample_end": null, "on_train_result": null}, "model": {"conv_filters": null, "conv_activation": "relu", "fcnet_activation": "tanh", "fcnet_hiddens": [64, 64], "free_log_std": false, "squash_to_range": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action_reward": false, "framestack": true, "dim": 84, "channel_major": false, "grayscale": false, "zero_mean": true, "custom_preprocessor": null, "custom_model": null, "custom_options": {}}, "optimizer": {}, "gamma": 0.999, "horizon": 1000, "env_config": {"flow_params": "{\n    \"env\": {\n        \"additional_params\": {\n            \"disable_ramp_metering\": true,\n            \"disable_tb\": true,\n            \"inflow_range\": [\n                1000,\n                2000\n            ],\n            \"lane_change_duration\": 5,\n            \"max_accel\": 3,\n            \"max_decel\": 3,\n            \"reset_inflow\": false,\n            \"symmetric\": false,\n            \"target_velocity\": 40\n        },\n        \"clip_actions\": true,\n        \"evaluate\": false,\n        \"horizon\": 1000,\n        \"sims_per_step\": 1,\n        \"warmup_steps\": 40\n    },\n    \"env_name\": \"BottleneckFlowRewardMultiAgentEnv\",\n    \"exp_tag\": \"MultiAgentDesiredVelocity\",\n    \"initial\": {\n        \"additional_params\": {},\n        \"bunching\": 0,\n        \"edges_distribution\": [\n            \"2\",\n            \"3\",\n            \"4\",\n            \"5\"\n        ],\n        \"lanes_distribution\": Infinity,\n        \"min_gap\": 5,\n        \"perturbation\": 0.0,\n        \"shuffle\": false,\n        \"spacing\": \"uniform\",\n        \"x0\": 0\n    },\n    \"net\": {\n        \"additional_params\": {\n            \"scaling\": 1,\n            \"speed_limit\": 23\n        },\n        \"inflows\": {\n            \"_InFlows__flows\": [\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_0\",\n                    \"vehsPerHour\": 2070.0,\n                    \"vtype\": \"human\"\n                },\n                {\n                    \"begin\": 1,\n                    \"departLane\": \"random\",\n                    \"departSpeed\": 10,\n                    \"edge\": \"1\",\n                    \"end\": 86400,\n                    \"name\": \"flow_1\",\n                    \"vehsPerHour\": 230.0,\n                    \"vtype\": \"rl\"\n                }\n            ]\n        },\n        \"osm_path\": null,\n        \"template\": null\n    },\n    \"network\": \"BottleneckNetwork\",\n    \"sim\": {\n        \"color_vehicles\": true,\n        \"emission_path\": null,\n        \"lateral_resolution\": null,\n        \"no_step_log\": true,\n        \"num_clients\": 1,\n        \"overtake_right\": false,\n        \"port\": null,\n        \"print_warnings\": false,\n        \"pxpm\": 2,\n        \"render\": false,\n        \"restart_instance\": true,\n        \"save_render\": false,\n        \"seed\": null,\n        \"show_radius\": false,\n        \"sight_radius\": 25,\n        \"sim_step\": 0.5,\n        \"teleport_time\": -1\n    },\n    \"simulator\": \"traci\",\n    \"tls\": {\n        \"_TrafficLightParams__tls_properties\": {},\n        \"baseline\": false\n    },\n    \"veh\": [\n        {\n            \"acceleration_controller\": [\n                \"SimCarFollowingController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 31\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"human\"\n        },\n        {\n            \"acceleration_controller\": [\n                \"RLController\",\n                {}\n            ],\n            \"car_following_params\": {\n                \"controller_params\": {\n                    \"accel\": 2.6,\n                    \"carFollowModel\": \"IDM\",\n                    \"decel\": 4.5,\n                    \"impatience\": 0.5,\n                    \"maxSpeed\": 30,\n                    \"minGap\": 2.5,\n                    \"sigma\": 0.5,\n                    \"speedDev\": 0.1,\n                    \"speedFactor\": 1.0,\n                    \"tau\": 1.0\n                },\n                \"speed_mode\": 9\n            },\n            \"initial_speed\": 0,\n            \"lane_change_controller\": [\n                \"SimLaneChangeController\",\n                {}\n            ],\n            \"lane_change_params\": {\n                \"controller_params\": {\n                    \"laneChangeModel\": \"LC2013\",\n                    \"lcCooperative\": \"1.0\",\n                    \"lcKeepRight\": \"1.0\",\n                    \"lcSpeedGain\": \"1.0\",\n                    \"lcStrategic\": \"1.0\"\n                },\n                \"lane_change_mode\": 0\n            },\n            \"num_vehicles\": 1,\n            \"routing_controller\": [\n                \"ContinuousRouter\",\n                {}\n            ],\n            \"veh_id\": \"rl\"\n        }\n    ]\n}", "run": "PPO"}, "env": "BottleneckFlowRewardMultiAgentEnv-v0", "clip_rewards": null, "clip_actions": false, "preprocessor_pref": "deepmind", "num_workers": 4, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "num_envs_per_worker": 1, "sample_batch_size": 200, "train_batch_size": 16000, "batch_mode": "truncate_episodes", "sample_async": false, "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_evaluator_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "input": "sampler", "input_evaluation": null, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policy_graphs": {"av": ["<class 'ray.rllib.agents.ppo.ppo_policy_graph.PPOPolicyGraph'>", "Box(20,)", "Box(2,)", {}]}, "policy_mapping_fn": "<ray.tune.suggest.variant_generator.function object at 0x7fc26c621748>", "policies_to_train": ["av"]}, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "lr": 2e-05, "lr_schedule": null, "vf_share_layers": false, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "simple_optimizer": true, "straggler_mitigation": false}, "time_since_restore": 18766.744786024094, "timesteps_since_restore": 2896000, "iterations_since_restore": 181}
